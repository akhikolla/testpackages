<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Introduction</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>



<!-- MathJax scripts -->
<script type="text/javascript" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML">
</script>


<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h2>Introduction</h2>

<p>Consider the case where we observe \(n\) independent, identically distributed copies of the random variable (\(X_{i}\)) where \(X_{i} \in \mathbb{R}^{p}\) is normally distributed with some mean, \(\mu\), and some variance, \(\Sigma\). That is, \(X_{i} \sim N_{p}\left( \mu, \Sigma \right)\).</p>

<p>Because we assume independence, we know that the probability of observing these specific observations \(X_{1}, &hellip;, X_{n}\) is equal to</p>

<p>\begin{align<em>}
  f(X<em>{1}, &hellip;, X</em>{n}; \mu, \Sigma) &amp;= \prod<em>{i = 1}<sup>{n}(2\pi)<sup>{-p/2}\left|</sup></sup> \Sigma \right|<sup>{-&frac12;}\exp\left[</sup> -\frac{1}{2}\left( X</em>{i} - \mu \right)<sup>{T}\Sigma<sup>{-1}\left(</sup></sup> X<em>{i} - \mu \right) \right] \
  &amp;= (2\pi)<sup>{-nr/2}\left|</sup> \Sigma \right|<sup>{-n/2}\mbox{etr}\left[</sup> -\frac{1}{2}\sum</em>{i = 1}<sup>{n}\left(</sup> X<em>{i} - \mu \right)\left( X</em>{i} - \mu \right)<sup>{T}\Sigma<sup>{-1}</sup></sup> \right]
\end{align</em>}</p>

<p>where \(\mbox{etr}\left( \cdot \right)\) denotes the exponential trace operator. It follows that the log-likelihood for \(\mu\) and \(\Sigma\) is equal to the following:</p>

<p>\[ l(\mu, \Sigma | X) = const. - \frac{n}{2}\log\left| \Sigma \right| - tr\left[ \frac{1}{2}\sum_{i = 1}^{n}\left(X_{i} - \mu \right)\left(X_{i} - \mu \right)^{T}\Sigma^{-1} \right] \]</p>

<p>If we are interested in estimating \(\mu\), it is relatively straight forward to show that the maximum likelihood estimator (MLE) for \(\mu\) is \(\hat{\mu}_{MLE} = \sum_{i = 1}^{n}X_{i}/n\) which we typically denote as \(\bar{X}\). However, in addition to \(\mu\), many applications require the estimation of \(\Sigma\) as well. We can also find a maximum likelihood estimator:</p>

<p>\begin{align<em>}
  &amp;\hat{\Sigma}<em>{MLE} = \arg\max</em>{\Sigma \in \mathbb{S}<em>{+}<sup>{p}}\left{</sup> const. - \frac{n}{2}\log\left| \Sigma \right| - tr\left[ \frac{1}{2}\sum</em>{i = 1}<sup>{n}\left(X_{i}</sup> - \mu \right)\left(X<em>{i} - \mu \right)<sup>{T}\Sigma<sup>{-1}</sup></sup> \right] \right} \
  &amp;\nabla</em>{\Sigma}l(\mu, \Sigma | X) = -\frac{n}{2}\Sigma<sup>{-1}</sup> + \frac{1}{2}\sum<em>{i = 1}<sup>{n}\left(X</sup></em>{i} - \mu \right)\left(X<em>{i} - \mu \right)<sup>{T}\Sigma<sup>{-2}</sup></sup> \
  \Rightarrow &amp;\hat{\Sigma}</em>{MLE} = \left[ \frac{1}{n}\sum<em>{i = 1}<sup>{n}\left(X</sup></em>{i} - \bar{X} \right)\left(X_{i} - \bar{X} \right)<sup>{T}</sup> \right]
\end{align</em>}</p>

<p>By setting the gradient equal to zero and plugging in the MLE for \(\mu\), we find that the MLE for \(\Sigma\) is our usual sample estimator often denoted as \(S\). It turns out that we could have just as easily computed the maximum likelihood estimator for the precision matrix \(\Omega \equiv \Sigma^{-1}\) and taken its inverse:</p>

<p>\[ \hat{\Omega}_{MLE} = \arg\min_{\Omega \in S_{+}^{p}}\left\{ tr\left(S\Omega\right) - \log\left|\Omega\right| \right\} \]</p>

<p>so that \(\hat{\Omega}_{MLE} = S^{-1}\). Beyond the formatting convenience, computing estimates for \(\Omega\) as opposed to \(\Sigma\) often poses less computational challenges &ndash; and accordingly, the literature has placed more emphasis on efficiently solving for \(\Omega\) instead of \(\Sigma\).</p>

<p>As in regression settings, we can construct a <em>penalized</em> log-likelihood estimator by adding a penalty term, \(P\left(\Omega\right)\), to the likelihood:</p>

<p>\[ \hat{\Omega} = \arg\min_{\Omega \in S_{+}^{p}}\left\{ tr\left(S\Omega\right) - \log\left|\Omega \right| + P\left( \Omega \right) \right\} \]</p>

<p>\(P\left( \Omega \right)\) is often of the form \(P\left(\Omega \right) = \lambda\|\Omega \|_{F}^{2}/2\) or \(P\left(\Omega \right) = \|\Omega\|_{1}\) where \(\lambda > 0\), \(\left\|\cdot \right\|_{F}^{2}\) is the Frobenius norm and we define \(\left\|A \right\|_{1} = \sum_{i, j} \left| A_{ij} \right|\). These penalties are the ridge and lasso, respectively. The penalty proposed by @molstad2017shrinking is one of the following form:</p>

<p>\[ P\left(\Omega\right) = \lambda\left\| A\Omega B - C \right\|_{1} \]</p>

<p>where \(A \in \mathbb{R}^{m \times p}, B \in \mathbb{R}^{p \times q}, \mbox{ and } C \in \mathbb{R}^{m \times q}\) are matrices assumed to be known and specified by the user. Solving the full penalized log-likelihood for \(\Omega\) results in solving</p>

<p>\[ \hat{\Omega} = \arg\min_{\Omega \in S_{+}^{p}}\left\{ tr\left(S\Omega\right) - \log\left|\Omega \right| + \lambda\left\| A\Omega B - C \right\|_{1} \right\} \]</p>

<p>This form of penalty is particularly useful because matrices \(A, B, \mbox{ and } C\) can be constructed so that we penalize the sum, absolute value of a <em>characteristic</em> of the precision matrix \(\Omega\). This type of penalty leads to many new, interesting, and novel estimators for \(\Omega\). An example of one such estimator (suppose we observe \(n\) samples of \(Y_{i} \in \mathbb{R}^{r}\)) would be one where we set \(A = I_{p}, B = \Sigma_{xy}, \mbox{ and } C = 0\) where \(\Sigma_{xy}\) is the covariance matrix of \(X\) and \(Y\). This penalty has the effect of assuming sparsity in the forward regression coefficient \(\beta \equiv \Omega\Sigma_{xy}\). Of course, in practice we do not know the true covariance matrix \(\Sigma_{xy}\) but we might consider using the sample estimate \(\hat{\Sigma}_{xy} = \sum_{i = 1}^{n}\left(X_{i} - \bar{X}\right)\left(Y_{i} - \bar{Y}\right)^{T}/n\)</p>

<p>We will explore how to solve for \(\hat{\Omega}\) in the next section.</p>

<p><br>\vspace{1cm}</p>

<h2>Augmented ADMM Algorithm</h2>

<p><em>This section requires general knowledge of the alternating direction method of multipliers (ADMM) algorithm. I would recommend reading this overview I have written <a href="https://mgallow.github.io/ADMMsigma/articles/Details.html#admm-algorithm">here</a> before proceeding.</em></p>

<p>The ADMM algorithm - thanks to it&#39;s flexibility - is particularly well-suited to solve penalized-likelihood optimization problems that arise naturally in several statistics and machine learning applications. Within the context of @molstad2017shrinking, this algorithm would consist of iterating over the following three steps:</p>

<p>\begin{align}
  \Omega<sup>{k</sup> + 1} &amp;= \arg\min<em>{\Omega \in \mathbb{S}</em>{+}<sup>{p}}L_{\rho}(\Omega,</sup> Z<sup>{k},</sup> \Lambda<sup>{k})</sup> \
  Z<sup>{k</sup> + 1} &amp;= \arg\min<em>{Z \in \mathbb{R}<sup>{n</sup> \times r}}L</em>{\rho}(\Omega<sup>{k</sup> + 1}, Z, \Lambda<sup>{k})</sup> \
  \Lambda<sup>{k</sup> + 1} &amp;= \Lambda<sup>{k}</sup> + \rho\left(A\Omega<sup>{k</sup> + 1}B - Z<sup>{k</sup> + 1} - C \right)
\end{align}</p>

<p>where \(L_{p}(\cdot)\) is the <em>augmented lagrangian</em> defined as</p>

<p>\[ L_{\rho}(\Omega, Z, \Lambda) = f\left(\Omega\right) + g\left(Z\right) + tr\left[\Lambda^{T}\left(A\Omega B - Z - C\right)\right] + \frac{\rho}{2}\left\|A\Omega B - Z - C\right\|_{F}^{2} \]</p>

<p>with \(f\left(\Omega\right) = tr\left(S\Omega\right) - \log\left|\Omega\right|\) and \(g\left(Z\right) = \lambda\left\|Z\right\|_{1}\). However, instead of solving the first step exactly, the authors propose an alternative, approximating objective function (\(\tilde{L}\)) based on the majorize-minimize principle &ndash; the purpose of which is to find a solution that can be solved in closed form.</p>

<p>The approximating function is defined as</p>

<p>\begin{align<em>}
  \tilde{L}<em>{\rho}\left(\Omega, Z<sup>{k},</sup> \Lambda<sup>{k}\right)</sup> = f\left(\Omega\right) &amp;+ tr\left[(\Lambda<sup>{k})<sup>{T}(A\Omega</sup></sup> B - Z<sup>{k}</sup> - C) \right] + \frac{\rho}{2}\left|A\Omega B - Z<sup>{k}</sup> - C \right|</em>{F}<sup>{2}</sup> \
  &amp;+ \frac{\rho}{2}vec\left(\Omega - \Omega<sup>{k}\right)<sup>{T}Q\left(\Omega</sup></sup> - \Omega<sup>{k}\right)</sup>
\end{align</em>}</p>

<p>where \(Q = \tau I_{p} - \left(A^{T}A \otimes BB^{T}\right)\), \(\otimes\) is the Kronecker product, and \(\tau\) is chosen such that \(Q\) is positive definite. Note that if \(Q\) is positive definite (p.d.), then</p>

<p>\[ \frac{\rho}{2}vec\left(\Omega - \Omega^{k} \right)^{T}Q\left(\Omega - \Omega^{k} \right) > 0 \]</p>

<p>since \(\rho > 0\) and \(vec\left(\Omega - \Omega^{k}\right)\) is always nonzero whenever \(\Omega \neq \Omega^{k}\). Thus \(L_{\rho}\left(\cdot\right) \leq \tilde{L}\left(\cdot\right)\) for all \(\Omega\) and \(\tilde{L}\) is a majorizing function.</p>

<p>To see why this particular function was used, consider the Taylor&#39;s expansion of \(\rho\left\|A\Omega B - Z^{k} - C\right\|_{F}^{2}/2\):</p>

<p>\begin{align<em>}
  \frac{\rho}{2}\left| A\Omega B - Z<sup>{k}</sup> - C \right|<em>{F}<sup>{2}</sup> &amp;\approx \frac{\rho}{2}\left| A\Omega<sup>{k}</sup> B - Z<sup>{k}</sup> - C \right|</em>{F}<sup>{2}</sup> \
  &amp;+ \frac{\rho}{2}vec\left( \Omega - \Omega<sup>{k}\right)<sup>{T}\left(A<sup>{T}A</sup></sup></sup> \otimes BB<sup>{T}\right)vec\left(\Omega</sup> - \Omega<sup>{k}\right)</sup> \
  &amp;+ \rho vec\left(\Omega - \Omega<sup>{k}\right)<sup>{T}vec\left(BB<sup>{T}\Omega<sup>{k}A<sup>{T}A</sup></sup></sup></sup></sup> - B(Z<sup>{k})<sup>{T}A</sup></sup> - BC<sup>{T}A</sup> \right)
\end{align</em>}</p>

<p><strong>Note:</strong></p>

<p>\begin{align<em>}
  &amp;\nabla<em>{\Omega}\left{ \frac{\rho}{2}\left|A\Omega B - Z - C\right|</em>{F}<sup>{2}</sup> \right} = \rho BB<sup>{T}\Omega</sup> A<sup>{T}A</sup> - \rho BZ<sup>{T}A</sup> - \rho BC<sup>{T}A</sup> \
  &amp;\nabla<em>{\Omega}<sup>{2}\left{</sup> \frac{\rho}{2}\left|A\Omega B - Z - C \right|</em>{F}<sup>{2}</sup> \right} = \rho\left(A<sup>{T}A</sup> \otimes BB<sup>{T}</sup> \right)
\end{align</em>}</p>

<p>This implies that</p>

<p>\begin{align<em>}
  \frac{\rho}{2}\left| A\Omega B - Z<sup>{k}</sup> - C \right|<em>{F}<sup>{2}</sup> &amp;+ \frac{\rho}{2}vec\left(\Omega - \Omega<sup>{k}</sup> \right)<sup>{T}Q\left(\Omega</sup> - \Omega<sup>{k}</sup> \right) \
  &amp;\approx \frac{\rho}{2}\left| A\Omega<sup>{k}</sup> B - Z<sup>{k}</sup> - C \right|</em>{F}<sup>{2}</sup> + \frac{\rho}{2}vec\left(\Omega - \Omega<sup>{k}</sup> \right)<sup>{T}Q\left(\Omega</sup> - \Omega<sup>{k}</sup> \right) \
  &amp;+ \frac{\rho}{2}vec\left( \Omega - \Omega<sup>{k}\right)<sup>{T}\left(A<sup>{T}A</sup></sup></sup> \otimes BB<sup>{T}\right)vec\left(\Omega</sup> - \Omega<sup>{k}\right)</sup> \
  &amp;+ \rho vec\left(\Omega - \Omega<sup>{k}\right)<sup>{T}vec\left(BB<sup>{T}\Omega<sup>{k}A<sup>{T}A</sup></sup></sup></sup></sup> - B(Z<sup>{k})<sup>{T}A</sup></sup> - BC<sup>{T}A</sup> \right) \
  &amp;= \frac{\rho}{2}\left| A\Omega<sup>{k}</sup> B - Z<sup>{k}</sup> - C \right|<em>{F}<sup>{2}</sup> + \frac{\rho\tau}{2}\left|\Omega - \Omega<sup>{k}\right|</sup></em>{F}<sup>{2}</sup> \
  &amp;+ \rho tr\left[\left(\Omega - \Omega<sup>{k}\right)\left(BB<sup>{T}\Omega<sup>{k}A<sup>{T}A</sup></sup></sup></sup> - B(Z<sup>{k})<sup>{T}A</sup></sup> - BC<sup>{T}A</sup> \right)\right]
\end{align</em>}</p>

<p>Let us now plug in this equality into our optimization problem in step one:</p>

<p>\begin{align<em>}
  \Omega<sup>{k</sup> + 1} &amp;:= \arg\min<em>{\Omega \in \mathbb{S}</em>{+}<sup>{p}}\tilde{L}_{\rho}(\Omega,</sup> Z<sup>{k},</sup> \Lambda<sup>{k})</sup> \
  &amp;= \arg\min<em>{\Omega \in \mathbb{S}</em>{+}<sup>{p}}\left{\begin{matrix}</sup>
 tr\left(S\Omega\right) - \log\left|\Omega\right| + tr\left[(\Lambda<sup>{k})<sup>{T}(A\Omega</sup></sup> B - Z<sup>{k}</sup> - C) \right] + \frac{\rho}{2}\left|A\Omega B - Z<sup>{k}</sup> - C \right|<em>{F}<sup>{2}</sup> \end{matrix}\right. \
  &amp;+ \left.\begin{matrix} \frac{\rho}{2}vec\left(\Omega - \Omega<sup>{k}\right)<sup>{T}Q\left(\Omega</sup></sup> - \Omega<sup>{k}\right)</sup> \end{matrix}\right} \
  &amp;= \arg\min</em>{\Omega \in \mathbb{S}<em>{+}<sup>{p}}\left{\begin{matrix}</sup>
 tr\left(S\Omega\right) - \log\left|\Omega\right| + tr\left[(\Lambda<sup>{k})<sup>{T}(A\Omega</sup></sup> B - Z<sup>{k}</sup> - C) \right] + \frac{\rho}{2}\left|A\Omega<sup>{k}</sup> B - Z<sup>{k}</sup> - C \right|</em>{F}<sup>{2}</sup> \end{matrix}\right. \
  &amp;+ \left.\begin{matrix} \frac{\rho\tau}{2}\left|\Omega - \Omega<sup>{k}\right|_{F}<sup>{2}</sup></sup> + \rho tr\left[\left(\Omega - \Omega<sup>{k}\right)\left(BB<sup>{T}\Omega<sup>{k}A<sup>{T}A</sup></sup></sup></sup> - B(Z<sup>{k})<sup>{T}A</sup></sup> - BC<sup>{T}A</sup> \right)\right] \end{matrix}\right} \
  &amp;= \arg\min<em>{\Omega \in \mathbb{S}</em>{+}<sup>{p}}\left{\begin{matrix}</sup>
 tr\left[\left(S + \rho A<sup>{T}(A\Omega<sup>{k}B</sup></sup> - Z<sup>{k}</sup> - C + \Lambda<sup>{k}/\rho)B<sup>{T}</sup></sup> \right)\Omega\right] \end{matrix}\right. \
  &amp;- \left.\begin{matrix} \log\left|\Omega\right| + \frac{\rho\tau}{2}\left|\Omega - \Omega<sup>{k}\right|_{F}<sup>{2}</sup></sup> \end{matrix}\right} \
  &amp;= \arg\min<em>{\Omega \in \mathbb{S}</em>{+}<sup>{p}}\left{</sup>
 tr\left[\left(S + G<sup>{k}</sup> \right)\Omega\right] - \log\left|\Omega\right| + \frac{\rho\tau}{2}\left|\Omega - \Omega<sup>{k}\right|_{F}<sup>{2}</sup></sup> \right} \
\end{align</em>}</p>

<p>where \(G^{k} = \rho A^{T}(A\Omega^{k}B - Z^{k} - C + \Lambda^{k}/\rho)B^{T}\).</p>

<p><br>\vspace{1cm}</p>

<p>The <em>augmented ADMM</em> algorithm is the following:</p>

<p>\begin{align}
  \Omega<sup>{k</sup> + 1} &amp;= \arg\min<em>{\Omega \in \mathbb{S}</em>{+}<sup>{p}}\left{tr\left[\left(S</sup> + G<sup>{k}\right)\Omega\right]</sup> - \log\left|\Omega\right| + \frac{\rho\tau}{2}\left|\Omega - \Omega<sup>{k}\right|_{F}<sup>{2}</sup></sup> \right} \
  Z<sup>{k</sup> + 1} &amp;= \arg\min<em>{Z \in \mathbb{R}<sup>{n</sup> \times r}}\left{\lambda\left|Z\right|</em>{1} + tr\left[(\Lambda<sup>{k})<sup>{T}(A\Omega</sup></sup> B - Z<sup>{k}</sup> - C) \right] + \frac{\rho}{2}\left|A\Omega B - Z<sup>{k}</sup> - C \right|_{F}<sup>{2}</sup> \right} \
  \Lambda<sup>{k</sup> + 1} &amp;= \Lambda<sup>{k}</sup> + \rho\left(A\Omega<sup>{k</sup> + 1}B - Z<sup>{k</sup> + 1} - C \right)
\end{align}</p>

<p><br>\vspace{1cm}</p>

<h3>Algorithm</h3>

<p>Set \(k = 0\) and repeat steps 1-6 until convergence.</p>

<ol>
<li><p>Compute \(G^{k} = \rho A^{T}\left( A\Omega^{k} B - Z^{k} - C + \rho^{-1}Y^{k} \right)B^{T}\)</p></li>
<li><p>Decompose \(S + \left( G^{k} + (G^{k})^{T} \right)/2 - \rho\tau\Omega^{k} = VQV^{T}\) (via the spectral decomposition).</p></li>
<li><p>Set \(\Omega^{k + 1} = V\left( -Q + (Q^{2} + 4\rho\tau I_{p})^{&frac12;} \right)V^{T}/(2\rho\tau)\)</p></li>
<li><p>Set \(Z^{k + 1} = \mbox{soft}\left( A\Omega^{k + 1}B - C + \rho^{-1}Y^{k}, \rho^{-1}\lambda \right)\)</p></li>
<li><p>Set \(Y^{k + 1} = \rho\left( A\Omega^{k + 1} B - Z^{k + 1} - C \right)\)</p></li>
<li><p>Replace \(k\) with \(k + 1\).</p></li>
</ol>

<p>where \(\mbox{soft}(a, b) = \mbox{sign}(a)(\left| a \right| - b)_{+}\).</p>

<p><br>\vspace{1cm}</p>

<h3>Proof of (2-3):</h3>

<p>\[ \Omega^{k + 1} = \arg\min_{\Omega \in \mathbb{S}_{+}^{p}}\left\{tr\left[\left(S + G^{k}\right)\Omega\right] - \log\left|\Omega\right| + \frac{\rho\tau}{2}\left\|\Omega - \Omega^{k}\right\|_{F}^{2} \right\} \]</p>

<p>\begin{align<em>}
  &amp;\nabla<em>{\Omega}\left{tr\left[\left(S + G<sup>{k}\right)\Omega\right]</sup> - \log\left|\Omega\right| + \frac{\rho\tau}{2}\left|\Omega - \Omega<sup>{k}\right|</sup></em>{F}<sup>{2}</sup> \right} \
  &amp;= 2S - S\circ I<em>{p} + G<sup>{k}</sup> + (G<sup>{k})<sup>{T}</sup></sup> - G<sup>{k}\circ</sup> I</em>{p} - 2\Omega<sup>{-1}</sup> + \Omega<sup>{-1}\circ</sup> I<em>{p} \
  &amp;+ \frac{\rho\tau}{2}\left[2\Omega - 2(\Omega<sup>{k})<sup>{T}</sup></sup> + 2\Omega<sup>{T}</sup> - 2\Omega<sup>{k}</sup> - 2(\Omega - \Omega<sup>{k})<sup>{T}\circ</sup></sup> I</em>{p} \right]
\end{align</em>}</p>

<p>Note that we need to honor the symmetric constraint given by \(\Omega\). By setting the gradient equal to zero and multiplying all off-diagonal elements by \(&frac12;\), this simplifies to</p>

<p>\[ S + \frac{1}{2}\left(G^{k} + (G^{k})^{T}\right) - \rho\tau\Omega^{k} = (\Omega^{k + 1})^{-1} - \rho\tau\Omega^{k + 1} \]</p>

<p>We can then decompose \(\Omega^{k + 1} = VDV^{T}\) where \(D\) is a diagonal matrix with diagonal elements equal to the eigen values of \(\Omega^{k + 1}\) and \(V\) is the matrix with corresponding eigen vectors as columns.</p>

<p>\[ S + \frac{1}{2}\left(G^{k} + (G^{k})^{T}\right) - \rho\tau\Omega^{k} = VD^{-1}V^{T} - \rho\tau VDV^{T} = V\left(D^{-1} - \rho\tau D\right)V^{T} \]</p>

<p>This equivalence implies that</p>

<p>\[ \phi_{j}\left( D^{k} \right) = \frac{1}{\phi_{j}(\Omega^{k + 1})} - \rho\tau\phi_{j}(\Omega^{k + 1}) \]</p>

<p>where \(\phi_{j}(\cdot)\) is the $j$th eigen value and \(D^{k} = S + \left(G^{k} + (G^{k})^{T}\right)/2 - \rho\tau\Omega^{k}\). Therefore</p>

<p>\begin{align<em>}
  &amp;\Rightarrow \rho\tau\phi<em>{j}<sup>{2}(\Omega<sup>{k</sup></sup> + 1}) + \phi</em>{j}\left( D<sup>{k}</sup> \right)\phi<em>{j}(\Omega<sup>{k</sup> + 1}) - 1 = 0 \
  &amp;\Rightarrow \phi</em>{j}(\Omega<sup>{k</sup> + 1}) = \frac{-\phi<em>{j}(D<sup>{k})</sup> \pm \sqrt{\phi</em>{j}<sup>{2}(D<sup>{k})</sup></sup> + 4\rho\tau}}{2\rho\tau}
\end{align</em>}</p>

<p>In summary, if we decompose \(S + \left(G^{k} + (G^{k})^{T}\right)/2 - \rho\tau\Omega^{k} = VQV^{T}\) then</p>

<p>\[ \Omega^{k + 1} = \frac{1}{2\rho\tau}V\left[ -Q + (Q^{2} + 4\rho\tau I_{p})^{&frac12;}\right] V^{T} \]</p>

<p><br>\vspace{1cm}</p>

<h3>Proof of (4)</h3>

<p>\[ Z^{k + 1} = \arg\min_{Z \in \mathbb{R}^{n \times r}}\left\{ \lambda\left\| Z \right\|_{1} + tr\left[(\Lambda^{k})^{T}\left(A\Omega^{k + 1}B - Z - C\right)\right] + \frac{\rho}{2}\left\| A\Omega^{k + 1}B - Z - C \right\|_{F}^{2} \right\} \]</p>

<p>\vspace{1cm}</p>

<p>\begin{align<em>}
  \partial&amp;\left{ \lambda\left| Z \right|<em>{1} + tr\left[(\Lambda<sup>{k})<sup>{T}\left(A\Omega<sup>{k</sup></sup></sup> + 1}B - Z - C\right)\right] + \frac{\rho}{2}\left| A\Omega<sup>{k</sup> + 1}B - Z - C \right|</em>{F}<sup>{2}</sup> \right} \
  &amp;= \partial\left{ \lambda\left| Z \right|<em>{1} \right} + \nabla</em>{\Omega}\left{ tr\left[(\Lambda<sup>{k})<sup>{T}\left(A\Omega<sup>{k</sup></sup></sup> + 1}B - Z - C\right)\right] + \frac{\rho}{2}\left| A\Omega<sup>{k</sup> + 1}B - Z - C \right|_{F}<sup>{2}</sup> \right} \
  &amp;= \mbox{sign}(Z)\lambda - \Lambda<sup>{k}</sup> - \rho\left( A\Omega<sup>{k</sup> + 1}B - Z - C \right)
\end{align</em>}</p>

<p>where \(\mbox{sign(Z)}\) is the elementwise sign operator. By setting the gradient/sub-differential equal to zero, we arrive at the following equivalence:</p>

<p>\[ Z_{ij}^{k + 1} = \frac{1}{\rho}\left( \rho(A\Omega_{ij}^{k + 1}B - C) + \Lambda_{ij}^{k} - Sign(Z_{ij}^{k + 1})\lambda \right) \]</p>

<p>for all \(i = 1,&hellip;, p\) and \(j = 1,&hellip;, p\). We observe two scenarios:</p>

<ul>
<li>If \(Z_{ij}^{k + 1} > 0\) then</li>
</ul>

<p>\[ \rho\left(A\Omega_{ij}^{k + 1}B - C\right) + \Lambda_{ij}^{k} > \lambda\alpha \]</p>

<ul>
<li>If \(Z_{ij}^{k + 1} < 0\) then</li>
</ul>

<p>\[ \rho\left(A\Omega_{ij}^{k + 1}B - C\right) + \Lambda_{ij}^{k} < -\lambda\alpha \]</p>

<p>This implies that \(\mbox{sign}(Z_{ij}^{k + 1}) = \mbox{sign}\left(\rho(A\Omega_{ij}^{k + 1}B - C) + \Lambda_{ij}^{k}\right)\). Putting all the pieces together, we arrive at</p>

<p>\begin{align<em>}
Z<em>{ij}<sup>{k</sup> + 1} &amp;= \frac{1}{\rho}\mbox{sign}\left(\rho(A\Omega</em>{ij}<sup>{k</sup> + 1}B - C) + \Lambda<em>{ij}<sup>{k}\right)\left(</sup> \left| \rho(A\Omega</em>{ij}<sup>{k</sup> + 1}B - C) + \Lambda<em>{ij}<sup>{k}</sup> \right| - \lambda \right)</em>{+} \
&amp;= \frac{1}{\rho}\mbox{soft}\left(\rho(A\Omega<em>{ij}<sup>{k</sup> + 1}B - C) + \Lambda</em>{ij}<sup>{k},</sup> \lambda\right)
\end{align</em>}</p>

<p>where soft is the soft-thresholding function.</p>

<p><br>\vspace{1cm}</p>

<h2>Stopping Criterion</h2>

<p>In discussing the optimality conditions and stopping criterion, we will follow the steps outlined in @boyd2011distributed and cater them to the SCPME method.</p>

<p>Below we have three optimality conditions:</p>

<ol>
<li>Primal:</li>
</ol>

<p>\[ A\Omega^{k + 1}B - Z^{k + 1} - C = 0 \]</p>

<ol>
<li>Dual:</li>
</ol>

<p>\begin{align<em>}
  0 &amp;\in \partial f\left(\Omega<sup>{k</sup> + 1}\right) + \frac{1}{2}\left(B(\Lambda<sup>{k</sup> + 1})<sup>{T}A</sup> + A<sup>{T}\Lambda<sup>{k</sup></sup> + 1}B<sup>{T}</sup> \right) \
  0 &amp;\in \partial g\left(Z<sup>{k</sup> + 1}\right) - \Lambda<sup>{k</sup> + 1}
\end{align</em>}</p>

<p>The first dual optimality condition is a result of taking the sub-differential of the lagrangian (non-augmented) with respect to \(\Omega^{k + 1}\) (note that we must honor the symmetric constraint of \(\Omega^{k + 1}\)) and the second is a result of taking the sub-differential of the lagrangian with respect to \(Z^{k + 1}\) (no symmetric constraint).</p>

<p>We will define the left-hand side of the primal optimality condition as the primal residual \(r^{k + 1} = A\Omega^{k + 1}B - Z^{k + 1} - C\). At convergence, the optimality conditions require that \(r^{k + 1} \approx 0\). The second residual we will define is the dual residual:</p>

<p>\[ s^{k + 1} = \frac{\rho}{2}\left( B(Z^{k + 1} - Z^{k})^{T}A + A^{T}(Z^{k + 1} - Z^{k})B^{T} \right) \]</p>

<p>This residual is derived from the following:</p>

<p>Because \(\Omega^{k + 1}\) is the argument that minimizes \(L_{p}\left( \Omega, Z^{k}, \Lambda^{k} \right)\),</p>

<p>\begin{align<em>}
  0 &amp;\in \partial \left{ f\left(\Omega<sup>{k</sup> + 1}\right) + tr\left[ \Lambda<sup>{k}\left(</sup> A\Omega<sup>{k</sup> + 1}B - Z<sup>{k}</sup> - C \right) \right] + \frac{\rho}{2}\left| A\Omega<sup>{k</sup> + 1}B - Z<sup>{k}</sup> - C \right|_{F}<sup>{2}</sup> \right} \
  &amp;= \partial f\left(\Omega<sup>{k</sup> + 1} \right) + \frac{1}{2}\left(B(\Lambda<sup>{k})<sup>{T}A</sup></sup> + A<sup>{T}\Lambda<sup>{k}B<sup>{T}</sup></sup></sup> \right) + \frac{\rho}{2}\left( BB<sup>{T}\Omega<sup>{k</sup></sup> + 1}A<sup>{T}A</sup> + A<sup>{T}A\Omega<sup>{k</sup></sup> + 1}BB<sup>{T}</sup> \right) \
  &amp;- \frac{\rho}{2}\left( A<sup>{T}(Z<sup>{k}</sup></sup> + C)B<sup>{T}</sup> + B(Z<sup>{k}</sup> + C)<sup>{T}A</sup> \right) \
  &amp;= \partial f\left(\Omega<sup>{k</sup> + 1} \right) + \frac{1}{2}\left(B(\Lambda<sup>{k})<sup>{T}A</sup></sup> + A<sup>{T}\Lambda<sup>{k}B<sup>{T}</sup></sup></sup> \right) \
  &amp;+ \frac{\rho}{2}\left( B(B<sup>{T}\Omega<sup>{k</sup></sup> + 1}A<sup>{T}</sup> - (Z<sup>{k})<sup>{T}</sup></sup> - C<sup>{T})A</sup> + A<sup>{T}(A\Omega<sup>{k</sup></sup> + 1}B - Z<sup>{k}</sup> - C)B<sup>{T}</sup> \right) \
  &amp;= \partial f\left(\Omega<sup>{k</sup> + 1} \right) + \frac{1}{2}\left( B(\Lambda<sup>{k})<sup>{T}A</sup></sup> + A<sup>{T}\Lambda<sup>{k}B<sup>{T}</sup></sup></sup> \right) + \frac{\rho}{2}\left(A<sup>{T}(A\Omega<sup>{k</sup></sup> + 1}B - Z<sup>{k</sup> + 1} + Z<sup>{k</sup> + 1} - Z<sup>{k}</sup> - C)B<sup>{T}</sup> \right) \
  &amp;+ \frac{\rho}{2}\left(B(B<sup>{T}\Omega<sup>{k</sup></sup> + 1}A<sup>{T}</sup> - (Z<sup>{k</sup> + 1})<sup>{T}</sup> + (Z<sup>{k</sup> + 1})<sup>{T}</sup> - (Z<sup>{k})<sup>{T}</sup></sup> - C<sup>{T})A</sup> \right) \
  &amp;= \partial f\left(\Omega<sup>{k</sup> + 1} \right) + \frac{1}{2}\left[ B\left((\Lambda<sup>{k})<sup>{T}</sup></sup> + \rho(B<sup>{T}\Omega<sup>{k</sup></sup> + 1}A<sup>{T}</sup> - (Z<sup>{k</sup> + 1})<sup>{T}</sup> - C<sup>{T})</sup> \right)A \right] \
  &amp;+ \frac{1}{2}\left[ A<sup>{T}\left(\Lambda<sup>{k}</sup></sup> + \rho(A\Omega<sup>{k</sup> + 1}B - Z<sup>{k</sup> + 1} - c)B \right)B<sup>{T}</sup> \right] + \frac{\rho}{2}\left(B(Z<sup>{k</sup> + 1} - Z<sup>{k})<sup>{T}A</sup></sup> + A<sup>{T}(Z<sup>{k</sup></sup> + 1} - Z<sup>{k})B<sup>{T}</sup></sup> \right) \
  &amp;= \partial f\left(\Omega<sup>{k</sup> + 1} \right) + \frac{1}{2}\left(B(\Lambda<sup>{k</sup> + 1})<sup>{T}A</sup> + A<sup>{T}\Lambda<sup>{k</sup></sup> + 1}B<sup>{T}</sup> \right) + \frac{\rho}{2}\left(B(Z<sup>{k</sup> + 1} - Z<sup>{k})<sup>{T}A</sup></sup> + A<sup>{T}(Z<sup>{k</sup></sup> + 1} - Z<sup>{k})B<sup>{T}</sup></sup> \right) \
  \Rightarrow 0 &amp;\in \frac{\rho}{2}\left( B(Z<sup>{k</sup> + 1} - Z<sup>{k})<sup>{T}A</sup></sup> + A<sup>{T}(Z<sup>{k</sup></sup> + 1} - Z<sup>{k})B<sup>{T}</sup></sup> \right)
\end{align</em>}</p>

<p>Like the primal residual, at convergence the optimality conditions require that \(s^{k + 1} \approx 0\). Note that the second dual optimality condition is always satisfied:</p>

<p>\begin{align<em>}
  0 &amp;\in \partial \left{ g\left(Z<sup>{k</sup> + 1}\right) + tr\left[ \Lambda<sup>{k}\left(</sup> A\Omega<sup>{k</sup> + 1}B - Z<sup>{k</sup> + 1} - C \right) \right] + \rho\left| A\Omega<sup>{k</sup> + 1}B - Z<sup>{k</sup> + 1} - C \right|_{F}<sup>{2}</sup> \right} \
  &amp;= \partial g\left(Z<sup>{k</sup> + 1}\right) - \Lambda<sup>{k}</sup> - \rho\left(A\Omega<sup>{k</sup> + 1}B - Z<sup>{k</sup> + 1} - C \right) \
  &amp;= \partial g\left(Z<sup>{k</sup> + 1}\right) - \Lambda<sup>{k</sup> + 1} \
\end{align</em>}</p>

<p>One possible stopping criterion is to set \(\epsilon^{rel} = \epsilon^{abs} = 10^{-3}\) and stop the algorithm when \(\epsilon^{pri} \leq \left\| r^{k + 1} \right\|_{F}\) and \(\epsilon^{dual} \leq \left\| s^{k + 1} \right\|_{F}\) where</p>

<p>\begin{align<em>}
  \epsilon<sup>{pri}</sup> &amp;= \sqrt{nr}\epsilon<sup>{abs}</sup> + \epsilon<sup>{rel}\max\left{</sup> \left| A\Omega<sup>{k</sup> + 1}B \right|<em>{F}, \left| Z<sup>{k</sup> + 1} \right|</em>{F}, \left| C \right|<em>{F} \right} \
  \epsilon<sup>{dual}</sup> &amp;= p\epsilon<sup>{abs}</sup> + \epsilon<sup>{rel}\left|</sup> \left( B(\Lambda<sup>{k</sup> + 1})<sup>{T}A</sup> + A<sup>{T}\Lambda<sup>{k</sup></sup> + 1}B<sup>{T}</sup> \right)/2 \right|</em>{F}
\end{align</em>}</p>

<p><br><br>\newpage</p>

<h2>References</h2>

</body>

</html>
