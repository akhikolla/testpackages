<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Carsten Urbach, Eike Luedeling, Katja Schiffers" />

<meta name="date" content="2020-12-10" />

<title>PhenoFlex</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">PhenoFlex</h1>
<h4 class="author">Carsten Urbach, Eike Luedeling, Katja Schiffers</h4>
<h4 class="date">2020-12-10</h4>



<div id="the-phenoflex-model" class="section level1">
<h1>The <code>PhenoFlex</code> Model</h1>
<p>The <code>PhenoFlex</code> Model constitutes a framework for modeling the spring phenology of deciduous trees, with a particular focus on fruit and nut trees. It uses the structure of the Dynamic Model for chill accumulation and the Growing Degree Hours model for heat accumulation. In order to relate spring phenology to chill and heat, and to account for varying theories about the relationship between these two agroclimatic phenomena, <code>PhenoFlex</code> includes a flexible transition function that defines responsiveness to heat (during ecodormancy) as a function of accumulated chill (during endodormancy). Unlike most previous applications of these models, <code>PhenoFlex</code> can flexibly fit the parameters of both models to observed spring phenology dates. The model can thus accommodate variation among the temperature responses of different species and cultivars.</p>
<p>The <code>PhenoFlex</code> Model is implemented in the <code>chillR</code> package, which also contains functions to fit the model parameters to observed spring phenology data. This vignette demonstrates the use of the PhenoFlex Model to predict spring phenology dates, as well as the procedure for fitting model parameters to data.</p>
<div id="data-preparation" class="section level2">
<h2>Data preparation</h2>
<p>We demonstrate the <code>PhenoFlex</code> functions using the example of cherry bloom data recorded at Campus Klein-Altendorf, the experimental station of the University of Bonn. This dataset, along with long-term records of daily minimum and maximum temperatures, is included in the <code>chillR</code> package (<code>KA_bloom</code> and <code>KA_weather</code>, respectively). Since the PhenoFlex model requires hourly temperatures, we use the <code>stack_hourly_temps</code> function from <code>chillR</code> to interpolate the daily data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(chillR)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">data</span>(KA_weather)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">data</span>(KA_bloom)</span>
<span id="cb1-5"><a href="#cb1-5"></a>hourtemps &lt;-<span class="st"> </span><span class="kw">stack_hourly_temps</span>(KA_weather, <span class="dt">latitude=</span><span class="fl">50.4</span>)</span></code></pre></div>
<p>In <code>PhenoFlex</code>, the chilling requirement is denoted <span class="math inline">\(y_c\)</span> and the heat requirement <span class="math inline">\(z_c\)</span>. We first illustrate how the model can be used to predict spring phenology events, based on user-specified <span class="math inline">\(y_c\)</span> and <span class="math inline">\(z_c\)</span> values and using the usual parameters for the Dynamic Model and the Growing Degree Hours model (the default values in <code>PhenoFlex</code>). To run the analysis for one year only, we select all data for the 2009 season. The 2009 season is the dormancy season that ends in 2009. The number of months to consider for the season is specified in the <code>genSeason</code> function by the <code>mrange</code> parameter. Since the default (August to June) is appropriate here, this is not specified below.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>yc &lt;-<span class="st"> </span><span class="dv">40</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>zc &lt;-<span class="st"> </span><span class="dv">190</span></span>
<span id="cb2-3"><a href="#cb2-3"></a>iSeason &lt;-<span class="st"> </span><span class="kw">genSeason</span>(hourtemps, <span class="dt">years=</span><span class="kw">c</span>(<span class="dv">2009</span>))</span>
<span id="cb2-4"><a href="#cb2-4"></a>res &lt;-<span class="st"> </span><span class="kw">PhenoFlex</span>(<span class="dt">temp=</span>hourtemps<span class="op">$</span>hourtemps<span class="op">$</span>Temp[iSeason[[<span class="dv">1</span>]]],</span>
<span id="cb2-5"><a href="#cb2-5"></a>                 <span class="dt">times=</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="st"> </span><span class="kw">length</span>(hourtemps<span class="op">$</span>hourtemps<span class="op">$</span>Temp[iSeason[[<span class="dv">1</span>]]])),</span>
<span id="cb2-6"><a href="#cb2-6"></a>                 <span class="dt">zc=</span>zc, <span class="dt">stopatzc=</span><span class="ot">TRUE</span>, <span class="dt">yc=</span>yc, <span class="dt">basic_output=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<p>The PhenoFlex function generates a list that tracks the accumulation of x (precursor to the dormancy-breaking factor), y (the dormancy-breaking factor; or Chill Portion), z (heat accumulation) and xs (the ratio of the formation to the destruction rate of x) over time. It also returns a bloomindex element, which points to the row in the temps input table that corresponds to estimated budbreak (or whatever the phenological stage of interest is).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>DBreakDay &lt;-<span class="st"> </span>res<span class="op">$</span>bloomindex</span>
<span id="cb3-2"><a href="#cb3-2"></a>seasontemps&lt;-hourtemps<span class="op">$</span>hourtemps[iSeason[[<span class="dv">1</span>]],]</span>
<span id="cb3-3"><a href="#cb3-3"></a>seasontemps[,<span class="st">&quot;x&quot;</span>]&lt;-res<span class="op">$</span>x</span>
<span id="cb3-4"><a href="#cb3-4"></a>seasontemps[,<span class="st">&quot;y&quot;</span>]&lt;-res<span class="op">$</span>y</span>
<span id="cb3-5"><a href="#cb3-5"></a>seasontemps[,<span class="st">&quot;z&quot;</span>]&lt;-res<span class="op">$</span>z</span>
<span id="cb3-6"><a href="#cb3-6"></a>seasontemps&lt;-<span class="kw">add_date</span>(seasontemps)</span>
<span id="cb3-7"><a href="#cb3-7"></a></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>seasontemps[<span class="dv">1</span><span class="op">:</span>DBreakDay,],<span class="kw">aes</span>(<span class="dt">x=</span>Date,<span class="dt">y=</span>y)) <span class="op">+</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span><span class="st">&quot;blue&quot;</span>,<span class="dt">lwd=</span><span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="st">  </span><span class="kw">theme_bw</span>(<span class="dt">base_size=</span><span class="dv">20</span>) <span class="op">+</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span>yc,<span class="dt">lty=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Chill (y) accumulation&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Chill accumulation over time. The dashed line respresents <span class="math inline">\(y_c\)</span>, the critical amount of chill units for ecodormancy to be broken.</p>
</div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">ggplot</span>(<span class="dt">data=</span>seasontemps[<span class="dv">1</span><span class="op">:</span>DBreakDay,],<span class="kw">aes</span>(<span class="dt">x=</span>Date,<span class="dt">y=</span>z)) <span class="op">+</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">col=</span><span class="st">&quot;red&quot;</span>,<span class="dt">lwd=</span><span class="fl">1.5</span>) <span class="op">+</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="st">  </span><span class="kw">theme_bw</span>(<span class="dt">base_size=</span><span class="dv">20</span>) <span class="op">+</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="st">  </span><span class="kw">geom_hline</span>(<span class="dt">yintercept=</span>zc,<span class="dt">lty=</span><span class="dv">2</span>) <span class="op">+</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Heat (z) accumulation&quot;</span>)</span></code></pre></div>
<div class="figure">
<img src="data:image/png;base64,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" alt />
<p class="caption">Heat accumulation over time. The dashed line respresents the <span class="math inline">\(z_c\)</span>, the critical amount of heat units for ecodormancy to be broken.</p>
</div>
</div>
</div>
<div id="the-phenologyfitter" class="section level1">
<h1>The phenologyFitter</h1>
<p>The <code>PhenoFlex</code> model can be fitted to phenological data, provided that sufficient observations are available for the cultivar of interest. For this kind of model, parameters are usually determined using an empirical solver. Solvers identify the best combination of model parameters by trying out different values and gradually adjusting these parameters, until the objective function - a measure of how far predictions are from the observed data - does not decrease further. In this framework, we fit the model using a generalized simulated annealing algorithm. In contrast to other algorithms, simulated annealing can deal with discrete data (we calculate the residual sum of squares between observed and predicted bloom days as objective function). Since simulated annealing is a stochastic solver, there is a risk of not finding the overall best parameter combination (global minimum of residual sum of squares). The generalisation of the basic solver reduces this risk. Still, the search should be repeated several times with different initial parameter values and random seeds. This iterative procedure requires lots of model runs, which can take substantial time and/or computing power. Here, we only demonstrate the functionality using a maximum of 10 iterations of the simulated annealing procedure. In order to achieve reliable parameters, we recommend at least 1000 iterations. We also recommend using many observations of a cultivar’s spring phenology (many more than in this example), and ideally to include winter seasons spanning a wide range of temperature conditions.</p>
<p>For fitting the <code>PhenoFlex</code> model to phenological data, we have to generate a list of seasons as follows. We are only using 6 seasons in this example, but a real-life application should be based on at least 15 to 20 seasons or even more, comprising variable temperature profiles across years.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>SeasonList &lt;-<span class="st"> </span><span class="kw">genSeasonList</span>(hourtemps<span class="op">$</span>hourtemps, <span class="dt">years=</span><span class="kw">c</span>(<span class="dv">2003</span><span class="op">:</span><span class="dv">2008</span>))</span></code></pre></div>
<p>Parameters are then fitted using the generalized simulated annealing algorithm, which is called by the <code>phenologyFitter</code> function and requires several inputs:</p>
<ul>
<li>an integer vector of observed dates of bloom (or other phenological stages)</li>
<li>a function describing the model to be fitted, which only takes as input a data.frame of dates and observed temperatures. Since the <code>PhenoFlex</code> model has more than one parameter, we have to wrap it into another function (<code>PhenoFlex_GDHwrapper</code>), which requires a temperature dataset <code>x</code> and a vector containing all the parameters of the <code>PhenoFlex</code> model. Within the wrapper function, this parameter vector is unpacked, with each value assigned to the respective parameter.</li>
<li>a vector containing initial estimates for all parameters</li>
<li>a vector containing lower bounds for all parameters</li>
<li>a vector containing upper bounds for all parameters</li>
</ul>
<p>The order, in which the <code>PhenoFlex</code> parameters have to be provided, is given in the description of the <code>PhenoFlex_GDHwrapper</code> function as follows:</p>
<ol style="list-style-type: decimal">
<li><strong>yc</strong> - chilling requirement; critical value of y, which defines the end of chill accumulation - default value: 40</li>
<li><strong>zc</strong> - heat requirement; critical value of z, which defines the end of heat accumulation - default value: 190</li>
<li><strong>s1</strong> - slope parameter that determines the transition from the chill accumulation to the heat accumulation period in <code>PhenoFlex</code> - default value: 0.5</li>
<li><strong>Tu</strong> - optimal temperature of the Growing Degree Hours (GDH) model - default value: 25</li>
<li><strong>E0</strong> - time-independent activation energy of forming the PDBF - default value: 3372.8 (as in the widely used version of the Dynamic Model)</li>
<li><strong>E1</strong> - time-independent activation energy of destroying the PDBF - default value: 9900.3 (as in the widely used version of the Dynamic Model)</li>
<li><strong>A0</strong> - amplitude of the (hypothetical) process involved in forming the precursor to the dormancy-breaking factor in the Dynamic Model - default value: 6319.5 (as in the widely used version of the Dynamic Model)</li>
<li><strong>A1</strong> - amplitude of the (hypothetical) process involved in destroying the precursor to the dormancy-breaking factor (PDBF) in the Dynamic Model - default value: 5.939917e+13 (as in the widely used version of the Dynamic Model)</li>
<li><strong>Tf</strong> - transition temperature parameter of the sigmoidal function in the Dynamic Model, also involved in converting PDBF to Chill Portions - default value: 4</li>
<li><strong>Tc</strong> - upper threshold in the GDH model - default value: 36<br />
</li>
<li><strong>Tb</strong> - base temperature of the GDH model - default value: 4</li>
<li><strong>slope</strong> - slope parameter of the sigmoidal function in the Dynamic Model, which determines what fraction of the PDBF is converted to a Chill Portion - default value: 1.6</li>
</ol>
<p>Note that the <code>PhenoFlex_GDHwrapper</code> can only fit the version of the <code>PhenoFlex</code> model that uses a heat model based on the GDH concept. For use of the Gaussian heat model that can also be considered by <code>PhenoFlex</code>, use the <code>PhenoFlex_GAUSSwrapper</code> function.</p>
<p>For this example, we initiate the procedure with the default values, and we set upper and lower bounds as follows:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>par &lt;-<span class="st">   </span><span class="kw">c</span>(<span class="dv">40</span>, <span class="dv">190</span>, <span class="fl">0.5</span>, <span class="dv">25</span>, <span class="fl">3372.8</span>,  <span class="fl">9900.3</span>, <span class="fl">6319.5</span>, <span class="fl">5.939917e13</span>,  <span class="dv">4</span>, <span class="dv">36</span>,  <span class="dv">4</span>,  <span class="fl">1.60</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>upper &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">41</span>, <span class="dv">200</span>, <span class="fl">1.0</span>, <span class="dv">30</span>, <span class="fl">4000.0</span>, <span class="fl">10000.0</span>, <span class="fl">7000.0</span>,       <span class="dv">6</span>.e13, <span class="dv">10</span>, <span class="dv">40</span>, <span class="dv">10</span>, <span class="fl">50.00</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a>lower &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">38</span>, <span class="dv">180</span>, <span class="fl">0.1</span>, <span class="dv">0</span> , <span class="fl">3000.0</span>,  <span class="fl">9000.0</span>, <span class="fl">6000.0</span>,       <span class="dv">5</span>.e13,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="dv">0</span>,  <span class="fl">0.05</span>)</span></code></pre></div>
<p>Now, we can run the fitter:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>Fit_res &lt;-<span class="st"> </span><span class="kw">phenologyFitter</span>(<span class="dt">par.guess=</span>par, </span>
<span id="cb7-2"><a href="#cb7-2"></a>                           <span class="dt">modelfn =</span> PhenoFlex_GDHwrapper,</span>
<span id="cb7-3"><a href="#cb7-3"></a>                           <span class="dt">bloomJDays=</span>KA_bloom<span class="op">$</span>pheno[<span class="kw">which</span>(KA_bloom<span class="op">$</span>Year <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="dv">2003</span><span class="op">:</span><span class="dv">2008</span>))],</span>
<span id="cb7-4"><a href="#cb7-4"></a>                           <span class="dt">SeasonList=</span>SeasonList, <span class="dt">lower=</span>lower, <span class="dt">upper=</span>upper,</span>
<span id="cb7-5"><a href="#cb7-5"></a>                           <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">smooth=</span><span class="ot">FALSE</span>, <span class="dt">verbose=</span><span class="ot">FALSE</span>, <span class="dt">maxit=</span><span class="dv">10</span>,</span>
<span id="cb7-6"><a href="#cb7-6"></a>                                        <span class="dt">nb.stop.improvement=</span><span class="dv">5</span>))</span></code></pre></div>
<pre><code>## Loading required namespace: parallel</code></pre>
<p>Note that the list <code>control</code> regulates the behavior of the <code>GenSA</code> algorithm, the solving engine we are using here. Note further that <code>smooth=FALSE</code> must be set for the <code>PhenoFlex</code> model, since the objective function, the residual sum of squares between predicted and observed bloom days is calculated based on discrete data (days) and is thus not smooth. <code>verbose</code> controls whether messages from the algorithm are shown. <code>maxit</code> defines the maximum number of iterations of the algorithm and should have a value of at least 1000. <code>nb.stop.improvement</code> is the number of search steps of the algorithm, after which the solver is stopped when there is no further improvement of the fit.</p>
<p>In the example above, the values are chosen in a way that allows the fitter to finish quickly. <em>Thus, the result may not be particularly meaningful. More reasonable parameters are, for instance, the default values of <code>phenologyFitter</code></em>:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>control=<span class="kw">list</span>(<span class="dt">smooth=</span><span class="ot">FALSE</span>, <span class="dt">verbose=</span><span class="ot">TRUE</span>, <span class="dt">maxit=</span><span class="dv">1000</span>,</span>
<span id="cb9-2"><a href="#cb9-2"></a>             <span class="dt">nb.stop.improvement=</span><span class="dv">250</span>)</span></code></pre></div>
<p><code>phenologyFitter</code> can also be used with other models. For instance, in order to fit the <code>StepChill</code> model, we could add</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>modelfn=StepChill_Wrapper</span></code></pre></div>
<p>to the argument list of <code>phenologyFitter</code> and adapt the parameter vectors <code>par</code>, <code>upper</code> and <code>lower</code> accordingly.</p>
<p>The result of a fitting procedure can be summarized as follows</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">summary</span>(Fit_res)</span></code></pre></div>
<pre><code>
Phenology Fitter

Final RSS:  236.4722 
RMSE     :  6.277901 
R^2      :  3.875698 

data versus predicted:
  data predicted      delta
1  107 103.29167  3.7083333
2  110  99.12500 10.8750000
3  105  95.04167  9.9583333
4  116 114.33333  1.6666667
5  105 104.08333  0.9166667
6  115 116.29167 -1.2916667</code></pre>
<p>with <code>data</code> being the days where bloom or any other phenological event was observed, <code>predicted</code> the day that was predicted by the model and <code>delta</code> the difference between <code>data</code> and <code>predicted</code>, i.e. the residual error. These results can also be visualized using the <code>plot</code> function</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">plot</span>(Fit_res)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="computing-errors" class="section level1">
<h1>Computing Errors</h1>
<p>Model prediction are usually uncertain, and the possible errors this may produce should be expressed. To estimate these errors, we use a bootstrapping technique, which involves the following steps:</p>
<ol style="list-style-type: decimal">
<li>we first predict bloom dates using our fitted PhenoFlex framework (see above)</li>
<li>for all years in our calibration dataset, we calculate the residuals of the predictions (observed minus predicted bloom dates)</li>
<li>we then take the whole population of these residuals and draw as many random samples from it as we have years in our calibration dataset. In drawing these samples, it is important that they are drawn <em>with replacement</em>, i.e. all values that were calculated in step 2 are available each time a sample is drawn.</li>
<li>we add the residuals that we obtained in step 3 to the phenological dates in our <strong>calibration dataset</strong></li>
<li>we use the resulting dates to again fit the parameters of the <code>PhenoFlex</code> framework, make predictions <strong>for the validation dataset</strong> and record the results for each year</li>
<li>we repeat steps 3-5 many times, recording prediction results for each repetition</li>
<li>based on the population of predicted bloom dates for each year, we calculate standard deviations of the resulting distribution, as well as the <span class="math inline">\(16^{th}\)</span> and <span class="math inline">\(84^{th}\)</span> percentiles, which provide estimates of the standard error. More details on this procedure and the whole <code>PhenoFlex</code> concept will eventually be provided in a peer-reviewed paper</li>
</ol>
<p>In short, the residuals are bootstrapped and then the fit is repeated. This procedure is performed <code>boot.R</code> times.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>Fit_res.boot &lt;-<span class="st"> </span><span class="kw">bootstrap.phenologyFit</span>(Fit_res, <span class="dt">boot.R=</span><span class="dv">10</span>,</span>
<span id="cb14-2"><a href="#cb14-2"></a>                                       <span class="dt">control=</span><span class="kw">list</span>(<span class="dt">smooth=</span><span class="ot">FALSE</span>, <span class="dt">verbose=</span><span class="ot">TRUE</span>, <span class="dt">maxit=</span><span class="dv">10</span>,</span>
<span id="cb14-3"><a href="#cb14-3"></a>                                                    <span class="dt">nb.stop.improvement=</span><span class="dv">5</span>),</span>
<span id="cb14-4"><a href="#cb14-4"></a>                                       <span class="dt">lower=</span>lower, <span class="dt">upper=</span>upper, <span class="dt">seed=</span><span class="dv">1726354</span>)</span></code></pre></div>
<pre><code>## ========It: 1, obj value: 47.33680556
## ================================It: 5, obj value: 67.60416667
## ================================It: 1, obj value: 50.99305556
## ========</code></pre>
<p>Like for the result of <code>phenologyFitter</code> there is also a <code>summary</code> and a <code>plot</code> function for <code>bootstrap.phenologyFit</code>.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">summary</span>(Fit_res.boot)</span></code></pre></div>
<pre><code>            par          Err          q16          q84
1  3.911677e+01 9.584581e-01 3.823354e+01 4.028590e+01
2  1.955518e+02 6.843893e+00 1.811036e+02 1.951743e+02
3  3.217589e-01 2.689564e-01 1.155336e-01 6.193524e-01
4  2.500000e+01 5.411397e+00 1.508267e+01 2.759297e+01
5  3.372800e+03 3.199775e+01 3.326714e+03 3.372800e+03
6  9.900300e+03 4.906707e+01 9.801985e+03 9.900300e+03
7  6.278621e+03 3.116245e+02 6.237743e+03 6.884704e+03
8  5.939917e+13 4.619012e+07 5.939917e+13 5.939926e+13
9  4.000000e+00 1.840636e+00 4.000000e+00 7.142853e+00
10 3.600000e+01 7.252527e+00 2.070064e+01 3.600000e+01
11 4.000000e+00 2.497953e+00 3.101301e+00 8.145203e+00
12 1.600000e+00 1.582771e+01 1.600000e+00 2.492449e+01</code></pre>
<p>with <code>par</code> being the estimated parameter values, <code>Err</code> the standard deviation of the bootstrap distribution and <code>q16</code> and <code>q84</code> the 16. and 84. percentiles, respectively.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">plot</span>(Fit_res.boot)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>This plot now shows observed bloom dates, as well as bloom dates predicted with the <code>PhenoFlex</code> model, including an estimate of prediction uncertainty (shown as error bars).</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
