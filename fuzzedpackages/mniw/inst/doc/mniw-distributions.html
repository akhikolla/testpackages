<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Martin Lysy" />

<meta name="date" content="2019-10-09" />

<title>Distributions Provided by the mniw Package</title>






<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Distributions Provided by the <strong>mniw</strong> Package</h1>
<h4 class="author">Martin Lysy</h4>
<h4 class="date">2019-10-09</h4>


<div id="TOC">
<ul>
<li><a href="#wishart-distribution">Wishart Distribution</a><ul>
<li><a href="#inverse-wishart-distribution">Inverse-Wishart Distribution</a></li>
<li><a href="#properties">Properties</a></li>
</ul></li>
<li><a href="#matrix-normal-distribution">Matrix-Normal Distribution</a><ul>
<li><a href="#properties-1">Properties</a></li>
</ul></li>
<li><a href="#matrix-normal-inverse-wishart-distribution">Matrix-Normal Inverse-Wishart Distribution</a><ul>
<li><a href="#properties-2">Properties</a></li>
</ul></li>
<li><a href="#matrix-t-distribution">Matrix-t Distribution</a><ul>
<li><a href="#properties-3">Properties</a></li>
</ul></li>
<li><a href="#random-effects-normal-distribution">Random-Effects Normal Distribution</a></li>
<li><a href="#hierarchical-normal-normal-model">Hierarchical Normal-Normal Model</a></li>
</ul>
</div>

<!-- <script type="text/x-mathjax-config"> -->
<!-- MathJax.Hub.Config({ -->
<!--     TeX: { -->
<!--    Macros: { -->
<!--        bm: ["{\\boldsymbol{#1}}",1], -->
<!--        tx: ["{\\textrm{#1}}",1], -->
<!--        tfrac: ["{\\textstyle{\\frac{#1}{#2}}}",2], -->
<!--        rv: ["{#2_{#1},\\ldots,#2_{#3}}",3,"1"], -->
<!--        iid: ["{\\overset{\\;\\tx{iid}\\;}{\\sim}}"], -->
<!--        ind: ["{\\overset{\\:\\tx{ind}\\:}{\\sim}}"], -->
<!--        XX: ["{\\bm{X}}"], -->
<!--        YY: ["{\\bm{Y}}"], -->
<!--        LL: ["{\\bm{L}}"], -->
<!--        PPs: ["{\\bm{\\Psi}}"], -->
<!--        ZZ: ["{\\bm{Z}}"], -->
<!--        N: ["{\\mathcal{N}}"], -->
<!--        LLa: ["{\\bm{\\Lambda}}"], -->
<!--        SSi: ["{\\bm{\\Sigma}}"], -->
<!--        GGa: ["{\\bm{\\Gamma}}"], -->
<!--        UU: ["{\\bm{U}}"], -->
<!--        VV: ["{\\bm{V}}"], -->
<!--        aa: ["{\\bm{a}}"], -->
<!--        bb: ["{\\bm{b}}"], -->
<!--        xx: ["{\\bm{x}}"], -->
<!--        yy: ["{\\bm{y}}"], -->
<!--        bbe: ["{\\bm{\\beta}}"], -->
<!--        mmu: ["{\\bm{\\mu}}"], -->
<!--        kka: ["{\\bm{\\kappa}}"], -->
<!--        lla: ["{\\bm{\\lambda}}"], -->
<!--        TTh: ["{\\bm{\\Theta}}"], -->
<!--        GG: ["{\\bm{G}}"], -->
<!--        OOm: ["{\\bm{\\Omega}}"], -->
<!--        bz: ["{\\bm{0}}"], -->
<!--        wish: ["{\\tx{Wish}}"], -->
<!--        iwish: ["{\\tx{InvWish}}"], -->
<!--        MN: ["{\\tx{MatNorm}}"], -->
<!--        MT: ["{\\tx{MatT}}"], -->
<!--        mniw: ["{\\tx{MNIW}}"], -->
<!--        re: ["{\\tx{RxNorm}}"] -->
<!--    } -->
<!--     } -->
<!-- }); -->
<!-- </script> -->

<div id="wishart-distribution" class="section level2">
<h2>Wishart Distribution</h2>
<p>The Wishart distribution on a random positive-definite matrix <span class="math inline">\({\boldsymbol{X}}_{q\times q}\)</span> is is denoted <span class="math inline">\({\boldsymbol{X}}\sim \textrm{Wish}({\boldsymbol{\Psi}}, \nu)\)</span>, and defined as <span class="math inline">\({\boldsymbol{X}}= ({\boldsymbol{L}}{\boldsymbol{Z}})({\boldsymbol{L}}{\boldsymbol{Z}})&#39;\)</span>, where:</p>
<ul>
<li><p><span class="math inline">\({\boldsymbol{\Psi}}_{q\times q} = {\boldsymbol{L}}{\boldsymbol{L}}&#39;\)</span> is the positive-definite matrix scale parameter,</p></li>
<li><p><span class="math inline">\(\nu &gt; q\)</span> is the shape parameter,</p></li>
<li><p><span class="math inline">\({\boldsymbol{Z}}_{q\times q}\)</span> is a random lower-triangular matrix with elements</p>
<p><span class="math display">\[
  Z_{ij} \begin{cases} 
         \overset{\;\textrm{iid}\;}{\sim}\mathcal{N}(0,1) &amp; i &lt; j \\ 
         \overset{\:\textrm{ind}\:}{\sim}\chi^2_{(\nu-i+1)} &amp; i = j \\
         = 0 &amp; i &gt; j.
         \end{cases}
  \]</span></p></li>
</ul>
<p>The log-density of the Wishart distribution is <span class="math display">\[
\log p({\boldsymbol{X}}\mid {\boldsymbol{\Psi}}, \nu) = -\textstyle{\frac{1}{2}} \left[\mathrm{tr}({\boldsymbol{\Psi}}^{-1} {\boldsymbol{X}}) + (q+1-\nu)\log |{\boldsymbol{X}}| + \nu \log |{\boldsymbol{\Psi}}|  + \nu q \log(2) + 2 \log \Gamma_q(\textstyle{\frac{\nu }{2}})\right],
\]</span> where <span class="math inline">\(\Gamma_n(x)\)</span> is the multivariate Gamma function defined as <span class="math display">\[
\Gamma_n(x) = \pi^{n(n-1)/4} \prod_{j=1}^n \Gamma\big(x + \textstyle{\frac{1}{2}} (1-j)\big).
\]</span></p>
<div id="inverse-wishart-distribution" class="section level3">
<h3>Inverse-Wishart Distribution</h3>
<p>The Inverse-Wishart distribution <span class="math inline">\({\boldsymbol{X}}\sim \textrm{InvWish}({\boldsymbol{\Psi}}, \nu)\)</span> is defined as <span class="math inline">\({\boldsymbol{X}}^{-1} \sim \textrm{Wish}({\boldsymbol{\Psi}}^{-1}, \nu)\)</span>. Its log-density is given by <span class="math display">\[
\log p({\boldsymbol{X}}\mid {\boldsymbol{\Psi}}, \nu) = -\textstyle{\frac{1}{2}} \left[\mathrm{tr}({\boldsymbol{\Psi}}{\boldsymbol{X}}^{-1}) + (\nu+q+1) \log |{\boldsymbol{X}}| - \nu \log |{\boldsymbol{\Psi}}| + \nu q \log(2) + 2 \log \Gamma_q(\textstyle{\frac{\nu }{2}})\right].
\]</span></p>
</div>
<div id="properties" class="section level3">
<h3>Properties</h3>
<p>If <span class="math inline">\({\boldsymbol{X}}_{q\times q} \sim \textrm{Wish}({\boldsymbol{\Psi}},\nu)\)</span>, the for a nonzero vector <span class="math inline">\({\boldsymbol{a}}\in \mathbb R^q\)</span> we have <span class="math display">\[
\frac{{\boldsymbol{a}}&#39;{\boldsymbol{X}}{\boldsymbol{a}}}{{\boldsymbol{a}}&#39;{\boldsymbol{\Psi}}{\boldsymbol{a}}} \sim \chi^2_{(\nu)}.
\]</span></p>
</div>
</div>
<div id="matrix-normal-distribution" class="section level2">
<h2>Matrix-Normal Distribution</h2>
<p>The Matrix-Normal distribution on a random matrix <span class="math inline">\({\boldsymbol{X}}_{p \times q}\)</span> is denoted <span class="math inline">\({\boldsymbol{X}}\sim \textrm{MatNorm}({\boldsymbol{\Lambda}}, {\boldsymbol{\Sigma}}_R, {\boldsymbol{\Sigma}}_C)\)</span>, and defined as <span class="math inline">\({\boldsymbol{X}}= {\boldsymbol{L}}{\boldsymbol{Z}}{\boldsymbol{U}}+ {\boldsymbol{\Lambda}}\)</span>, where:</p>
<ul>
<li><span class="math inline">\({\boldsymbol{\Lambda}}_{p \times q}\)</span> is the mean matrix parameter,</li>
<li><span class="math inline">\({{\boldsymbol{\Sigma}}_R}_{p \times p} = {\boldsymbol{L}}{\boldsymbol{L}}&#39;\)</span> is the row-variance matrix parameter,</li>
<li><span class="math inline">\({{\boldsymbol{\Sigma}}_C}_{q \times q} = {\boldsymbol{U}}&#39;{\boldsymbol{U}}\)</span> is the column-variance matrix parameter,</li>
<li><span class="math inline">\({\boldsymbol{Z}}_{q\times q}\)</span> is a random matrix with <span class="math inline">\(Z_{ij} \overset{\;\textrm{iid}\;}{\sim}\mathcal{N}(0,1)\)</span>.</li>
</ul>
<p>The log-density of the Matrix-Normal distribution is <span class="math display">\[
\log p({\boldsymbol{X}}\mid {\boldsymbol{\Lambda}}, {\boldsymbol{\Sigma}}_R, {\boldsymbol{\Sigma}}_C) = -\textstyle{\frac{1}{2}} \left[\mathrm{tr}\big({\boldsymbol{\Sigma}}_C^{-1}({\boldsymbol{X}}-{\boldsymbol{\Lambda}})&#39;{\boldsymbol{\Sigma}}_R^{-1}({\boldsymbol{X}}-{\boldsymbol{\Lambda}})\big) + \nu q \log(2\pi) + \nu \log |{\boldsymbol{\Sigma}}_C| + q \log |{\boldsymbol{\Sigma}}_R|\right].
\]</span></p>
<div id="properties-1" class="section level3">
<h3>Properties</h3>
<p>If <span class="math inline">\({\boldsymbol{X}}_{p \times q} \sim \textrm{MatNorm}({\boldsymbol{\Lambda}}, {\boldsymbol{\Sigma}}_R, {\boldsymbol{\Sigma}}_C)\)</span>, then for nonzero vectors <span class="math inline">\({\boldsymbol{a}}\in \mathbb R^p\)</span> and <span class="math inline">\({\boldsymbol{b}}\in \mathbb R^q\)</span> we have <span class="math display">\[
{\boldsymbol{a}}&#39; {\boldsymbol{X}}{\boldsymbol{b}}\sim \mathcal{N}({\boldsymbol{a}}&#39; {\boldsymbol{\Lambda}}{\boldsymbol{b}}, {\boldsymbol{a}}&#39;{\boldsymbol{\Sigma}}_R{\boldsymbol{a}}\cdot {\boldsymbol{b}}&#39;{\boldsymbol{\Sigma}}_C{\boldsymbol{b}}).
\]</span></p>
</div>
</div>
<div id="matrix-normal-inverse-wishart-distribution" class="section level2">
<h2>Matrix-Normal Inverse-Wishart Distribution</h2>
<p>The Matrix-Normal Inverse-Wishart Distribution on a random matrix <span class="math inline">\({\boldsymbol{X}}_{p \times q}\)</span> and random positive-definite matrix <span class="math inline">\({\boldsymbol{V}}_{q\times q}\)</span> is denoted <span class="math inline">\(({\boldsymbol{X}},{\boldsymbol{V}}) \sim \textrm{MNIW}({\boldsymbol{\Lambda}}, {\boldsymbol{\Sigma}}, {\boldsymbol{\Psi}}, \nu)\)</span>, and defined as <span class="math display">\[
\begin{aligned}
{\boldsymbol{X}}\mid {\boldsymbol{V}}&amp; \sim \textrm{MatNorm}({\boldsymbol{\Lambda}}, {\boldsymbol{\Sigma}}, {\boldsymbol{V}}) \\
{\boldsymbol{V}}&amp; \sim \textrm{InvWish}({\boldsymbol{\Psi}}, \nu).
\end{aligned}
\]</span></p>
<div id="properties-2" class="section level3">
<h3>Properties</h3>
<p>The MNIX distribution is conjugate prior for the multivariable response regression model <span class="math display">\[
{\boldsymbol{Y}}_{n \times q} \sim \textrm{MatNorm}({\boldsymbol{X}}_{n\times p} {\boldsymbol{\beta}}_{p \times q}, {\boldsymbol{V}}, {\boldsymbol{\Sigma}}).
\]</span> That is, if <span class="math inline">\(({\boldsymbol{\beta}}, {\boldsymbol{\Sigma}}) \sim \textrm{MNIW}({\boldsymbol{\Lambda}}, {\boldsymbol{\Omega}}^{-1}, {\boldsymbol{\Psi}}, \nu)\)</span>, then <span class="math display">\[
{\boldsymbol{\beta}}, {\boldsymbol{\Sigma}}\mid {\boldsymbol{Y}}\sim \textrm{MNIW}(\hat {\boldsymbol{\Lambda}}, \hat {\boldsymbol{\Omega}}^{-1}, \hat {\boldsymbol{\Psi}}, \hat \nu),
\]</span> where <span class="math display">\[
\begin{aligned}
\hat {\boldsymbol{\Omega}}&amp; = {\boldsymbol{X}}&#39;{\boldsymbol{V}}^{-1}{\boldsymbol{X}}+ {\boldsymbol{\Omega}}
&amp;
\hat {\boldsymbol{\Psi}}&amp; = {\boldsymbol{\Psi}}+ {\boldsymbol{Y}}&#39;{\boldsymbol{V}}^{-1}{\boldsymbol{Y}}+ {\boldsymbol{\Lambda}}&#39;{\boldsymbol{\Omega}}{\boldsymbol{\Lambda}}- \hat {\boldsymbol{\Lambda}}&#39;\hat {\boldsymbol{\Omega}}\hat {\boldsymbol{\Lambda}}
\\
\hat {\boldsymbol{\Lambda}}&amp; = \hat {\boldsymbol{\Omega}}^{-1}({\boldsymbol{X}}&#39;{\boldsymbol{V}}^{-1}{\boldsymbol{Y}}+ {\boldsymbol{\Omega}}{\boldsymbol{\Lambda}})
&amp;
\hat \nu &amp; = \nu + n.
\end{aligned}
\]</span></p>
</div>
</div>
<div id="matrix-t-distribution" class="section level2">
<h2>Matrix-t Distribution</h2>
<p>The Matrix-<span class="math inline">\(t\)</span> distribution on a random matrix <span class="math inline">\({\boldsymbol{X}}_{p \times q}\)</span> is denoted <span class="math inline">\({\boldsymbol{X}}\sim \textrm{MatT}({\boldsymbol{\Lambda}}, {\boldsymbol{\Sigma}}_R, {\boldsymbol{\Sigma}}_C, \nu)\)</span>, and defined as the marginal distribution of <span class="math inline">\({\boldsymbol{X}}\)</span> for <span class="math inline">\(({\boldsymbol{X}}, {\boldsymbol{V}}) \sim \textrm{MNIW}({\boldsymbol{\Lambda}}, {\boldsymbol{\Sigma}}_R, {\boldsymbol{\Sigma}}_C, \nu)\)</span>. Its log-density is given by <span class="math display">\[
\begin{aligned}
\log p({\boldsymbol{X}}\mid {\boldsymbol{\Lambda}}, {\boldsymbol{\Sigma}}_R, {\boldsymbol{\Sigma}}_C, \nu) 
&amp; = -\textstyle{\frac{1}{2}} \Big[(\nu+p+q-1)\log | I + {\boldsymbol{\Sigma}}_R^{-1}({\boldsymbol{X}}-{\boldsymbol{\Lambda}}){\boldsymbol{\Sigma}}_C^{-1}({\boldsymbol{X}}-{\boldsymbol{\Lambda}})&#39;| \\
&amp; \phantom{= -\textstyle{\frac{1}{2}} \Big[} + q \log |{\boldsymbol{\Sigma}}_R| + p \log |{\boldsymbol{\Sigma}}_C| \\
&amp; \phantom{= -\textstyle{\frac{1}{2}} \Big[} + pq \log(\pi) - \log \Gamma_q(\textstyle{\frac{\nu+p+q-1}{2}}) + \log \Gamma_q(\textstyle{\frac{\nu+q-1}{2}})\Big].
\end{aligned}
\]</span></p>
<div id="properties-3" class="section level3">
<h3>Properties</h3>
<p>If <span class="math inline">\({\boldsymbol{X}}_{p\times q} \sim \textrm{MatT}({\boldsymbol{\Lambda}}, {\boldsymbol{\Sigma}}_R, {\boldsymbol{\Sigma}}_C, \nu)\)</span>, then for nonzero vectors <span class="math inline">\({\boldsymbol{a}}\in \mathbb R^p\)</span> and <span class="math inline">\({\boldsymbol{b}}\in \mathbb R^q\)</span> we have <span class="math display">\[
\frac{{\boldsymbol{a}}&#39;{\boldsymbol{X}}{\boldsymbol{b}}- \mu}{\sigma} \sim t_{(\nu -q + 1)},
\]</span> where <span class="math display">\[
\mu = {\boldsymbol{a}}&#39;{\boldsymbol{\Lambda}}{\boldsymbol{b}}, \qquad \sigma^2 = \frac{{\boldsymbol{a}}&#39;{\boldsymbol{\Sigma}}_R{\boldsymbol{a}}\cdot {\boldsymbol{b}}&#39;{\boldsymbol{\Sigma}}_C{\boldsymbol{b}}}{\nu - q + 1}.
\]</span></p>
</div>
</div>
<div id="random-effects-normal-distribution" class="section level2">
<h2>Random-Effects Normal Distribution</h2>
<p>Consider the multivariate normal distribution on <span class="math inline">\(q\)</span>-dimensional vectors <span class="math inline">\({\boldsymbol{x}}\)</span> and <span class="math inline">\({\boldsymbol{\mu}}\)</span> given by <span class="math display">\[
\begin{aligned}
{\boldsymbol{x}}\mid {\boldsymbol{\mu}}&amp; \sim \mathcal{N}({\boldsymbol{\mu}}, {\boldsymbol{V}}) \\
{\boldsymbol{\mu}}&amp; \sim \mathcal{N}({\boldsymbol{\lambda}}, {\boldsymbol{\Sigma}}).
\end{aligned}
\]</span> The random-effects normal distribution is defined as the posterior distribution <span class="math inline">\({\boldsymbol{\mu}}\sim p({\boldsymbol{\mu}}\mid {\boldsymbol{x}})\)</span>, which is given by <span class="math display">\[
{\boldsymbol{\mu}}\mid {\boldsymbol{x}}\sim \mathcal{N}\big({\boldsymbol{G}}({\boldsymbol{x}}-{\boldsymbol{\lambda}}) + {\boldsymbol{\lambda}}, {\boldsymbol{G}}{\boldsymbol{V}}\big), \qquad {\boldsymbol{G}}= {\boldsymbol{\Sigma}}({\boldsymbol{V}}+ {\boldsymbol{\Sigma}})^{-1}.
\]</span> The notation for this distribution is <span class="math inline">\({\boldsymbol{\mu}}\sim \textrm{RxNorm}({\boldsymbol{x}}, {\boldsymbol{V}}, {\boldsymbol{\lambda}}, {\boldsymbol{\Sigma}})\)</span>.</p>
</div>
<div id="hierarchical-normal-normal-model" class="section level2">
<h2>Hierarchical Normal-Normal Model</h2>
<p>The hierarchical Normal-Normal model is defined as <span class="math display">\[
\begin{aligned}
{\boldsymbol{y}}_i \mid {\boldsymbol{\mu}}_i, {\boldsymbol{\beta}}, {\boldsymbol{\Sigma}}&amp; \overset{\:\textrm{ind}\:}{\sim}\mathcal{N}({\boldsymbol{\mu}}_i, {\boldsymbol{V}}_i) \\
{\boldsymbol{\mu}}_i \mid {\boldsymbol{\beta}}, {\boldsymbol{\Sigma}}&amp; \overset{\;\textrm{iid}\;}{\sim}\mathcal{N}({\boldsymbol{x}}_i&#39;{\boldsymbol{\beta}}, {\boldsymbol{\Sigma}}) \\
({\boldsymbol{\beta}}, {\boldsymbol{\Sigma}}) &amp; \sim \textrm{MNIW}({\boldsymbol{\Lambda}}, \Omega^{-1}, {\boldsymbol{\Psi}}, \nu),
\end{aligned}
\]</span> where:</p>
<ul>
<li><span class="math inline">\({{\boldsymbol{y}}_i}_{q\times 1}\)</span> is the response vector for subject <span class="math inline">\(i\)</span>,</li>
<li><span class="math inline">\({{\boldsymbol{\mu}}_i}_{q\times 1}\)</span> is the random effect for subject <span class="math inline">\(i\)</span>,</li>
<li><span class="math inline">\({{\boldsymbol{V}}_i}_{q\times q}\)</span> is the error variance for subject <span class="math inline">\(i\)</span>,</li>
<li><span class="math inline">\({{\boldsymbol{x}}_i}_{p\times 1}\)</span> is the covariate vector for subject <span class="math inline">\(i\)</span>,</li>
<li><span class="math inline">\({\boldsymbol{\beta}}_{p \times q}\)</span> is the random-effects coefficient matrix,</li>
<li><span class="math inline">\({\boldsymbol{\Sigma}}_{q \times q}\)</span> is the random-effects error variance.</li>
</ul>
<p>Let <span class="math inline">\({\boldsymbol{Y}}_{n\times q} = (n_{\boldsymbol{y}},\ldots,n_{)}\)</span>, <span class="math inline">\({\boldsymbol{X}}_{n\times p} = (n_{\boldsymbol{x}},\ldots,n_{)}\)</span>, and <span class="math inline">\({\boldsymbol{\Theta}}_{n \times q} = (n_{\boldsymbol{\mu}},\ldots,n_{)}\)</span>. If interest lies in the posterior distribution <span class="math inline">\(p({\boldsymbol{\Theta}}, {\boldsymbol{\beta}}, {\boldsymbol{\Sigma}}\mid {\boldsymbol{Y}}, {\boldsymbol{X}})\)</span>, then a Gibbs sampler can be used to cycle through the following conditional distributions: <span class="math display">\[
\begin{aligned}
{\boldsymbol{\mu}}_i \mid {\boldsymbol{\beta}}, {\boldsymbol{\Sigma}}, {\boldsymbol{Y}}, {\boldsymbol{X}}&amp; \overset{\:\textrm{ind}\:}{\sim}\textrm{RxNorm}({\boldsymbol{y}}_i, {\boldsymbol{V}}_i, {\boldsymbol{x}}_i&#39;{\boldsymbol{\beta}}, {\boldsymbol{\Sigma}}) \\
{\boldsymbol{\beta}}, {\boldsymbol{\Sigma}}\mid {\boldsymbol{\Theta}}, {\boldsymbol{Y}}, {\boldsymbol{X}}&amp; \sim \textrm{MNIW}(\hat {\boldsymbol{\Lambda}}, \hat {\boldsymbol{\Omega}}^{-1}, \hat {\boldsymbol{\Psi}}, \hat \nu),
\end{aligned}
\]</span> where <span class="math inline">\(\hat {\boldsymbol{\Lambda}}\)</span>, <span class="math inline">\(\hat {\boldsymbol{\Omega}}\)</span>, <span class="math inline">\(\hat {\boldsymbol{\Psi}}\)</span>, and <span class="math inline">\(\hat \nu\)</span> are obtained from the MNIW conjugate posterior formula with <span class="math inline">\({\boldsymbol{Y}}\gets {\boldsymbol{\Theta}}\)</span>.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
