<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Dean Bodenham" />

<meta name="date" content="2018-06-27" />

<title>Introduction to CASMAP</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to CASMAP</h1>
<h4 class="author">Dean Bodenham</h4>
<h4 class="date">27 June 2018</h4>



<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>The <code>CASMAP</code> package provides methods for searching for combinatorial associations inbinary data while taking categorical covariates into account. There are two main modes: the methods either search for region-based mappings or for higher order epistatic interactions.</p>
<div id="creating-casmap-objects" class="section level2">
<h2>Creating <code>CASMAP</code> objects</h2>
<p>To create a <code>CASMAP</code> object, it is necessary to specify the mode. The first example below creates an object that will perform a region-based GWAS search, and then sets the target family-wise error rate to <code>0.01</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(CASMAP)</a>
<a class="sourceLine" id="cb1-2" title="2"></a>
<a class="sourceLine" id="cb1-3" title="3"><span class="co"># An example using the &quot;regionGWAS&quot; mode</span></a>
<a class="sourceLine" id="cb1-4" title="4">fastcmh &lt;-<span class="st"> </span><span class="kw">CASMAP</span>(<span class="dt">mode=</span><span class="st">&quot;regionGWAS&quot;</span>)      <span class="co"># initialise object</span></a>
<a class="sourceLine" id="cb1-5" title="5">fastcmh<span class="op">$</span><span class="kw">setTargetFWER</span>(<span class="fl">0.01</span>)              <span class="co"># set target FWER</span></a></code></pre></div>
<p>The next example shows how to create an object that will search for arbitrary combinations, i.e.Â a higher order epistatic search. Note that it is also possible to set the target family-wise error rate when constructing the object by setting <code>alpha</code>.</p>
<p>By printing the object, one can see certain information. The field <em>Maximum combination size = 0</em> indicates that combinations of all possible length will be considered. In future versions, it will be possible to limit this number, for example to combinations of maxmimum length 4.</p>
<!--Furthermore, while the default option is to search for combinations of arbitary length, it is also possible to limit the length of combinations that are considered. For example, setting the parameter `max_comb_size=4` below limits the search to only combinations of length 1, 2, 3, and 4.
-->
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(CASMAP)</a>
<a class="sourceLine" id="cb2-2" title="2"></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co"># Another example, doing higher order epistasis search  with target FWER 0.01</span></a>
<a class="sourceLine" id="cb2-4" title="4">facs &lt;-<span class="st"> </span><span class="kw">CASMAP</span>(<span class="dt">mode=</span><span class="st">&quot;higherOrderEpistasis&quot;</span>, <span class="dt">alpha=</span><span class="fl">0.01</span>)      </a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw">print</span>(facs)</a></code></pre></div>
<pre><code>## CASMAP object with: 
##  * Mode = higherOrderEpistasis 
##  * Target FWER = 0.01 
##  * Maximum combination size = 0 
##  * No input files read</code></pre>
</div>
<div id="reading-in-the-data-files" class="section level2">
<h2>Reading in the data files</h2>
<p>Once the object is created, the next step is to read in the data files. The <code>readLines</code> command is used, and paths to the data files should be specified for the parameters <code>genotype_file</code>, <code>phenotype_file</code> and (optionally) <code>covariate_file</code>. We have provided example data files with the package, as well as functions to easily get the paths to these data files:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw">library</span>(CASMAP)</a>
<a class="sourceLine" id="cb4-2" title="2">fastcmh &lt;-<span class="st"> </span><span class="kw">CASMAP</span>(<span class="dt">mode=</span><span class="st">&quot;regionGWAS&quot;</span>)          <span class="co"># initialise object</span></a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4">datafile &lt;-<span class="st"> </span><span class="kw">getExampleDataFilename</span>()        <span class="co"># file name of example data</span></a>
<a class="sourceLine" id="cb4-5" title="5">labelsfile &lt;-<span class="st"> </span><span class="kw">getExampleLabelsFilename</span>()   <span class="co"># file name of example labels</span></a>
<a class="sourceLine" id="cb4-6" title="6">covfile &lt;-<span class="st"> </span><span class="kw">getExampleCovariatesFilename</span>() <span class="co"># file name of example covariates </span></a>
<a class="sourceLine" id="cb4-7" title="7"></a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co"># read the data, labels and (optionally) covariate files</span></a>
<a class="sourceLine" id="cb4-9" title="9">fastcmh<span class="op">$</span><span class="kw">readFiles</span>(<span class="dt">genotype_file=</span><span class="kw">getExampleDataFilename</span>(),</a>
<a class="sourceLine" id="cb4-10" title="10">                   <span class="dt">phenotype_file=</span><span class="kw">getExampleLabelsFilename</span>(), </a>
<a class="sourceLine" id="cb4-11" title="11">                   <span class="dt">covariate_file=</span><span class="kw">getExampleCovariatesFilename</span>())</a>
<a class="sourceLine" id="cb4-12" title="12"></a>
<a class="sourceLine" id="cb4-13" title="13"><span class="co">#The object now displays that data files have been read, and covariates are used</span></a>
<a class="sourceLine" id="cb4-14" title="14"><span class="kw">print</span>(fastcmh)</a></code></pre></div>
<pre><code>## CASMAP object with: 
##  * Mode = regionGWAS 
##  * Target FWER = 0.05 
##  * Maximum combination size = 0 
##  * Input files read 
##  * Covariate = TRUE</code></pre>
</div>
<div id="data-format" class="section level2">
<h2>Data format</h2>
<p>Note that the <code>CASMAP</code> methods expect the data file to be a text file consisting of space-separated <code>0</code>s and <code>1</code>s, in an <span class="math inline">\(p \times n\)</span> matrix, where each of the <span class="math inline">\(p\)</span> rows is a feature, and each of the <span class="math inline">\(n\)</span> columns is a sample/subject. The labels and covariates files are single columns of <span class="math inline">\(n\)</span> entries, where each entry is <code>0</code> or <code>1</code>. To see an example of the data format, take a look at the included example files, the paths to which are given by the commands <code>getExampleDataFilename</code>, <code>getExampleLabelsFilename</code> and <code>getExampleCovariatesFilename</code>:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="co">#to see where these data files are located on your local drive:</span></a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw">print</span>(<span class="kw">getExampleDataFilename</span>())</a>
<a class="sourceLine" id="cb6-3" title="3"></a>
<a class="sourceLine" id="cb6-4" title="4"><span class="co">## Example: </span></a>
<a class="sourceLine" id="cb6-5" title="5"><span class="co">## [1] &quot;/path/to/pkgs/CASMAP/extdata/CASMAP_example_data_1.txt&quot;</span></a></code></pre></div>
<p>In future versions the PLINK data format will be supported.</p>
</div>
<div id="executing-the-algorithm" class="section level2">
<h2>Executing the algorithm</h2>
<p>Once you have read in the data, label and covariates files, you are ready to execute the algorithm. Simply use the <code>execute</code> command. Note that, depending on the size of your data set, this could take some time.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># execute the algorithm (this may take some time)</span></a>
<a class="sourceLine" id="cb7-2" title="2">fastcmh<span class="op">$</span><span class="kw">execute</span>()</a></code></pre></div>
</div>
<div id="extracting-the-results" class="section level2">
<h2>Extracting the results</h2>
<p>There are two main sets of results:</p>
<ol style="list-style-type: decimal">
<li>Summary results</li>
<li>Information on significant regions/significant interactions</li>
</ol>
<p>The summary results provide information on how many regions/interactions were processed, how many are testable, and what are the significance and testable thresholds:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co">#get the summary results</span></a>
<a class="sourceLine" id="cb8-2" title="2">summary_results &lt;-<span class="st"> </span>fastcmh<span class="op">$</span><span class="kw">getSummary</span>()</a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw">print</span>(summary_results)</a></code></pre></div>
<pre><code>## $n.int.processed
## [1] 18193
## 
## $n.int.testable
## [1] 16426
## 
## $testability.threshold
## [1] 2.630268e-06
## 
## $target.fwer
## [1] 0.05
## 
## $corrected.significance.threshold
## [1] 3.043955e-06</code></pre>
<p>It is also possible to write this information to file directly using the <code>writeSummary</code> command.</p>
<p>The significant regions lists all the regions that are considered significant. However, it is possible that these regions overlap into clusters. The most significant regions in these clusters can be extracted using the <code>getSignificantClusterRepresentatives</code> command. In the example below, there is only one significant regions, so it is its own cluster representative:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co">#get the significant regions</span></a>
<a class="sourceLine" id="cb10-2" title="2">sig_regions &lt;-<span class="st"> </span>fastcmh<span class="op">$</span><span class="kw">getSignificantRegions</span>()</a>
<a class="sourceLine" id="cb10-3" title="3"><span class="kw">print</span>(sig_regions)</a></code></pre></div>
<pre><code>##   start end    score odds_ratio       pvalue
## 1    99 102 24.56281   16.12821 7.192676e-07</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co">#get the clustered representatives for the significant regions</span></a>
<a class="sourceLine" id="cb12-2" title="2">sig_cluster_rep &lt;-<span class="st"> </span>fastcmh<span class="op">$</span><span class="kw">getSignificantClusterRepresentatives</span>()</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">print</span>(sig_cluster_rep)</a></code></pre></div>
<pre><code>##   start end    score odds_ratio       pvalue
## 1    99 102 24.56281   16.12821 7.192676e-07</code></pre>
<p>Note that the <span class="math inline">\(p\)</span>-value and odds ratio for the regions/representatives is provided along with the location.</p>
<p>For the <code>higherOrderEpistasis</code> mode, the method <code>getSignificantInteractions</code> should be used (and there are no cluster representatives).</p>
</div>
<div id="other-examples" class="section level2">
<h2>Other examples</h2>
<p>It is also possible to perform a search without any covariates:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="co">## Another example of regionGWAS</span></a>
<a class="sourceLine" id="cb14-2" title="2">fais &lt;-<span class="st"> </span><span class="kw">CASMAP</span>(<span class="dt">mode=</span><span class="st">&quot;regionGWAS&quot;</span>)      <span class="co"># initialise object</span></a>
<a class="sourceLine" id="cb14-3" title="3"></a>
<a class="sourceLine" id="cb14-4" title="4"><span class="co"># read the data and labels, but no covariates</span></a>
<a class="sourceLine" id="cb14-5" title="5">fais<span class="op">$</span><span class="kw">readFiles</span>(<span class="dt">genotype_file=</span><span class="kw">getExampleDataFilename</span>(),</a>
<a class="sourceLine" id="cb14-6" title="6">                  <span class="dt">phenotype_file=</span><span class="kw">getExampleLabelsFilename</span>())</a>
<a class="sourceLine" id="cb14-7" title="7"></a>
<a class="sourceLine" id="cb14-8" title="8"><span class="kw">print</span>(fais)</a></code></pre></div>
<pre><code>## CASMAP object with: 
##  * Mode = regionGWAS 
##  * Target FWER = 0.05 
##  * Maximum combination size = 0 
##  * Input files read 
##  * Covariate = FALSE</code></pre>
</div>
<div id="setting-the-encoding-method" class="section level2">
<h2>Setting the encoding method</h2>
<p>The binary data could be encoded with either a dominant or recessive encoding. The default for <code>readLines</code> is <code>dominant</code>, but it is also possible to specify the coding explicitly:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">library</span>(CASMAP)</a>
<a class="sourceLine" id="cb16-2" title="2">fastcmh &lt;-<span class="st"> </span><span class="kw">CASMAP</span>(<span class="dt">mode=</span><span class="st">&quot;regionGWAS&quot;</span>)</a>
<a class="sourceLine" id="cb16-3" title="3"></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">#  using the dominant encoding (default)</span></a>
<a class="sourceLine" id="cb16-5" title="5">fastcmh<span class="op">$</span><span class="kw">readFiles</span>(<span class="dt">genotype_file=</span><span class="kw">getExampleDataFilename</span>(),</a>
<a class="sourceLine" id="cb16-6" title="6">                   <span class="dt">phenotype_file=</span><span class="kw">getExampleLabelsFilename</span>(), </a>
<a class="sourceLine" id="cb16-7" title="7">                   <span class="dt">covariate_file=</span><span class="kw">getExampleCovariatesFilename</span>(),</a>
<a class="sourceLine" id="cb16-8" title="8">                   <span class="dt">encoding=</span><span class="st">&quot;dominant&quot;</span>)</a>
<a class="sourceLine" id="cb16-9" title="9"></a>
<a class="sourceLine" id="cb16-10" title="10"><span class="co">#  using the dominant encoding (default)</span></a>
<a class="sourceLine" id="cb16-11" title="11">fastcmh<span class="op">$</span><span class="kw">readFiles</span>(<span class="dt">genotype_file=</span><span class="kw">getExampleDataFilename</span>(),</a>
<a class="sourceLine" id="cb16-12" title="12">                   <span class="dt">phenotype_file=</span><span class="kw">getExampleLabelsFilename</span>(), </a>
<a class="sourceLine" id="cb16-13" title="13">                   <span class="dt">covariate_file=</span><span class="kw">getExampleCovariatesFilename</span>(),</a>
<a class="sourceLine" id="cb16-14" title="14">                   <span class="dt">encoding=</span><span class="st">&quot;recessive&quot;</span>)</a></code></pre></div>
</div>
<div id="future-releases" class="section level2">
<h2>Future releases</h2>
<p>Note that future versions of the package will include the option to read PLINK files, and the option to set the maximum combination length.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
