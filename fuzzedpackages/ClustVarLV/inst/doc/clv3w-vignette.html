<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>

<title>Clustering around latent variables in the scope of Three-Way data</title>

<script type="text/javascript">
window.onload = function() {
  var imgs = document.getElementsByTagName('img'), i, img;
  for (i = 0; i < imgs.length; i++) {
    img = imgs[i];
    // center an image if it is the only element of its parent
    if (img.parentElement.childElementCount === 1)
      img.parentElement.style.textAlign = 'center';
  }
};
</script>

<!-- Styles for R syntax highlighter -->
<style type="text/css">
   pre .operator,
   pre .paren {
     color: rgb(104, 118, 135)
   }

   pre .literal {
     color: #990073
   }

   pre .number {
     color: #099;
   }

   pre .comment {
     color: #998;
     font-style: italic
   }

   pre .keyword {
     color: #900;
     font-weight: bold
   }

   pre .identifier {
     color: rgb(0, 0, 0);
   }

   pre .string {
     color: #d14;
   }
</style>

<!-- R syntax highlighter -->
<script type="text/javascript">
var hljs=new function(){function m(p){return p.replace(/&/gm,"&amp;").replace(/</gm,"&lt;")}function f(r,q,p){return RegExp(q,"m"+(r.cI?"i":"")+(p?"g":""))}function b(r){for(var p=0;p<r.childNodes.length;p++){var q=r.childNodes[p];if(q.nodeName=="CODE"){return q}if(!(q.nodeType==3&&q.nodeValue.match(/\s+/))){break}}}function h(t,s){var p="";for(var r=0;r<t.childNodes.length;r++){if(t.childNodes[r].nodeType==3){var q=t.childNodes[r].nodeValue;if(s){q=q.replace(/\n/g,"")}p+=q}else{if(t.childNodes[r].nodeName=="BR"){p+="\n"}else{p+=h(t.childNodes[r])}}}if(/MSIE [678]/.test(navigator.userAgent)){p=p.replace(/\r/g,"\n")}return p}function a(s){var r=s.className.split(/\s+/);r=r.concat(s.parentNode.className.split(/\s+/));for(var q=0;q<r.length;q++){var p=r[q].replace(/^language-/,"");if(e[p]){return p}}}function c(q){var p=[];(function(s,t){for(var r=0;r<s.childNodes.length;r++){if(s.childNodes[r].nodeType==3){t+=s.childNodes[r].nodeValue.length}else{if(s.childNodes[r].nodeName=="BR"){t+=1}else{if(s.childNodes[r].nodeType==1){p.push({event:"start",offset:t,node:s.childNodes[r]});t=arguments.callee(s.childNodes[r],t);p.push({event:"stop",offset:t,node:s.childNodes[r]})}}}}return t})(q,0);return p}function k(y,w,x){var q=0;var z="";var s=[];function u(){if(y.length&&w.length){if(y[0].offset!=w[0].offset){return(y[0].offset<w[0].offset)?y:w}else{return w[0].event=="start"?y:w}}else{return y.length?y:w}}function t(D){var A="<"+D.nodeName.toLowerCase();for(var B=0;B<D.attributes.length;B++){var C=D.attributes[B];A+=" "+C.nodeName.toLowerCase();if(C.value!==undefined&&C.value!==false&&C.value!==null){A+='="'+m(C.value)+'"'}}return A+">"}while(y.length||w.length){var v=u().splice(0,1)[0];z+=m(x.substr(q,v.offset-q));q=v.offset;if(v.event=="start"){z+=t(v.node);s.push(v.node)}else{if(v.event=="stop"){var p,r=s.length;do{r--;p=s[r];z+=("</"+p.nodeName.toLowerCase()+">")}while(p!=v.node);s.splice(r,1);while(r<s.length){z+=t(s[r]);r++}}}}return z+m(x.substr(q))}function j(){function q(x,y,v){if(x.compiled){return}var u;var s=[];if(x.k){x.lR=f(y,x.l||hljs.IR,true);for(var w in x.k){if(!x.k.hasOwnProperty(w)){continue}if(x.k[w] instanceof Object){u=x.k[w]}else{u=x.k;w="keyword"}for(var r in u){if(!u.hasOwnProperty(r)){continue}x.k[r]=[w,u[r]];s.push(r)}}}if(!v){if(x.bWK){x.b="\\b("+s.join("|")+")\\s"}x.bR=f(y,x.b?x.b:"\\B|\\b");if(!x.e&&!x.eW){x.e="\\B|\\b"}if(x.e){x.eR=f(y,x.e)}}if(x.i){x.iR=f(y,x.i)}if(x.r===undefined){x.r=1}if(!x.c){x.c=[]}x.compiled=true;for(var t=0;t<x.c.length;t++){if(x.c[t]=="self"){x.c[t]=x}q(x.c[t],y,false)}if(x.starts){q(x.starts,y,false)}}for(var p in e){if(!e.hasOwnProperty(p)){continue}q(e[p].dM,e[p],true)}}function d(B,C){if(!j.called){j();j.called=true}function q(r,M){for(var L=0;L<M.c.length;L++){if((M.c[L].bR.exec(r)||[null])[0]==r){return M.c[L]}}}function v(L,r){if(D[L].e&&D[L].eR.test(r)){return 1}if(D[L].eW){var M=v(L-1,r);return M?M+1:0}return 0}function w(r,L){return L.i&&L.iR.test(r)}function K(N,O){var M=[];for(var L=0;L<N.c.length;L++){M.push(N.c[L].b)}var r=D.length-1;do{if(D[r].e){M.push(D[r].e)}r--}while(D[r+1].eW);if(N.i){M.push(N.i)}return f(O,M.join("|"),true)}function p(M,L){var N=D[D.length-1];if(!N.t){N.t=K(N,E)}N.t.lastIndex=L;var r=N.t.exec(M);return r?[M.substr(L,r.index-L),r[0],false]:[M.substr(L),"",true]}function z(N,r){var L=E.cI?r[0].toLowerCase():r[0];var M=N.k[L];if(M&&M instanceof Array){return M}return false}function F(L,P){L=m(L);if(!P.k){return L}var r="";var O=0;P.lR.lastIndex=0;var M=P.lR.exec(L);while(M){r+=L.substr(O,M.index-O);var N=z(P,M);if(N){x+=N[1];r+='<span class="'+N[0]+'">'+M[0]+"</span>"}else{r+=M[0]}O=P.lR.lastIndex;M=P.lR.exec(L)}return r+L.substr(O,L.length-O)}function J(L,M){if(M.sL&&e[M.sL]){var r=d(M.sL,L);x+=r.keyword_count;return r.value}else{return F(L,M)}}function I(M,r){var L=M.cN?'<span class="'+M.cN+'">':"";if(M.rB){y+=L;M.buffer=""}else{if(M.eB){y+=m(r)+L;M.buffer=""}else{y+=L;M.buffer=r}}D.push(M);A+=M.r}function G(N,M,Q){var R=D[D.length-1];if(Q){y+=J(R.buffer+N,R);return false}var P=q(M,R);if(P){y+=J(R.buffer+N,R);I(P,M);return P.rB}var L=v(D.length-1,M);if(L){var O=R.cN?"</span>":"";if(R.rE){y+=J(R.buffer+N,R)+O}else{if(R.eE){y+=J(R.buffer+N,R)+O+m(M)}else{y+=J(R.buffer+N+M,R)+O}}while(L>1){O=D[D.length-2].cN?"</span>":"";y+=O;L--;D.length--}var r=D[D.length-1];D.length--;D[D.length-1].buffer="";if(r.starts){I(r.starts,"")}return R.rE}if(w(M,R)){throw"Illegal"}}var E=e[B];var D=[E.dM];var A=0;var x=0;var y="";try{var s,u=0;E.dM.buffer="";do{s=p(C,u);var t=G(s[0],s[1],s[2]);u+=s[0].length;if(!t){u+=s[1].length}}while(!s[2]);if(D.length>1){throw"Illegal"}return{r:A,keyword_count:x,value:y}}catch(H){if(H=="Illegal"){return{r:0,keyword_count:0,value:m(C)}}else{throw H}}}function g(t){var p={keyword_count:0,r:0,value:m(t)};var r=p;for(var q in e){if(!e.hasOwnProperty(q)){continue}var s=d(q,t);s.language=q;if(s.keyword_count+s.r>r.keyword_count+r.r){r=s}if(s.keyword_count+s.r>p.keyword_count+p.r){r=p;p=s}}if(r.language){p.second_best=r}return p}function i(r,q,p){if(q){r=r.replace(/^((<[^>]+>|\t)+)/gm,function(t,w,v,u){return w.replace(/\t/g,q)})}if(p){r=r.replace(/\n/g,"<br>")}return r}function n(t,w,r){var x=h(t,r);var v=a(t);var y,s;if(v){y=d(v,x)}else{return}var q=c(t);if(q.length){s=document.createElement("pre");s.innerHTML=y.value;y.value=k(q,c(s),x)}y.value=i(y.value,w,r);var u=t.className;if(!u.match("(\\s|^)(language-)?"+v+"(\\s|$)")){u=u?(u+" "+v):v}if(/MSIE [678]/.test(navigator.userAgent)&&t.tagName=="CODE"&&t.parentNode.tagName=="PRE"){s=t.parentNode;var p=document.createElement("div");p.innerHTML="<pre><code>"+y.value+"</code></pre>";t=p.firstChild.firstChild;p.firstChild.cN=s.cN;s.parentNode.replaceChild(p.firstChild,s)}else{t.innerHTML=y.value}t.className=u;t.result={language:v,kw:y.keyword_count,re:y.r};if(y.second_best){t.second_best={language:y.second_best.language,kw:y.second_best.keyword_count,re:y.second_best.r}}}function o(){if(o.called){return}o.called=true;var r=document.getElementsByTagName("pre");for(var p=0;p<r.length;p++){var q=b(r[p]);if(q){n(q,hljs.tabReplace)}}}function l(){if(window.addEventListener){window.addEventListener("DOMContentLoaded",o,false);window.addEventListener("load",o,false)}else{if(window.attachEvent){window.attachEvent("onload",o)}else{window.onload=o}}}var e={};this.LANGUAGES=e;this.highlight=d;this.highlightAuto=g;this.fixMarkup=i;this.highlightBlock=n;this.initHighlighting=o;this.initHighlightingOnLoad=l;this.IR="[a-zA-Z][a-zA-Z0-9_]*";this.UIR="[a-zA-Z_][a-zA-Z0-9_]*";this.NR="\\b\\d+(\\.\\d+)?";this.CNR="\\b(0[xX][a-fA-F0-9]+|(\\d+(\\.\\d*)?|\\.\\d+)([eE][-+]?\\d+)?)";this.BNR="\\b(0b[01]+)";this.RSR="!|!=|!==|%|%=|&|&&|&=|\\*|\\*=|\\+|\\+=|,|\\.|-|-=|/|/=|:|;|<|<<|<<=|<=|=|==|===|>|>=|>>|>>=|>>>|>>>=|\\?|\\[|\\{|\\(|\\^|\\^=|\\||\\|=|\\|\\||~";this.ER="(?![\\s\\S])";this.BE={b:"\\\\.",r:0};this.ASM={cN:"string",b:"'",e:"'",i:"\\n",c:[this.BE],r:0};this.QSM={cN:"string",b:'"',e:'"',i:"\\n",c:[this.BE],r:0};this.CLCM={cN:"comment",b:"//",e:"$"};this.CBLCLM={cN:"comment",b:"/\\*",e:"\\*/"};this.HCM={cN:"comment",b:"#",e:"$"};this.NM={cN:"number",b:this.NR,r:0};this.CNM={cN:"number",b:this.CNR,r:0};this.BNM={cN:"number",b:this.BNR,r:0};this.inherit=function(r,s){var p={};for(var q in r){p[q]=r[q]}if(s){for(var q in s){p[q]=s[q]}}return p}}();hljs.LANGUAGES.cpp=function(){var a={keyword:{"false":1,"int":1,"float":1,"while":1,"private":1,"char":1,"catch":1,"export":1,virtual:1,operator:2,sizeof:2,dynamic_cast:2,typedef:2,const_cast:2,"const":1,struct:1,"for":1,static_cast:2,union:1,namespace:1,unsigned:1,"long":1,"throw":1,"volatile":2,"static":1,"protected":1,bool:1,template:1,mutable:1,"if":1,"public":1,friend:2,"do":1,"return":1,"goto":1,auto:1,"void":2,"enum":1,"else":1,"break":1,"new":1,extern:1,using:1,"true":1,"class":1,asm:1,"case":1,typeid:1,"short":1,reinterpret_cast:2,"default":1,"double":1,register:1,explicit:1,signed:1,typename:1,"try":1,"this":1,"switch":1,"continue":1,wchar_t:1,inline:1,"delete":1,alignof:1,char16_t:1,char32_t:1,constexpr:1,decltype:1,noexcept:1,nullptr:1,static_assert:1,thread_local:1,restrict:1,_Bool:1,complex:1},built_in:{std:1,string:1,cin:1,cout:1,cerr:1,clog:1,stringstream:1,istringstream:1,ostringstream:1,auto_ptr:1,deque:1,list:1,queue:1,stack:1,vector:1,map:1,set:1,bitset:1,multiset:1,multimap:1,unordered_set:1,unordered_map:1,unordered_multiset:1,unordered_multimap:1,array:1,shared_ptr:1}};return{dM:{k:a,i:"</",c:[hljs.CLCM,hljs.CBLCLM,hljs.QSM,{cN:"string",b:"'\\\\?.",e:"'",i:"."},{cN:"number",b:"\\b(\\d+(\\.\\d*)?|\\.\\d+)(u|U|l|L|ul|UL|f|F)"},hljs.CNM,{cN:"preprocessor",b:"#",e:"$"},{cN:"stl_container",b:"\\b(deque|list|queue|stack|vector|map|set|bitset|multiset|multimap|unordered_map|unordered_set|unordered_multiset|unordered_multimap|array)\\s*<",e:">",k:a,r:10,c:["self"]}]}}}();hljs.LANGUAGES.r={dM:{c:[hljs.HCM,{cN:"number",b:"\\b0[xX][0-9a-fA-F]+[Li]?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+(?:[eE][+\\-]?\\d*)?L\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\b\\d+\\.(?!\\d)(?:i\\b)?",e:hljs.IMMEDIATE_RE,r:1},{cN:"number",b:"\\b\\d+(?:\\.\\d*)?(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"number",b:"\\.\\d+(?:[eE][+\\-]?\\d*)?i?\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"keyword",b:"(?:tryCatch|library|setGeneric|setGroupGeneric)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\.",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\.\\.\\d+(?![\\w.])",e:hljs.IMMEDIATE_RE,r:10},{cN:"keyword",b:"\\b(?:function)",e:hljs.IMMEDIATE_RE,r:2},{cN:"keyword",b:"(?:if|in|break|next|repeat|else|for|return|switch|while|try|stop|warning|require|attach|detach|source|setMethod|setClass)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"literal",b:"(?:NA|NA_integer_|NA_real_|NA_character_|NA_complex_)\\b",e:hljs.IMMEDIATE_RE,r:10},{cN:"literal",b:"(?:NULL|TRUE|FALSE|T|F|Inf|NaN)\\b",e:hljs.IMMEDIATE_RE,r:1},{cN:"identifier",b:"[a-zA-Z.][a-zA-Z0-9._]*\\b",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"<\\-(?!\\s*\\d)",e:hljs.IMMEDIATE_RE,r:2},{cN:"operator",b:"\\->|<\\-",e:hljs.IMMEDIATE_RE,r:1},{cN:"operator",b:"%%|~",e:hljs.IMMEDIATE_RE},{cN:"operator",b:">=|<=|==|!=|\\|\\||&&|=|\\+|\\-|\\*|/|\\^|>|<|!|&|\\||\\$|:",e:hljs.IMMEDIATE_RE,r:0},{cN:"operator",b:"%",e:"%",i:"\\n",r:1},{cN:"identifier",b:"`",e:"`",r:0},{cN:"string",b:'"',e:'"',c:[hljs.BE],r:0},{cN:"string",b:"'",e:"'",c:[hljs.BE],r:0},{cN:"paren",b:"[[({\\])}]",e:hljs.IMMEDIATE_RE,r:0}]}};
hljs.initHighlightingOnLoad();
</script>



<style type="text/css">
body, td {
   font-family: sans-serif;
   background-color: white;
   font-size: 13px;
}

body {
  max-width: 800px;
  margin: auto;
  padding: 1em;
  line-height: 20px;
}

tt, code, pre {
   font-family: 'DejaVu Sans Mono', 'Droid Sans Mono', 'Lucida Console', Consolas, Monaco, monospace;
}

h1 {
   font-size:2.2em;
}

h2 {
   font-size:1.8em;
}

h3 {
   font-size:1.4em;
}

h4 {
   font-size:1.0em;
}

h5 {
   font-size:0.9em;
}

h6 {
   font-size:0.8em;
}

a:visited {
   color: rgb(50%, 0%, 50%);
}

pre, img {
  max-width: 100%;
}
pre {
  overflow-x: auto;
}
pre code {
   display: block; padding: 0.5em;
}

code {
  font-size: 92%;
  border: 1px solid #ccc;
}

code[class] {
  background-color: #F8F8F8;
}

table, td, th {
  border: none;
}

blockquote {
   color:#666666;
   margin:0;
   padding-left: 1em;
   border-left: 0.5em #EEE solid;
}

hr {
   height: 0px;
   border-bottom: none;
   border-top-width: thin;
   border-top-style: dotted;
   border-top-color: #999999;
}

@media print {
   * {
      background: transparent !important;
      color: black !important;
      filter:none !important;
      -ms-filter: none !important;
   }

   body {
      font-size:12pt;
      max-width:100%;
   }

   a, a:visited {
      text-decoration: underline;
   }

   hr {
      visibility: hidden;
      page-break-before: always;
   }

   pre, blockquote {
      padding-right: 1em;
      page-break-inside: avoid;
   }

   tr, img {
      page-break-inside: avoid;
   }

   img {
      max-width: 100% !important;
   }

   @page :left {
      margin: 15mm 20mm 15mm 10mm;
   }

   @page :right {
      margin: 15mm 10mm 15mm 20mm;
   }

   p, h2, h3 {
      orphans: 3; widows: 3;
   }

   h2, h3 {
      page-break-after: avoid;
   }
}
</style>



</head>

<body>
<h1>Clustering around latent variables in the scope of Three-Way data</h1>

<p>The functions associated with CLV3W are dedicated to the clustering around latent variables in the context of Three-Way data. Such data are structured as three-way arrays and the purpose is to cluster the second mode corresponding to the various variables (see Wilderjans and Cariou, 2016; Cariou and Wilderjans, 2018).</p>

<pre><code class="r">library(ClustVarLV)
#library(clv3w)
</code></pre>

<p>For illustration, we consider the &ldquo;coffee&rdquo; dataset which corresponds to consumer emotions associated with a variety of coffee aromas (Cariou and Wilderjans, 2018). </p>

<pre><code class="r">data(coffee)
# 12 coffee aromas rated by 84 consumers on 15 emotion terms
</code></pre>

<h2>Clustering of the consumers</h2>

<p>The aim is to find groups of consumers. Herein &ldquo;directional&rdquo; groups are sought.
Each group is associated with a latent component which makes it possible to identify the underlying sensory dimensions.</p>

<pre><code class="r">resclv3w_coffee&lt;-CLV3W(coffee,mode.scale=2,NN=TRUE,moddendoinertie=TRUE,graph=TRUE,gmax=11,cp.rand=1)
# option NN=TRUE means that consumers within a group must be positively correlated with its latent component, otherwise its loading is set to 0 

# Print of the &#39;clv3W&#39; object 
print(resclv3w_coffee)
</code></pre>

<pre><code class="r"># Dendrogram of the CLV3W hierarchical clustering algorithm :
plot(resclv3w_coffee,&quot;dendrogram&quot;)
</code></pre>

<p><img src="data:image/png;base64,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" alt="plot of chunk unnamed-chunk-4"/></p>

<pre><code class="r"># Graph of the variation of the associated clustering criterion
plot(resclv3w_coffee,&quot;delta&quot;)
</code></pre>

<p>The graph of the variation of the clustering criterion between a partition into K clusters and a partition into (K-1) clusters (after consolidation) is useful for determining the number of clusters to be retained.
Because the criterion clearly jumps when passing from 3 to 2 groups,  a partition into 2 groups is retained.</p>

<pre><code class="r"># Summary the CLV3W results for a partition into 2 groups
summary(resclv3w_coffee,K=2)
#&gt; $size
#&gt; clusters
#&gt;  1  2 
#&gt; 45 39 
#&gt; 
#&gt; $prop_explained_per_cluster
#&gt; [1] 20.860 24.945
#&gt; 
#&gt; $prop_explained_total
#&gt; [1] 22.756
#&gt; 
#&gt; $comp
#&gt;                 Comp1  Comp2
#&gt; Vanilla        -0.320 -0.091
#&gt; B.Rice         -0.062  0.223
#&gt; Lemon           0.527 -0.428
#&gt; Coffee.Flower   0.440 -0.251
#&gt; Cedar          -0.082  0.391
#&gt; Hazelnut       -0.113 -0.248
#&gt; Coriander.Seed  0.157 -0.006
#&gt; Honey          -0.354 -0.129
#&gt; Medicine       -0.252  0.425
#&gt; Apricot         0.361 -0.284
#&gt; Earth          -0.232  0.448
#&gt; Hay            -0.069 -0.050
#&gt; 
#&gt; $weight
#&gt;               Comp1  Comp2
#&gt; Calm          0.208 -0.185
#&gt; Nostalgic     0.190 -0.221
#&gt; Angry        -0.217  0.222
#&gt; Disgusted    -0.375  0.372
#&gt; Unique        0.096 -0.122
#&gt; Excited       0.142 -0.207
#&gt; Unpleasant   -0.335  0.331
#&gt; Disappointed -0.239  0.269
#&gt; Free          0.227 -0.192
#&gt; Surprised     0.002  0.015
#&gt; Irritated    -0.335  0.307
#&gt; Energetic     0.221 -0.263
#&gt; Happy         0.318 -0.320
#&gt; Well          0.377 -0.338
#&gt; Amused        0.280 -0.269
#&gt; 
#&gt; $groups
#&gt; $groups$`Cluster 1`
#&gt;    loading cor in.group cor next.group
#&gt; 1    0.217        0.841          0.471
#&gt; 2    0.078        0.619          0.318
#&gt; 3    0.145        0.586          0.126
#&gt; 4    0.032        0.210          0.184
#&gt; 6    0.127        0.607          0.416
#&gt; 8    0.078        0.361          0.166
#&gt; 9    0.069        0.523         -0.076
#&gt; 12   0.126        0.654          0.204
#&gt; 14   0.152        0.698          0.323
#&gt; 15   0.082        0.340          0.167
#&gt; 16   0.137        0.631          0.617
#&gt; 18   0.234        0.820          0.477
#&gt; 19   0.088        0.370         -0.060
#&gt; 20   0.122        0.522          0.404
#&gt; 22   0.142        0.643          0.366
#&gt; 24   0.209        0.815          0.704
#&gt; 25   0.167        0.733          0.163
#&gt; 26   0.222        0.795          0.269
#&gt; 30   0.211        0.909          0.484
#&gt; 33   0.193        0.790          0.675
#&gt; 34   0.159        0.727          0.330
#&gt; 36   0.156        0.673          0.489
#&gt; 38   0.169        0.762          0.383
#&gt; 40   0.109        0.599          0.283
#&gt; 43   0.053        0.212          0.089
#&gt; 47   0.073        0.409          0.267
#&gt; 48   0.124        0.552          0.167
#&gt; 49   0.083        0.394         -0.108
#&gt; 54   0.136        0.689          0.340
#&gt; 56   0.214        0.833          0.786
#&gt; 58   0.151        0.580          0.451
#&gt; 59   0.225        0.872          0.548
#&gt; 61   0.130        0.717          0.539
#&gt; 62   0.154        0.688          0.425
#&gt; 63   0.161        0.650          0.137
#&gt; 65   0.130        0.551          0.530
#&gt; 66   0.127        0.488          0.252
#&gt; 67   0.159        0.720          0.375
#&gt; 71   0.116        0.618          0.602
#&gt; 73   0.136        0.605          0.089
#&gt; 74   0.110        0.661          0.489
#&gt; 79   0.226        0.855          0.657
#&gt; 80   0.149        0.665          0.552
#&gt; 82   0.178        0.747          0.632
#&gt; 84   0.000       -0.611         -0.279
#&gt; 
#&gt; $groups$`Cluster 2`
#&gt;    loading cor in.group cor next.group
#&gt; 5    0.129        0.551         -0.028
#&gt; 7    0.139        0.603          0.145
#&gt; 10   0.147        0.553          0.276
#&gt; 11   0.000       -0.070         -0.464
#&gt; 13   0.160        0.844          0.523
#&gt; 17   0.158        0.621          0.606
#&gt; 21   0.116        0.651          0.118
#&gt; 23   0.059        0.242         -0.069
#&gt; 27   0.123        0.646          0.535
#&gt; 28   0.196        0.839          0.445
#&gt; 29   0.136        0.592          0.439
#&gt; 31   0.147        0.676          0.270
#&gt; 32   0.137        0.561          0.263
#&gt; 35   0.224        0.896          0.639
#&gt; 37   0.113        0.523          0.387
#&gt; 39   0.137        0.598          0.371
#&gt; 41   0.152        0.657          0.530
#&gt; 42   0.062        0.241          0.013
#&gt; 44   0.185        0.681          0.513
#&gt; 45   0.124        0.628          0.245
#&gt; 46   0.204        0.885          0.485
#&gt; 50   0.120        0.520          0.051
#&gt; 51   0.166        0.836          0.688
#&gt; 52   0.251        0.938          0.429
#&gt; 53   0.231        0.921          0.521
#&gt; 55   0.133        0.525          0.238
#&gt; 57   0.173        0.790          0.345
#&gt; 60   0.155        0.701          0.551
#&gt; 64   0.181        0.804          0.412
#&gt; 68   0.145        0.749          0.552
#&gt; 69   0.164        0.754          0.452
#&gt; 70   0.184        0.719          0.567
#&gt; 72   0.199        0.872          0.441
#&gt; 75   0.165        0.767          0.239
#&gt; 76   0.204        0.862          0.618
#&gt; 77   0.192        0.778          0.724
#&gt; 78   0.112        0.546          0.501
#&gt; 81   0.208        0.806          0.304
#&gt; 83   0.133        0.671          0.485
#&gt; 
#&gt; 
#&gt; $cormatrix
#&gt;        Comp.1 Comp.2
#&gt; Comp.1  1.000 -0.591
#&gt; Comp.2 -0.591  1.000
</code></pre>

<p>The function plot_var.clv3w() allows us to describe the groups of variables into a two dimensional space obtained by Candecomp Parafac. 
Several options are available for the choice of the axes, for adding labels, producing a plot without colours but symbols, having only one plot or a plot by groups of variables. When mode3 is set to TRUE, an additional plot is displayed corresponding to the coordinates of the mode1 elements on the global scores of Parafac together with a projection of the mode 3 elements on it.</p>

<pre><code class="r"># Representation of the group membership for a partition into 4 groups
plot_var.clv3w(resclv3w_coffee,K=2,labels=TRUE,cex.lab=0.8,beside=TRUE,mode3=FALSE)
</code></pre>

<p>or</p>

<pre><code class="r">plot_var.clv3w(resclv3w_coffee,K=2,labels=TRUE,cex.lab=0.8,beside=FALSE,mode3=TRUE)
</code></pre>

<p>Additional functions :</p>

<pre><code class="r"># Extract the group membership of each variable
get_partition(resclv3w_coffee,2)

# Extract the group latent variables 
get_comp(resclv3w_coffee,2)

# Extract the vector of loadings of the variables 
get_loading(resclv3w_coffee,2)

# Extract the vector of weights associated with mode3
get_weight(resclv3w_coffee,2)
</code></pre>

<h2>Using the CLV3W_kmeans function</h2>

<p>This procedure is less time consuming with a large number of variables (mode2).
The number of clusters needs to be fixed (e.g.2). </p>

<p>The initialization of the algorithm  can be made at random, &ldquo;init&rdquo; times, while
the number of starts associated with Candecomp Parafac is set up with cp.rand :</p>

<pre><code class="r">res.clv3wkm.rd&lt;-CLV3W_kmeans(coffee,2,mode.scale=2,NN=TRUE,init=20,cp.rand=2)
</code></pre>

<p>It is possible to compare the partitions according to the procedure used :</p>

<pre><code class="r">table(get_partition(resclv3w_coffee,K=2),get_partition(res.clv3wkm.rd,K=2)) 
#&gt;    
#&gt;      1  2
#&gt;   1  5 40
#&gt;   2 38  1
</code></pre>

<h2>References</h2>

<p>Cariou, V., &amp; Wilderjans, T. F. (2018). Consumer segmentation in multi-attribute product evaluation by means of non-negatively constrained CLV3W. <em>Food Quality and Preference</em>, 67, 18-26.</p>

<p>Wilderjans, T. F., &amp; Cariou, V. (2016). CLV3W: A clustering around latent variables approach to detect panel disagreement in three-way conventional sensory profiling data. <em>Food Quality and Preference</em>, 47, 45-53.</p>

</body>

</html>
