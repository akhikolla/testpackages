<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Using VCF files</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Using VCF files</h1>


<div id="TOC">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#example-files">Example files</a></li>
<li><a href="#converting-a-vcf-file-to-the-binary-dosage-format">Converting a VCF file to the Binary Dosage format</a><ul>
<li><a href="#minimac-files">Minimac files</a><ul>
<li><a href="#uncompressed-vcf-files">Uncompressed VCF files</a></li>
<li><a href="#compressed-vcf-files">Compressed VCF files</a></li>
<li><a href="#checking-the-files">Checking the files</a></li>
</ul></li>
<li><a href="#other-vcf-file-formats">Other VCF file formats</a></li>
<li><a href="#other-vcftobd-options">Other vcftobd options</a><ul>
<li><a href="#format-and-subformat-options">format and subformat options</a></li>
<li><a href="#snpidformat">snpidformat</a></li>
<li><a href="#bdoptions">bdoptions</a></li>
</ul></li>
</ul></li>
<li><a href="#additional-routines">Additional routines</a><ul>
<li><a href="#getvcfinfo">getvcfinfo</a></li>
<li><a href="#vcfapply">vcfapply</a></li>
</ul></li>
</ul>
</div>

<p>This vignette documents the functions in the BinaryDosage package that convert VCF files to binary dosage files.</p>
<p><strong>Note:</strong> The examples below use functions to access information in binary dosage files. Information about these functions can be found in the vignette <a href="usingbdfiles.html">Using Binary Dosage Files</a>. Data returned by the function <span style="font-family:Courier">getbdinfo</span> contains information about a binary dosage file. Information on the data return by <span style="font-family:Courier">getbdinfo</span> can be found in the vignette <a href="geneticfileinfo.html">Genetic File Information</a>.</p>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>VCF files are a useful way to store genetic data. They have a well defined format and can be easily parsed. The output files returned from the imputation software <a href="https://genome.sph.umich.edu/wiki/Minimac">minimac</a> are returned in this format. The minimac software also returns an information file that is supported by the BinaryDosage package. The <a href="https://imputationserver.sph.umich.edu/index.html">Michigan Imputation Server</a> using minimac for imputation and returns VCF and information. Functions in the BinaryDosage package have default settings to use the files return from minimac.</p>
<p>Uncompressed VCF files are text files and can be very large, 100s of GB. Because of this they are quite often compressed. Files returned from the Michigan Imputation Server are compressed using gzip. This makes the files much smaller but greatly increases the read time. The BinaryDosage package supports reading of gzip compressed VCF files.</p>
<p>The BinaryDosage package was originally designed for use with files return from the Michigan Imputation Server. It was quickly learned that if any manipulation was done to these files by various tools such as <a href="https://vcftools.github.io">vcftools</a>, The conversion routine in the BinaryDosage package would not work. The routine was modified to support additional VCF file formats.</p>
<p>The BinaryDosage package has a routine to convert VCF files into a binary format that maintains the dosage, genetic probabilities, and imputation statistics. This results in a file about 10-15% the size of the uncompressed VCF file with much faster, 200-300x, read times. In comparison, Using gzip to compress the VCF file reduces the size of the file to about 5% its original size but makes run times slower.</p>
<p>Routines were written to help debug the conversion routine. It was discovered these routines were quite useful for accessing data in the VCF file and are now included in the package. This document contains instructions on how to use these routines.</p>
</div>
<div id="example-files" class="section level1">
<h1>Example files</h1>
<p>There are several sample files included with the BinaryDosage package. The file names will be found by using the <span style="font-family:Courier">system.file</span> command in the examples. This will be used many times in the examples.</p>
<p>The binary dosage files created will be temporary files. They will be created using the <span style="font-family:Courier">tempfile</span> command. This will also be used many times in the examples. All output files will use the default format of 4. For information on other formats see the vignette <a href="bdformats.html">Binary Dosage Formats</a>.</p>
</div>
<div id="converting-a-vcf-file-to-the-binary-dosage-format" class="section level1">
<h1>Converting a VCF file to the Binary Dosage format</h1>
<p>The <span style="font-family:Courier">vcftobd</span> routine converts VCF files to the binary dosage format. Many different formats of VCF files by the BinaryDosage package. The following sections show how to convert VCF files in various formats to the binary dosage format.</p>
<div id="minimac-files" class="section level2">
<h2>Minimac files</h2>
<p>Since the binary dosage format was initially created for use with files produced by minimac, the default options for calling the routine to convert a VCF file to a binary dosage format are for this type of file.</p>
<div id="uncompressed-vcf-files" class="section level3">
<h3>Uncompressed VCF files</h3>
<p>Uncompressed VCF files are the easiest to convert to the binary dosage format since the default values for <span style="font-family:Courier">vcftobd</span> are set for this format.</p>
<div id="no-imputation-information-file" class="section level4">
<h4>No imputation information file</h4>
<p>An imputation information file is not required to convert a VCF file into the binary dosage format. In this case, the parameter value for <span style="font-family:Courier">vcffiles</span> is set to the VCF file name.</p>
<p>The following commands convert the VCF file <em>set1a.vcf</em> into the binary dosage format.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">vcf1afile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;set1a.vcf&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;BinaryDosage&quot;</span>)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">bdfile1a_woinfo &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="kw">vcftobd</span>(<span class="dt">vcffiles =</span> vcf1afile, <span class="dt">bdfiles =</span> bdfile1a_woinfo)</a></code></pre></div>
</div>
<div id="using-the-imputation-information-file" class="section level4">
<h4>Using the imputation information file</h4>
<p>The minimac program returns an imputation information file that can be passed to the <span style="font-family:Courier">vcftobd</span> routine. This is done by setting the parameter <span style="font-family:Courier">vcffiles</span> to a vector of characters containing the VCF and the imputation information file names.</p>
<p>The following commands convert the VCF file <em>set1a.vcf</em> into the binary dosage format using the information file <em>set1a.info</em>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">vcf1afile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;set1a.vcf&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;BinaryDosage&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">vcf1ainfo &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;set1a.info&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;BinaryDosage&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">bdfile1a_winfo &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="kw">vcftobd</span>(<span class="dt">vcffiles =</span> <span class="kw">c</span>(vcf1afile, vcf1ainfo), <span class="dt">bdfiles =</span> bdfile1a_winfo)</a></code></pre></div>
<p>The differences between the two binary dosage datasets can be checked by running the <span style="font-family:Courier">getbdinfo</span> routine on both files. The value of <span style="font-family:Courier">snpinfo</span> in the list returned from <span style="font-family:Courier">getbdinfo</span> will be an empty for the first file and will contain the imputation information for the second file..</p>
<p>The following commands show the first file does not contain any imputation information and the the second one does. The imputation information for the second file is converted to a table for easier displaying.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">bdinfo1a_woinfo &lt;-<span class="st"> </span><span class="kw">getbdinfo</span>(<span class="dt">bdfiles =</span> bdfile1a_woinfo)</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">bdinfo1a_woinfo<span class="op">$</span>snpinfo</a>
<a class="sourceLine" id="cb3-3" data-line-number="3"><span class="co">#&gt; named list()</span></a>
<a class="sourceLine" id="cb3-4" data-line-number="4"></a>
<a class="sourceLine" id="cb3-5" data-line-number="5">bdinfo1a_winfo &lt;-<span class="st"> </span><span class="kw">getbdinfo</span>(<span class="dt">bdfiles =</span> bdfile1a_winfo)</a>
<a class="sourceLine" id="cb3-6" data-line-number="6">knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">data.frame</span>(bdinfo1a_winfo<span class="op">$</span>snpinfo), <span class="dt">caption =</span> <span class="st">&quot;bdinfo1a_winfo$snpinfo&quot;</span>)</a></code></pre></div>
<table>
<caption>bdinfo1a_winfo$snpinfo</caption>
<thead>
<tr class="header">
<th align="right">aaf</th>
<th align="right">maf</th>
<th align="right">avgcall</th>
<th align="right">rsq</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.347</td>
<td align="right">0.347</td>
<td align="right">0.701</td>
<td align="right">0.956</td>
</tr>
<tr class="even">
<td align="right">0.016</td>
<td align="right">0.016</td>
<td align="right">0.879</td>
<td align="right">0.434</td>
</tr>
<tr class="odd">
<td align="right">0.265</td>
<td align="right">0.265</td>
<td align="right">0.714</td>
<td align="right">0.933</td>
</tr>
<tr class="even">
<td align="right">0.297</td>
<td align="right">0.297</td>
<td align="right">0.723</td>
<td align="right">0.952</td>
</tr>
<tr class="odd">
<td align="right">0.204</td>
<td align="right">0.204</td>
<td align="right">0.871</td>
<td align="right">0.970</td>
</tr>
<tr class="even">
<td align="right">0.524</td>
<td align="right">0.476</td>
<td align="right">0.751</td>
<td align="right">0.955</td>
</tr>
<tr class="odd">
<td align="right">0.425</td>
<td align="right">0.425</td>
<td align="right">0.722</td>
<td align="right">0.951</td>
</tr>
<tr class="even">
<td align="right">0.443</td>
<td align="right">0.443</td>
<td align="right">0.879</td>
<td align="right">0.948</td>
</tr>
<tr class="odd">
<td align="right">0.265</td>
<td align="right">0.265</td>
<td align="right">0.820</td>
<td align="right">0.927</td>
</tr>
<tr class="even">
<td align="right">0.245</td>
<td align="right">0.245</td>
<td align="right">0.708</td>
<td align="right">0.964</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="compressed-vcf-files" class="section level3">
<h3>Compressed VCF files</h3>
<p>VCF files can be quite large, 100s of GB. Because of this they are often compressed. The funciton <span style="font-family:Courier">vcftobd</span> supports VCF files compressed using gunzip by adding the option <span style="font-family:Courier">gz = TRUE</span> to the function call. The compressed file can be converted using an imputation information. The imputation file must <strong>NOT</strong> be compressed.</p>
<p>The following code reads in the data from the compressed VCF file <em>set1a.vcf.gz</em>. This the <em>set1a.vcf</em> file after it has been compressed using gunzip. The file will be read in twice, once without the imputation information file and once with the imputation information fie.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">vcf1afile_gz &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;set1a.vcf.gz&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;BinaryDosage&quot;</span>)</a>
<a class="sourceLine" id="cb4-2" data-line-number="2">vcf1ainfo &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;set1a.info&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;BinaryDosage&quot;</span>)</a>
<a class="sourceLine" id="cb4-3" data-line-number="3"></a>
<a class="sourceLine" id="cb4-4" data-line-number="4">bdfile1a_woinfo_gz &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb4-5" data-line-number="5"><span class="kw">vcftobd</span>(<span class="dt">vcffiles =</span> vcf1afile_gz, <span class="dt">bdfiles =</span> bdfile1a_woinfo_gz)</a>
<a class="sourceLine" id="cb4-6" data-line-number="6"></a>
<a class="sourceLine" id="cb4-7" data-line-number="7">bdfile1a_winfo_gz &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb4-8" data-line-number="8"><span class="kw">vcftobd</span>(<span class="dt">vcffiles =</span> <span class="kw">c</span>(vcf1afile_gz, vcf1ainfo), <span class="dt">bdfiles =</span> bdfile1a_winfo_gz)</a></code></pre></div>
</div>
<div id="checking-the-files" class="section level3">
<h3>Checking the files</h3>
<p>The four binary dosage files created above should all have the same dosage and genotype probabilities in them. The following code calculates the alternate allele frequencies for each of the binary dosage files using the <span style="font-family:Courier">bdapply</span> function. The results are then displayed in a table showing the alternate allele frequencies are the same for each file. The value for SNPID was taken from the list return from <span style="font-family:Courier">getbdinfo</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"></a>
<a class="sourceLine" id="cb5-2" data-line-number="2">bdinfo1a_woinfo_gz &lt;-<span class="st"> </span><span class="kw">getbdinfo</span>(<span class="dt">bdfiles =</span> bdfile1a_woinfo_gz)</a>
<a class="sourceLine" id="cb5-3" data-line-number="3">bdinfo1a_winfo_gz &lt;-<span class="st"> </span><span class="kw">getbdinfo</span>(<span class="dt">bdfiles =</span> bdfile1a_winfo_gz)</a>
<a class="sourceLine" id="cb5-4" data-line-number="4"></a>
<a class="sourceLine" id="cb5-5" data-line-number="5">aaf1a_woinfo &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">bdapply</span>(<span class="dt">bdinfo =</span> bdinfo1a_woinfo, getaaf))</a>
<a class="sourceLine" id="cb5-6" data-line-number="6">aaf1a_winfo &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">bdapply</span>(<span class="dt">bdinfo =</span> bdinfo1a_winfo, getaaf))</a>
<a class="sourceLine" id="cb5-7" data-line-number="7">aaf1a_woinfo_gz &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">bdapply</span>(<span class="dt">bdinfo =</span> bdinfo1a_woinfo_gz, getaaf))</a>
<a class="sourceLine" id="cb5-8" data-line-number="8">aaf1a_winfo_gz &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">bdapply</span>(<span class="dt">bdinfo =</span> bdinfo1a_winfo_gz, getaaf))</a>
<a class="sourceLine" id="cb5-9" data-line-number="9"></a>
<a class="sourceLine" id="cb5-10" data-line-number="10">aaf1a &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">SNPID =</span> bdinfo1a_woinfo<span class="op">$</span>snps<span class="op">$</span>snpid, <span class="dt">aaf1a_woinfo =</span> aaf1a_woinfo, </a>
<a class="sourceLine" id="cb5-11" data-line-number="11">    <span class="dt">aaf1a_winfo =</span> aaf1a_winfo, <span class="dt">aaf1a_woinfo_gz =</span> aaf1a_woinfo_gz, <span class="dt">aaf1a_winfo_gz =</span> aaf1a_winfo_gz)</a>
<a class="sourceLine" id="cb5-12" data-line-number="12"></a>
<a class="sourceLine" id="cb5-13" data-line-number="13">knitr<span class="op">::</span><span class="kw">kable</span>(aaf1a, <span class="dt">caption =</span> <span class="st">&quot;Alternate Allele Frequencies&quot;</span>, <span class="dt">digits =</span> <span class="dv">4</span>)</a></code></pre></div>
<table>
<caption>Alternate Allele Frequencies</caption>
<thead>
<tr class="header">
<th align="left">SNPID</th>
<th align="right">aaf1a_woinfo</th>
<th align="right">aaf1a_winfo</th>
<th align="right">aaf1a_woinfo_gz</th>
<th align="right">aaf1a_winfo_gz</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1:10000:C:A</td>
<td align="right">0.3468</td>
<td align="right">0.3468</td>
<td align="right">0.3468</td>
<td align="right">0.3468</td>
</tr>
<tr class="even">
<td align="left">1:11000:T:C</td>
<td align="right">0.0159</td>
<td align="right">0.0159</td>
<td align="right">0.0159</td>
<td align="right">0.0159</td>
</tr>
<tr class="odd">
<td align="left">1:12000:T:C</td>
<td align="right">0.2651</td>
<td align="right">0.2651</td>
<td align="right">0.2651</td>
<td align="right">0.2651</td>
</tr>
<tr class="even">
<td align="left">1:13000:T:C</td>
<td align="right">0.2966</td>
<td align="right">0.2966</td>
<td align="right">0.2966</td>
<td align="right">0.2966</td>
</tr>
<tr class="odd">
<td align="left">1:14000:G:C</td>
<td align="right">0.2040</td>
<td align="right">0.2040</td>
<td align="right">0.2040</td>
<td align="right">0.2040</td>
</tr>
<tr class="even">
<td align="left">1:15000:A:C</td>
<td align="right">0.5236</td>
<td align="right">0.5236</td>
<td align="right">0.5236</td>
<td align="right">0.5236</td>
</tr>
<tr class="odd">
<td align="left">1:16000:G:A</td>
<td align="right">0.4246</td>
<td align="right">0.4246</td>
<td align="right">0.4246</td>
<td align="right">0.4246</td>
</tr>
<tr class="even">
<td align="left">1:17000:C:A</td>
<td align="right">0.4434</td>
<td align="right">0.4434</td>
<td align="right">0.4434</td>
<td align="right">0.4434</td>
</tr>
<tr class="odd">
<td align="left">1:18000:C:G</td>
<td align="right">0.2655</td>
<td align="right">0.2655</td>
<td align="right">0.2655</td>
<td align="right">0.2655</td>
</tr>
<tr class="even">
<td align="left">1:19000:T:G</td>
<td align="right">0.2446</td>
<td align="right">0.2446</td>
<td align="right">0.2446</td>
<td align="right">0.2446</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="other-vcf-file-formats" class="section level2">
<h2>Other VCF file formats</h2>
<p>The <span style="font-family:Courier">vcftobd</span> function can support VCF files in formats other than those returned from minimac. This is done by examining the value of FORMAT for each SNP in the VCF file. The routine looks for the values “DS” and “GP”, dosage and genotype probabilities, in the FORMAT column. If one or both of these values are found, the appropriate information is written to the binary dosage file.</p>
<p>The file <em>set2a.vcf</em> contains only the dosage values. The following code converts it to a binary dosage file. The <span style="font-family:Courier">getsnp</span> function is then used to extract the first SNP and display the values for the first 10 subjects.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">vcf2afile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;set2a.vcf&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;BinaryDosage&quot;</span>)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">bdfile2a &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb6-3" data-line-number="3"></a>
<a class="sourceLine" id="cb6-4" data-line-number="4"><span class="kw">vcftobd</span>(<span class="dt">vcffiles =</span> vcf2afile, <span class="dt">bdfiles =</span> bdfile2a)</a>
<a class="sourceLine" id="cb6-5" data-line-number="5"></a>
<a class="sourceLine" id="cb6-6" data-line-number="6">bdinfo2a &lt;-<span class="st"> </span><span class="kw">getbdinfo</span>(<span class="dt">bdfiles =</span> bdfile2a)</a>
<a class="sourceLine" id="cb6-7" data-line-number="7">snp1_2a &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">getsnp</span>(<span class="dt">bdinfo =</span> bdinfo2a, <span class="dt">snp =</span> 1L, <span class="dt">dosageonly =</span> <span class="ot">FALSE</span>))</a>
<a class="sourceLine" id="cb6-8" data-line-number="8"></a>
<a class="sourceLine" id="cb6-9" data-line-number="9">snp1 &lt;-<span class="st"> </span><span class="kw">cbind</span>(<span class="dt">SubjectID =</span> bdinfo2a<span class="op">$</span>samples<span class="op">$</span>sid, snp1_2a)</a>
<a class="sourceLine" id="cb6-10" data-line-number="10"></a>
<a class="sourceLine" id="cb6-11" data-line-number="11">knitr<span class="op">::</span><span class="kw">kable</span>(snp1[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, ], <span class="dt">caption =</span> <span class="st">&quot;Dosage and Genotype Probabilities&quot;</span>)</a></code></pre></div>
<table>
<caption>Dosage and Genotype Probabilities</caption>
<thead>
<tr class="header">
<th align="left">SubjectID</th>
<th align="right">dosage</th>
<th align="right">p0</th>
<th align="right">p1</th>
<th align="right">p2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">I1</td>
<td align="right">2.000</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">I2</td>
<td align="right">1.002</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">I3</td>
<td align="right">1.000</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">I4</td>
<td align="right">0.122</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">I5</td>
<td align="right">1.000</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">I6</td>
<td align="right">0.000</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">I7</td>
<td align="right">1.004</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">I8</td>
<td align="right">2.000</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="odd">
<td align="left">I9</td>
<td align="right">0.000</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="left">I10</td>
<td align="right">0.918</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
</tbody>
</table>
</div>
<div id="other-vcftobd-options" class="section level2">
<h2>Other vcftobd options</h2>
<p>There are other options for <span style="font-family:Courier">vcftobd</span>. These options effect how the information is written to the binary dosage file.</p>
<div id="format-and-subformat-options" class="section level3">
<h3>format and subformat options</h3>
<p>The format and subformat options determine the format of the binary dosage files. These format are documented in the <a href="bdformats.html">Binary Dosage Formats</a>.</p>
</div>
<div id="snpidformat" class="section level3">
<h3>snpidformat</h3>
<p>The <span style="font-family:Courier">snpidformat</span> options specifies how the SNP ID is written to the binary dosage file. The default value is 0. This tells the code to use the SNP IDs that are in the VCF file. Other values that can be supplied to the function creates a SNP ID from the chromosome, location, reference, and alternate allele values.</p>
<p>When the snpidformat is set to 1, the SNP ID is written in the format</p>
<p><span style="font-family:Courier">Chromosome:Location</span></p>
<p>When the snpidformat is set to 2, the SNP ID is written in the format</p>
<p><span style="font-family:Courier">Chromosome:Location:Reference Allele:Alternate Allele</span></p>
<p>When the snpidformat is set to -1, the SNP ID is not written to the binary dosage file. When the binary dosage file is read, the SNP ID is generated using the format for snpidformat equal to 2. This reduces the size of the binary dosage file.</p>
<p><strong>Note:</strong> If the SNP IDs in the VCF are in snpidformat 1 or 2, the code recognizes this and writes the smaller binary dosage files.</p>
<p><strong>Note:</strong> If the SNP IDs in the VCF are in snpidformat 2, and the snpidformat option is set to 1, an error will be returned. This is because of possible information loss and the binary dosage file does not change.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">vcf1brsfile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;set1b_rssnp.vcf&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;BinaryDosage&quot;</span>)</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">bdfile1b.snpid0 &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb7-3" data-line-number="3">bdfile1b.snpid1 &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb7-4" data-line-number="4">bdfile1b.snpid2 &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb7-5" data-line-number="5">bdfile1b.snpidm1 &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb7-6" data-line-number="6"></a>
<a class="sourceLine" id="cb7-7" data-line-number="7"><span class="kw">vcftobd</span>(<span class="dt">vcffiles =</span> vcf1brsfile, <span class="dt">bdfiles =</span> bdfile1b.snpid0)</a>
<a class="sourceLine" id="cb7-8" data-line-number="8"><span class="kw">vcftobd</span>(<span class="dt">vcffiles =</span> vcf1brsfile, <span class="dt">bdfiles =</span> bdfile1b.snpid1, <span class="dt">snpidformat =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-9" data-line-number="9"><span class="kw">vcftobd</span>(<span class="dt">vcffiles =</span> vcf1brsfile, <span class="dt">bdfiles =</span> bdfile1b.snpid2, <span class="dt">snpidformat =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-10" data-line-number="10"><span class="kw">vcftobd</span>(<span class="dt">vcffiles =</span> vcf1brsfile, <span class="dt">bdfiles =</span> bdfile1b.snpidm1, <span class="dt">snpidformat =</span> <span class="dv">-1</span>)</a>
<a class="sourceLine" id="cb7-11" data-line-number="11"></a>
<a class="sourceLine" id="cb7-12" data-line-number="12">bdinfo1b.snpid0 &lt;-<span class="st"> </span><span class="kw">getbdinfo</span>(<span class="dt">bdfiles =</span> bdfile1b.snpid0)</a>
<a class="sourceLine" id="cb7-13" data-line-number="13">bdinfo1b.snpid1 &lt;-<span class="st"> </span><span class="kw">getbdinfo</span>(<span class="dt">bdfiles =</span> bdfile1b.snpid1)</a>
<a class="sourceLine" id="cb7-14" data-line-number="14">bdinfo1b.snpid2 &lt;-<span class="st"> </span><span class="kw">getbdinfo</span>(<span class="dt">bdfiles =</span> bdfile1b.snpid2)</a>
<a class="sourceLine" id="cb7-15" data-line-number="15">bdinfo1b.snpidm1 &lt;-<span class="st"> </span><span class="kw">getbdinfo</span>(<span class="dt">bdfiles =</span> bdfile1b.snpidm1)</a>
<a class="sourceLine" id="cb7-16" data-line-number="16"></a>
<a class="sourceLine" id="cb7-17" data-line-number="17">snpnames &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">format0 =</span> bdinfo1b.snpid0<span class="op">$</span>snps<span class="op">$</span>snpid, <span class="dt">format1 =</span> bdinfo1b.snpid1<span class="op">$</span>snps<span class="op">$</span>snpid, </a>
<a class="sourceLine" id="cb7-18" data-line-number="18">    <span class="dt">format2 =</span> bdinfo1b.snpid2<span class="op">$</span>snps<span class="op">$</span>snpid, <span class="dt">formatm1 =</span> bdinfo1b.snpidm1<span class="op">$</span>snps<span class="op">$</span>snpid)</a>
<a class="sourceLine" id="cb7-19" data-line-number="19"></a>
<a class="sourceLine" id="cb7-20" data-line-number="20">knitr<span class="op">::</span><span class="kw">kable</span>(snpnames, <span class="dt">caption =</span> <span class="st">&quot;SNP Names by Format&quot;</span>)</a></code></pre></div>
<table>
<caption>SNP Names by Format</caption>
<thead>
<tr class="header">
<th align="left">format0</th>
<th align="left">format1</th>
<th align="left">format2</th>
<th align="left">formatm1</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1:10000:C:A</td>
<td align="left">1:10000</td>
<td align="left">1:10000:C:A</td>
<td align="left">1:10000:C:A</td>
</tr>
<tr class="even">
<td align="left">1:11000:T:C</td>
<td align="left">1:11000</td>
<td align="left">1:11000:T:C</td>
<td align="left">1:11000:T:C</td>
</tr>
<tr class="odd">
<td align="left">1:12000:T:C</td>
<td align="left">1:12000</td>
<td align="left">1:12000:T:C</td>
<td align="left">1:12000:T:C</td>
</tr>
<tr class="even">
<td align="left">1:13000:T:C</td>
<td align="left">1:13000</td>
<td align="left">1:13000:T:C</td>
<td align="left">1:13000:T:C</td>
</tr>
<tr class="odd">
<td align="left">1:14000:G:C</td>
<td align="left">1:14000</td>
<td align="left">1:14000:G:C</td>
<td align="left">1:14000:G:C</td>
</tr>
<tr class="even">
<td align="left">1:15000:A:C</td>
<td align="left">1:15000</td>
<td align="left">1:15000:A:C</td>
<td align="left">1:15000:A:C</td>
</tr>
<tr class="odd">
<td align="left">1:16000:G:A</td>
<td align="left">1:16000</td>
<td align="left">1:16000:G:A</td>
<td align="left">1:16000:G:A</td>
</tr>
<tr class="even">
<td align="left">1:17000:C:A</td>
<td align="left">1:17000</td>
<td align="left">1:17000:C:A</td>
<td align="left">1:17000:C:A</td>
</tr>
<tr class="odd">
<td align="left">1:18000:C:G</td>
<td align="left">1:18000</td>
<td align="left">1:18000:C:G</td>
<td align="left">1:18000:C:G</td>
</tr>
<tr class="even">
<td align="left">1:19000:T:G</td>
<td align="left">1:19000</td>
<td align="left">1:19000:T:G</td>
<td align="left">1:19000:T:G</td>
</tr>
<tr class="odd">
<td align="left">rs12345</td>
<td align="left">1:20000</td>
<td align="left">1:20000:A:G</td>
<td align="left">1:20000:A:G</td>
</tr>
</tbody>
</table>
</div>
<div id="bdoptions" class="section level3">
<h3>bdoptions</h3>
<p>When using binary dosage format 4.x it is possible to store additional information about the SNPs in the file. This is information consists of the following values</p>
<ul>
<li>Alternate allele frequency</li>
<li>Minor allele frequency</li>
<li>Average call</li>
<li>Imputation r-squared</li>
</ul>
<p>These values are normally provided in the imputation information file. However, it is possible to calculate the alternate and minor allele frequency without the imputation information file. This can be useful when a subset of subjects is extracted from the VCF file that returned from minimac. It is also possible to estimate the imputation r-squared. See the vignette <a href="r2estimates.html">Estimating Imputed R-squares</a> for more information on the r-squared estimate.</p>
<p>The value for bdoptions is a vector of character values that can be “aaf”, “maf”, “rsq”, or and combination of these values. The values indicate to calculate alternate allele frequency, minor allele frequency, and imputation r-squared respectively.</p>
<p>The following code converts the <em>set1a.vcf</em> file into a binary dosage file and calculates the alternate allele frequency and the minor allele frequency, and estimates the imputed r-squared. These values are then compared to the values in the binary dosage file that was generated by using the <em>set1a.info</em> information file.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">vcf1afile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;set1a.vcf&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;BinaryDosage&quot;</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">bdfile1a_calcinfo &lt;-<span class="st"> </span><span class="kw">tempfile</span>()</a>
<a class="sourceLine" id="cb8-3" data-line-number="3"><span class="kw">vcftobd</span>(<span class="dt">vcffiles =</span> vcf1afile, <span class="dt">bdfiles =</span> bdfile1a_calcinfo, <span class="dt">bdoptions =</span> <span class="kw">c</span>(<span class="st">&quot;aaf&quot;</span>, <span class="st">&quot;maf&quot;</span>, </a>
<a class="sourceLine" id="cb8-4" data-line-number="4">    <span class="st">&quot;rsq&quot;</span>))</a>
<a class="sourceLine" id="cb8-5" data-line-number="5"><span class="co">#&gt; [1] 0</span></a>
<a class="sourceLine" id="cb8-6" data-line-number="6"></a>
<a class="sourceLine" id="cb8-7" data-line-number="7">bdcalcinfo &lt;-<span class="st"> </span><span class="kw">getbdinfo</span>(bdfile1a_calcinfo)</a>
<a class="sourceLine" id="cb8-8" data-line-number="8"></a>
<a class="sourceLine" id="cb8-9" data-line-number="9">snpinfo &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">aaf_info =</span> bdinfo1a_winfo<span class="op">$</span>snpinfo<span class="op">$</span>aaf, <span class="dt">aaf_calc =</span> bdcalcinfo<span class="op">$</span>snpinfo<span class="op">$</span>aaf, </a>
<a class="sourceLine" id="cb8-10" data-line-number="10">    <span class="dt">maf_info =</span> bdinfo1a_winfo<span class="op">$</span>snpinfo<span class="op">$</span>maf, <span class="dt">maf_calc =</span> bdcalcinfo<span class="op">$</span>snpinfo<span class="op">$</span>maf, <span class="dt">rsq_info =</span> bdinfo1a_winfo<span class="op">$</span>snpinfo<span class="op">$</span>rsq, </a>
<a class="sourceLine" id="cb8-11" data-line-number="11">    <span class="dt">rsq_calc =</span> bdcalcinfo<span class="op">$</span>snpinfo<span class="op">$</span>rsq)</a>
<a class="sourceLine" id="cb8-12" data-line-number="12"></a>
<a class="sourceLine" id="cb8-13" data-line-number="13">knitr<span class="op">::</span><span class="kw">kable</span>(snpinfo, <span class="dt">caption =</span> <span class="st">&quot;Information vs Calculated Information&quot;</span>, <span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<table>
<caption>Information vs Calculated Information</caption>
<thead>
<tr class="header">
<th align="right">aaf_info</th>
<th align="right">aaf_calc</th>
<th align="right">maf_info</th>
<th align="right">maf_calc</th>
<th align="right">rsq_info</th>
<th align="right">rsq_calc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">0.347</td>
<td align="right">0.347</td>
<td align="right">0.347</td>
<td align="right">0.347</td>
<td align="right">0.956</td>
<td align="right">0.956</td>
</tr>
<tr class="even">
<td align="right">0.016</td>
<td align="right">0.016</td>
<td align="right">0.016</td>
<td align="right">0.016</td>
<td align="right">0.434</td>
<td align="right">0.434</td>
</tr>
<tr class="odd">
<td align="right">0.265</td>
<td align="right">0.265</td>
<td align="right">0.265</td>
<td align="right">0.265</td>
<td align="right">0.933</td>
<td align="right">0.933</td>
</tr>
<tr class="even">
<td align="right">0.297</td>
<td align="right">0.297</td>
<td align="right">0.297</td>
<td align="right">0.297</td>
<td align="right">0.952</td>
<td align="right">0.952</td>
</tr>
<tr class="odd">
<td align="right">0.204</td>
<td align="right">0.204</td>
<td align="right">0.204</td>
<td align="right">0.204</td>
<td align="right">0.970</td>
<td align="right">0.970</td>
</tr>
<tr class="even">
<td align="right">0.524</td>
<td align="right">0.524</td>
<td align="right">0.476</td>
<td align="right">0.476</td>
<td align="right">0.955</td>
<td align="right">0.955</td>
</tr>
<tr class="odd">
<td align="right">0.425</td>
<td align="right">0.425</td>
<td align="right">0.425</td>
<td align="right">0.425</td>
<td align="right">0.951</td>
<td align="right">0.951</td>
</tr>
<tr class="even">
<td align="right">0.443</td>
<td align="right">0.443</td>
<td align="right">0.443</td>
<td align="right">0.443</td>
<td align="right">0.948</td>
<td align="right">0.948</td>
</tr>
<tr class="odd">
<td align="right">0.265</td>
<td align="right">0.265</td>
<td align="right">0.265</td>
<td align="right">0.265</td>
<td align="right">0.927</td>
<td align="right">0.927</td>
</tr>
<tr class="even">
<td align="right">0.245</td>
<td align="right">0.245</td>
<td align="right">0.245</td>
<td align="right">0.245</td>
<td align="right">0.964</td>
<td align="right">0.964</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div id="additional-routines" class="section level1">
<h1>Additional routines</h1>
<p>The following routines are available for accessing information contained in VCF files</p>
<ul>
<li><span style="font-family:Courier">getvcfinfo</span></li>
<li><span style="font-family:Courier">vcfapply</span></li>
</ul>
<div id="getvcfinfo" class="section level2">
<h2>getvcfinfo</h2>
<p>The <span style="font-family:Courier">getvcfinfo</span> routine returns information about a VCF file. For more information about the data returned see <a href="geneticfileinfo.html">Genetic File Information</a>. This information needs to be passed to vcfapply so it can efficiently read the VCF file.</p>
<p>The parameters passed to <span style="font-family:Courier">getvcfinfo</span> are</p>
<ul>
<li><span style="font-family:Courier">filenames</span></li>
<li><span style="font-family:Courier">gz</span></li>
<li><span style="font-family:Courier">index</span></li>
<li><span style="font-family:Courier">snpidformat</span></li>
</ul>
<p><span style="font-family:Courier">filenames</span> is a character vector that can contain up to two values. The first value is the name of the VCF file. The second value is optional and is the name of the imputation information file.</p>
<p><span style="font-family:Courier">gz</span> is a logical value that indicates if the VCF file has been compressed using gzip. This only applies to the VCF file. Compression of the imputation information file is not supported.</p>
<p><span style="font-family:Courier">index</span> is a logical value that indicates if the VCF file should be indexed. Indexing the VCF file takes time but greatly reduces the time needed to read the file. Indexing can only be done on uncompressed VCF files.</p>
<p><span style="font-family:Courier">snpidformat</span> is an integer value from 0 to 2 that indicates how the SNP ID should be formatted. The value indicates which of the follow formats to use.</p>
<ul>
<li>0 - Value in VCF file</li>
<li>1 - <span style="font-family:Courier">Chromosome:Location(bp)</span></li>
<li>2 - <span style="font-family:Courier">Chromosome:Location(bp):Reference Allele:Alternate Allele</span></li>
</ul>
</div>
<div id="vcfapply" class="section level2">
<h2>vcfapply</h2>
<p>The <span style="font-family:Courier">vcfapply</span> routine applies a function to all SNPs in the VCF file. The routine returns a list with length equal to the number of SNPs in the VCF file. Each element in the list is the value returned by the user supplied function. The routine takes the following parameters.</p>
<ul>
<li><span style="font-family:Courier">vcfinfo</span> - list with information about the VCF file returned by <span style="font-family:Courier">getvcfinfo</span>.</li>
<li><span style="font-family:Courier">func</span> - user supplied function to be applied to each SNP in the VCF file.</li>
<li><span style="font-family:Courier">…</span> - additional parameters needed by the user supplied function</li>
</ul>
<p>The user supplied function must have the following parameters.</p>
<ul>
<li><span style="font-family:Courier">vcfinfo</span> - A numeric vector with the dosage values for each subject.</li>
<li><span style="font-family:Courier">p0</span> - A numeric vector with the probabilities the subject has no alternate alleles for each subject.</li>
<li><span style="font-family:Courier">p1</span> - A numeric vector with the probabilities the subject has one alternate allele for each subject.</li>
<li><span style="font-family:Courier">p2</span> - A numeric vector with the probabilities the subject has two alternate alleles for each subject.</li>
</ul>
<p>The user supplied function can have other parameters. These parameters need to passed to the <span style="font-family:Courier">vcfapply</span> routine.</p>
<p>There is a function in the <span style="font-family:Courier">BinaryDosage</span> package named <span style="font-family:Courier">getaaf</span> that calculates the alternate allele frequencies and is the format needed by <span style="font-family:Courier">vcfapply</span> routine. The following uses <span style="font-family:Courier">getaaf</span> to calculate the alternate allele frequency for each SNP in the <em>set1a.vcf</em> file using the <span style="font-family:Courier">vcfapply</span> routine and compares it to the aaf in the information file.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1">vcf1afile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;set1a.vcf&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;BinaryDosage&quot;</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2">vcfinfo &lt;-<span class="st"> </span><span class="kw">getvcfinfo</span>(vcf1afile, <span class="dt">index =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-3" data-line-number="3">aaf &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">vcfapply</span>(<span class="dt">vcfinfo =</span> vcfinfo, getaaf))</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">altallelefreq &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">SNP =</span> vcfinfo<span class="op">$</span>snps<span class="op">$</span>snpid, <span class="dt">aafinfo =</span> aaf1a_winfo, <span class="dt">aafcalc =</span> aaf)</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">knitr<span class="op">::</span><span class="kw">kable</span>(altallelefreq, <span class="dt">caption =</span> <span class="st">&quot;Information vs Calculated aaf&quot;</span>, <span class="dt">digits =</span> <span class="dv">3</span>)</a></code></pre></div>
<table>
<caption>Information vs Calculated aaf</caption>
<thead>
<tr class="header">
<th align="left">SNP</th>
<th align="right">aafinfo</th>
<th align="right">aafcalc</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">1:10000:C:A</td>
<td align="right">0.347</td>
<td align="right">0.347</td>
</tr>
<tr class="even">
<td align="left">1:11000:T:C</td>
<td align="right">0.016</td>
<td align="right">0.016</td>
</tr>
<tr class="odd">
<td align="left">1:12000:T:C</td>
<td align="right">0.265</td>
<td align="right">0.265</td>
</tr>
<tr class="even">
<td align="left">1:13000:T:C</td>
<td align="right">0.297</td>
<td align="right">0.297</td>
</tr>
<tr class="odd">
<td align="left">1:14000:G:C</td>
<td align="right">0.204</td>
<td align="right">0.204</td>
</tr>
<tr class="even">
<td align="left">1:15000:A:C</td>
<td align="right">0.524</td>
<td align="right">0.524</td>
</tr>
<tr class="odd">
<td align="left">1:16000:G:A</td>
<td align="right">0.425</td>
<td align="right">0.425</td>
</tr>
<tr class="even">
<td align="left">1:17000:C:A</td>
<td align="right">0.443</td>
<td align="right">0.443</td>
</tr>
<tr class="odd">
<td align="left">1:18000:C:G</td>
<td align="right">0.265</td>
<td align="right">0.265</td>
</tr>
<tr class="even">
<td align="left">1:19000:T:G</td>
<td align="right">0.245</td>
<td align="right">0.245</td>
</tr>
</tbody>
</table>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
