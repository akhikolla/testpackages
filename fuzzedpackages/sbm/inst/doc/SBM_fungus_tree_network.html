<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="team großBM" />

<meta name="date" content="2020-10-12" />

<title>Simple and Bipartite Stochastic Block Models</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
      code.sourceCode > span { display: inline-block; line-height: 1.25; }
  code.sourceCode > span { color: inherit; text-decoration: inherit; }
  code.sourceCode > span:empty { height: 1.2em; }
  .sourceCode { overflow: visible; }
  code.sourceCode { white-space: pre; position: relative; }
  div.sourceCode { margin: 1em 0; }
  pre.sourceCode { margin: 0; }
  @media screen {
  div.sourceCode { overflow: auto; }
  }
  @media print {
  code.sourceCode { white-space: pre-wrap; }
  code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
  }
  pre.numberSource code
    { counter-reset: source-line 0; }
  pre.numberSource code > span
    { position: relative; left: -4em; counter-increment: source-line; }
  pre.numberSource code > span > a:first-child::before
    { content: counter(source-line);
      position: relative; left: -1em; text-align: right; vertical-align: baseline;
      border: none; display: inline-block;
      -webkit-touch-callout: none; -webkit-user-select: none;
      -khtml-user-select: none; -moz-user-select: none;
      -ms-user-select: none; user-select: none;
      padding: 0 4px; width: 4em;
      color: #aaaaaa;
    }
  pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
  div.sourceCode
    {   }
  @media screen {
  code.sourceCode > span > a:first-child::before { text-decoration: underline; }
  }
  code span.al { color: #ff0000; font-weight: bold; } /* Alert */
  code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
  code span.at { color: #7d9029; } /* Attribute */
  code span.bn { color: #40a070; } /* BaseN */
  code span.bu { } /* BuiltIn */
  code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
  code span.ch { color: #4070a0; } /* Char */
  code span.cn { color: #880000; } /* Constant */
  code span.co { color: #60a0b0; font-style: italic; } /* Comment */
  code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
  code span.do { color: #ba2121; font-style: italic; } /* Documentation */
  code span.dt { color: #902000; } /* DataType */
  code span.dv { color: #40a070; } /* DecVal */
  code span.er { color: #ff0000; font-weight: bold; } /* Error */
  code span.ex { } /* Extension */
  code span.fl { color: #40a070; } /* Float */
  code span.fu { color: #06287e; } /* Function */
  code span.im { } /* Import */
  code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
  code span.kw { color: #007020; font-weight: bold; } /* Keyword */
  code span.op { color: #666666; } /* Operator */
  code span.ot { color: #007020; } /* Other */
  code span.pp { color: #bc7a00; } /* Preprocessor */
  code span.sc { color: #4070a0; } /* SpecialChar */
  code span.ss { color: #bb6688; } /* SpecialString */
  code span.st { color: #4070a0; } /* String */
  code span.va { color: #19177c; } /* Variable */
  code span.vs { color: #4070a0; } /* VerbatimString */
  code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Simple and Bipartite Stochastic Block Models</h1>
<h3 class="subtitle">An illustration on antogonistic tree/fungus network</h3>
<h4 class="author">team großBM</h4>
<h4 class="date">2020-10-12</h4>


<div id="TOC">
<ul>
<li><a href="#preliminaries">Preliminaries</a><ul>
<li><a href="#requirements">Requirements</a></li>
<li><a href="#data-set-antagonistic-treefungus-interaction-network">Data set: antagonistic tree/fungus interaction network</a></li>
<li><a href="#mathematical-background">Mathematical Background</a></li>
</ul></li>
<li><a href="#analysis-of-the-treetree-data">Analysis of the tree/tree data</a><ul>
<li><a href="#tree-tree-binary-interaction-networks">Tree-tree binary interaction networks</a><ul>
<li><a href="#about-model-selection-and-choice-of-the-number-of-blocks">About model selection and choice of the number of blocks</a></li>
</ul></li>
<li><a href="#analysis-of-the-weighted-interaction-network">Analysis of the weighted interaction network</a></li>
<li><a href="#introduction-of-covariates">Introduction of covariates</a></li>
</ul></li>
<li><a href="#analysis-of-the-treefungi-data">Analysis of the tree/fungi data</a></li>
<li><a href="#references">References</a></li>
</ul>
</div>

<div id="preliminaries" class="section level2">
<h2>Preliminaries</h2>
<p>This vignette illustrates the use of the <code>estimateSBM</code> function and the methods accompanying the R6 classes <code>SimpleSBMfit</code> and <code>BipartiteSBMfit</code>.</p>
<div id="requirements" class="section level3">
<h3>Requirements</h3>
<p>The packages required for the analysis are <strong>sbm</strong> plus some others for data manipulation and representation:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(sbm)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(igraph)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="kw">library</span>(knitr)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">library</span>(alluvial)</span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="kw">theme_set</span>(<span class="kw">theme_bw</span>())</span></code></pre></div>
</div>
<div id="data-set-antagonistic-treefungus-interaction-network" class="section level3">
<h3>Data set: antagonistic tree/fungus interaction network</h3>
<p>We consider the fungus-tree interaction network studied by <span class="citation">Vacher, Piou, and Desprez-Loustau (<a href="#ref-tree_fungus_network" role="doc-biblioref">2008</a>)</span>, available with the package <strong>sbm</strong>:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw">data</span>(<span class="st">&quot;fungus_tree_network&quot;</span>)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="kw">str</span>(fungus_tree_network, <span class="dt">max.level =</span> <span class="dv">1</span>)</span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; List of 5</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt;  $ tree_names  : Factor w/ 51 levels &quot;Abies alba&quot;,&quot;Abies grandis&quot;,..: 1 2 3 14 42 4 5 6 7 8 ...</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt;  $ fungus_names: Factor w/ 154 levels &quot;Amphiporthe leiphaemia&quot;,..: 1 2 3 4 5 6 7 8 9 10 ...</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt;  $ tree_tree   : num [1:51, 1:51] 0 12 9 3 2 2 0 0 2 7 ...</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt;  $ fungus_tree : int [1:154, 1:51] 0 0 0 0 1 1 1 0 0 0 ...</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt;  $ covar_tree  :List of 3</span></span></code></pre></div>
<p>This data set provides information about <span class="math inline">\(154\)</span> fungi sampled on <span class="math inline">\(51\)</span> tree species. It is a list with the following entries:</p>
<ul>
<li><code>fungi_list</code>: list of the fungus species names</li>
<li><code>tree_list</code> : list of the tree species names</li>
<li><code>fungus_tree</code> : binary fungus-tree interactions</li>
<li><code>tree_tree</code> : weighted tree-tree interactions (number of common fungal species two tree species host)</li>
<li><code>covar_tree</code> : covariates associated to pairs of trees (namely genetic, taxonomic and geographic distances)</li>
</ul>
<p>We first consider the tree-tree interactions resulting into a Simple Network. Then we consider the bipartite network between trees and fungi.</p>
</div>
<div id="mathematical-background" class="section level3">
<h3>Mathematical Background</h3>
<p>See <span class="citation">Leger (<a href="#ref-blockmodels" role="doc-biblioref">2016</a>)</span> for details.</p>
</div>
</div>
<div id="analysis-of-the-treetree-data" class="section level2">
<h2>Analysis of the tree/tree data</h2>
<div id="tree-tree-binary-interaction-networks" class="section level3">
<h3>Tree-tree binary interaction networks</h3>
<p>We first consider the binary network where an edge is drawn between two trees when they do share a least one common fungi:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>tree_tree_binary &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>(fungus_tree_network<span class="op">$</span>tree_tree <span class="op">!=</span><span class="st"> </span><span class="dv">0</span>)</span></code></pre></div>
<p>The simple function <code>plotMyMatrix</code> can be use to represent simple or bipartite SBM:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">plotMyMatrix</span>(tree_tree_binary, <span class="dt">dimLabels =</span> <span class="kw">list</span>(<span class="dt">row =</span> <span class="st">&#39;tree&#39;</span>, <span class="dt">col =</span> <span class="st">&#39;tree&#39;</span>) )</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> We look for some latent structure of the network by adjusting a simple SBM with the function <code>estimateSimpleSBM</code>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>mySimpleSBM &lt;-<span class="st"> </span>tree_tree_binary <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="st">  </span><span class="kw">estimateSimpleSBM</span>(<span class="st">&quot;bernoulli&quot;</span>, <span class="dt">dimLabels =</span> <span class="kw">list</span>(<span class="dt">row =</span> <span class="st">&#39;tree&#39;</span>, <span class="dt">col=</span><span class="st">&#39;tree&#39;</span>), <span class="dt">estimOptions =</span> <span class="kw">list</span>(<span class="dt">verbosity =</span> <span class="dv">0</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p>Once fitted, the user can manipulate the fitted model by accessing the various fields and methods enjoyed by the class <code>simpleSBMfit</code>. Most important fields and methods are recalled to the user via the <code>show</code> method:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">class</span>(mySimpleSBM)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt; [1] &quot;SimpleSBM_fit&quot; &quot;SBM_fit&quot;       &quot;SBM&quot;           &quot;R6&quot;</span></span>
<span id="cb6-3"><a href="#cb6-3"></a>mySimpleSBM</span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt; Fit of a Simple Stochastic Block Model -- bernoulli variant</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; =====================================================================</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt; Dimension = ( 51 51 ) - ( 5 ) blocks and no covariate(s).</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt; =====================================================================</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt; * Useful fields </span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt;   $dimension, $modelName, $nbNodes, $nbBlocks, $nbCovariates, $nbDyads</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt;   $blockProp, $connectParam, $covarParam, $covarList, $covarEffect, $dimLabels </span></span>
<span id="cb6-11"><a href="#cb6-11"></a><span class="co">#&gt;   $probMemberships, $memberships, $loglik, $ICL, $storedModels, $setModel </span></span>
<span id="cb6-12"><a href="#cb6-12"></a><span class="co">#&gt; * S3 methods </span></span>
<span id="cb6-13"><a href="#cb6-13"></a><span class="co">#&gt;   plot, print, coef, predict, fitted</span></span></code></pre></div>
<p>For instance,</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>mySimpleSBM<span class="op">$</span>nbBlocks</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#&gt; [1] 5</span></span>
<span id="cb7-3"><a href="#cb7-3"></a>mySimpleSBM<span class="op">$</span>nbNodes</span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt; [1] 51</span></span>
<span id="cb7-5"><a href="#cb7-5"></a>mySimpleSBM<span class="op">$</span>nbCovariates</span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>The plot method is available as a S3 or R6 method. The default represents the network data reordered according to the memberships estimated in the SBM</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">plot</span>(mySimpleSBM, <span class="dt">type =</span> <span class="st">&quot;data&quot;</span>, <span class="dt">dimLabels  =</span> <span class="kw">list</span>(<span class="dt">row =</span> <span class="st">&#39;tree&#39;</span>, <span class="dt">col=</span> <span class="st">&#39;tree&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>One can also plot the expected network which, in case of the Bernoulli model, corresponds to the probability of connection between any pair of nodes in the network.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">plot</span>(mySimpleSBM, <span class="dt">type =</span> <span class="st">&quot;expected&quot;</span>, <span class="dt">dimLabels  =</span> <span class="kw">list</span>(<span class="dt">row =</span> <span class="st">&#39;tree&#39;</span>, <span class="dt">col=</span> <span class="st">&#39;tree&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">coef</span>(mySimpleSBM, <span class="st">&#39;block&#39;</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#&gt; [1] 0.3320954 0.1766383 0.1378665 0.1766999 0.1766999</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="kw">coef</span>(mySimpleSBM, <span class="st">&#39;connectivity&#39;</span>)</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt; $mean</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">#&gt;            [,1]      [,2]       [,3]       [,4]       [,5]</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt; [1,] 0.98230909 0.9828930 0.92749023 0.60851311 0.05994511</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">#&gt; [2,] 0.98289303 0.9937459 0.29390960 0.91904879 0.22617761</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">#&gt; [3,] 0.92749023 0.2939096 0.79890626 0.05802394 0.02169247</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">#&gt; [4,] 0.60851311 0.9190488 0.05802394 0.47209785 0.06626655</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">#&gt; [5,] 0.05994511 0.2261776 0.02169247 0.06626655 0.02899357</span></span></code></pre></div>
<div id="about-model-selection-and-choice-of-the-number-of-blocks" class="section level4">
<h4>About model selection and choice of the number of blocks</h4>
<p>During the estimation, a certain range of models are explored corresponding to different number of blocks. By default, the best model in terms of Integrated Classification Likelihood is sent back. IN fact, all the model are stored internally. The user can have a quick glance at them via the <code>$storedModels</code> field:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>mySimpleSBM<span class="op">$</span>storedModels <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">kable</span>()</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">nbParams</th>
<th align="right">nbBlocks</th>
<th align="right">ICL</th>
<th align="right">loglik</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">1</td>
<td align="right">-883.3334</td>
<td align="right">-879.7581</td>
</tr>
<tr class="even">
<td align="right">4</td>
<td align="right">2</td>
<td align="right">-619.0799</td>
<td align="right">-606.3880</td>
</tr>
<tr class="odd">
<td align="right">8</td>
<td align="right">3</td>
<td align="right">-537.5179</td>
<td align="right">-512.1339</td>
</tr>
<tr class="even">
<td align="right">13</td>
<td align="right">4</td>
<td align="right">-540.6318</td>
<td align="right">-498.9806</td>
</tr>
<tr class="odd">
<td align="right">19</td>
<td align="right">5</td>
<td align="right">-520.6645</td>
<td align="right">-459.1706</td>
</tr>
<tr class="even">
<td align="right">26</td>
<td align="right">6</td>
<td align="right">-530.6278</td>
<td align="right">-445.7159</td>
</tr>
<tr class="odd">
<td align="right">34</td>
<td align="right">7</td>
<td align="right">-544.0191</td>
<td align="right">-432.1138</td>
</tr>
<tr class="even">
<td align="right">43</td>
<td align="right">8</td>
<td align="right">-562.1450</td>
<td align="right">-419.6710</td>
</tr>
</tbody>
</table>
<p>We can then what models are competitive in terms of model selection by checking the ICL</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>mySimpleSBM<span class="op">$</span>storedModels <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="st">  </span><span class="kw">ggplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">aes</span>(<span class="dt">x =</span> nbBlocks, <span class="dt">y =</span> ICL) <span class="op">+</span><span class="st"> </span><span class="kw">geom_line</span>() <span class="op">+</span><span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">alpha =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The 4-block model could have been a good choice too, in place of the 5-block model. The user can update the current <code>simpleSBMfit</code> thanks to the the <code>setModel</code> method:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>mySimpleSBM<span class="op">$</span><span class="kw">setModel</span>(<span class="dv">4</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a>mySimpleSBM<span class="op">$</span>nbBlocks</span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt; [1] 4</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>mySimpleSBM<span class="op">$</span><span class="kw">plot</span>(<span class="dt">type =</span> <span class="st">&#39;expected&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="analysis-of-the-weighted-interaction-network" class="section level3">
<h3>Analysis of the weighted interaction network</h3>
<p>Instead of considering the binary network tree-tree we may consider the weighted network where the link between two trees is the number of fungi they share.</p>
<p>We plot the matrix with function <code>plotMyMatrix</code>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>tree_tree &lt;-<span class="st"> </span>fungus_tree_network<span class="op">$</span>tree_tree</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="kw">plotMyMatrix</span>(tree_tree, <span class="dt">dimLabels =</span> <span class="kw">list</span>(<span class="dt">row =</span> <span class="st">&#39;tree&#39;</span>, <span class="dt">col =</span> <span class="st">&#39;tree&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Here again, we look for some latent structure of the network by adjusting a simple SBM with the function <code>estimateSimpleSBM</code>, considering a Poisson distribution on the edges.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>mySimpleSBMPoisson &lt;-<span class="st"> </span>tree_tree <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="st">  </span><span class="kw">estimateSimpleSBM</span>(<span class="st">&quot;poisson&quot;</span>, <span class="dt">dimLabels =</span> <span class="kw">list</span>(<span class="dt">row =</span> <span class="st">&#39;tree&#39;</span>, <span class="dt">col=</span> <span class="st">&#39;tree&#39;</span>),<span class="dt">estimOptions =</span> <span class="kw">list</span>(<span class="dt">verbosity =</span> <span class="dv">0</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<p>Once fitted, the user can manipulate the fitted model by accessing the various fields and methods enjoyed by the class <code>simpleSBMfit</code>. Most important fields and methods are recalled to the user via the <code>show</code> method:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">class</span>(mySimpleSBMPoisson)</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="co">#&gt; [1] &quot;SimpleSBM_fit&quot; &quot;SBM_fit&quot;       &quot;SBM&quot;           &quot;R6&quot;</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>mySimpleSBMPoisson</span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co">#&gt; Fit of a Simple Stochastic Block Model -- poisson variant</span></span>
<span id="cb16-5"><a href="#cb16-5"></a><span class="co">#&gt; =====================================================================</span></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co">#&gt; Dimension = ( 51 51 ) - ( 6 ) blocks and no covariate(s).</span></span>
<span id="cb16-7"><a href="#cb16-7"></a><span class="co">#&gt; =====================================================================</span></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="co">#&gt; * Useful fields </span></span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="co">#&gt;   $dimension, $modelName, $nbNodes, $nbBlocks, $nbCovariates, $nbDyads</span></span>
<span id="cb16-10"><a href="#cb16-10"></a><span class="co">#&gt;   $blockProp, $connectParam, $covarParam, $covarList, $covarEffect, $dimLabels </span></span>
<span id="cb16-11"><a href="#cb16-11"></a><span class="co">#&gt;   $probMemberships, $memberships, $loglik, $ICL, $storedModels, $setModel </span></span>
<span id="cb16-12"><a href="#cb16-12"></a><span class="co">#&gt; * S3 methods </span></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co">#&gt;   plot, print, coef, predict, fitted</span></span></code></pre></div>
<p>For instance,</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>mySimpleSBMPoisson<span class="op">$</span>nbBlocks</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">#&gt; [1] 6</span></span>
<span id="cb17-3"><a href="#cb17-3"></a>mySimpleSBMPoisson<span class="op">$</span>nbNodes</span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">#&gt; [1] 51</span></span>
<span id="cb17-5"><a href="#cb17-5"></a>mySimpleSBMPoisson<span class="op">$</span>nbCovariates</span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co">#&gt; [1] 0</span></span></code></pre></div>
<p>We now plot the matrix reordered according to the memberships estimated in the SBM</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">plot</span>(mySimpleSBMPoisson, <span class="dt">type =</span> <span class="st">&quot;data&quot;</span>, <span class="dt">dimLabels =</span> <span class="kw">list</span>(<span class="dt">row =</span> <span class="st">&#39;tree&#39;</span>, <span class="dt">col=</span> <span class="st">&#39;tree&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>One can also plot the expected network which, in case of the Poisson model, corresponds to the expectation of connection between any pair of nodes in the network.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw">plot</span>(mySimpleSBMPoisson, <span class="dt">type =</span> <span class="st">&quot;expected&quot;</span>, <span class="dt">dimLabels =</span> <span class="kw">list</span>(<span class="dt">row =</span> <span class="st">&#39;tree&#39;</span>, <span class="dt">col=</span> <span class="st">&#39;tree&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The same manipulations can be made on the models as before.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="kw">coef</span>(mySimpleSBMPoisson, <span class="st">&#39;block&#39;</span>)</span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co">#&gt; [1] 0.1763561 0.1957351 0.1375982 0.1569772 0.1569772 0.1763561</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="kw">coef</span>(mySimpleSBMPoisson, <span class="st">&#39;connectivity&#39;</span>)</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co">#&gt; $mean</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">#&gt;           [,1]      [,2]       [,3]       [,4]       [,5]       [,6]</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">#&gt; [1,] 9.0286270 3.2910355 6.04727443 1.06850270 1.85464212 0.11062572</span></span>
<span id="cb20-7"><a href="#cb20-7"></a><span class="co">#&gt; [2,] 3.2910355 5.9646020 1.33637565 2.17610068 0.49999123 0.26547703</span></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="co">#&gt; [3,] 6.0472744 1.3363757 3.94065914 0.40263458 1.46245649 0.07080814</span></span>
<span id="cb20-9"><a href="#cb20-9"></a><span class="co">#&gt; [4,] 1.0685027 2.1761007 0.40263458 0.82166374 0.14089332 0.07793391</span></span>
<span id="cb20-10"><a href="#cb20-10"></a><span class="co">#&gt; [5,] 1.8546421 0.4999912 1.46245649 0.14089332 0.54121406 0.02263218</span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="co">#&gt; [6,] 0.1106257 0.2654770 0.07080814 0.07793391 0.02263218 0.02940543</span></span></code></pre></div>
</div>
<div id="introduction-of-covariates" class="section level3">
<h3>Introduction of covariates</h3>
<p>We have on each pair of trees 3 covariates, namely the genetic distance, the taxonomic distance and the geographic distance. Each covariate has to be introduced as a matrix: <span class="math inline">\(X^k_{ij}\)</span> corresponds to the value of the <span class="math inline">\(k\)</span>-th covariate describing the couple <span class="math inline">\((i,j)\)</span>.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a>mySimpleSBMCov&lt;-<span class="st"> </span></span>
<span id="cb21-2"><a href="#cb21-2"></a><span class="st">  </span>tree_tree <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb21-3"><a href="#cb21-3"></a><span class="st">  </span><span class="kw">estimateSimpleSBM</span>(</span>
<span id="cb21-4"><a href="#cb21-4"></a>    <span class="dt">model =</span> <span class="st">&#39;poisson&#39;</span>, </span>
<span id="cb21-5"><a href="#cb21-5"></a>    <span class="dt">directed =</span> <span class="ot">FALSE</span>, </span>
<span id="cb21-6"><a href="#cb21-6"></a>    <span class="dt">dimLabels =</span> <span class="kw">list</span>(<span class="dt">row =</span> <span class="st">&#39;tree&#39;</span>, <span class="dt">col=</span> <span class="st">&#39;tree&#39;</span>),</span>
<span id="cb21-7"><a href="#cb21-7"></a>    <span class="dt">covariates  =</span> fungus_tree_network<span class="op">$</span>covar_tree, </span>
<span id="cb21-8"><a href="#cb21-8"></a>    <span class="dt">estimOptions =</span> <span class="kw">list</span>(<span class="dt">verbosity =</span> <span class="dv">0</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>, <span class="dt">nbCores =</span> <span class="dv">1</span>)</span>
<span id="cb21-9"><a href="#cb21-9"></a>  )</span></code></pre></div>
<ul>
<li>We select the best number of clusters (with respect to the ICL criteria)</li>
</ul>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>mySimpleSBMCov<span class="op">$</span>nbBlocks</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co">#&gt; [1] 4</span></span></code></pre></div>
<ul>
<li>We can now extract the parameters of interest, namely (<span class="math inline">\(\lambda\)</span>, <span class="math inline">\(\pi\)</span>) and the clustering of the nodes.</li>
</ul>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>mySimpleSBMCov<span class="op">$</span>connnectParam</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="co">#&gt; NULL</span></span>
<span id="cb23-3"><a href="#cb23-3"></a>mySimpleSBMCov<span class="op">$</span>blockProp</span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="co">#&gt; [1] 0.3715916 0.2159544 0.2354120 0.1770421</span></span>
<span id="cb23-5"><a href="#cb23-5"></a>mySimpleSBMCov<span class="op">$</span>memberships</span>
<span id="cb23-6"><a href="#cb23-6"></a><span class="co">#&gt;  [1] 1 1 2 1 2 2 4 4 2 1 3 1 1 1 1 2 1 2 3 3 2 1 2 1 3 3 2 1 3 2 3 1 4 1 1 3 1 3</span></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co">#&gt; [39] 4 1 1 3 2 4 4 1 4 4 3 3 4</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>mySimpleSBMCov<span class="op">$</span>covarParam</span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="co">#&gt; [1,]  0.1976562</span></span>
<span id="cb23-11"><a href="#cb23-11"></a><span class="co">#&gt; [2,] -2.0549222</span></span>
<span id="cb23-12"><a href="#cb23-12"></a><span class="co">#&gt; [3,] -0.3581233</span></span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="kw">coef</span>(mySimpleSBMCov, <span class="st">&#39;covariates&#39;</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="co">#&gt;            [,1]</span></span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co">#&gt; [1,]  0.1976562</span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co">#&gt; [2,] -2.0549222</span></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co">#&gt; [3,] -0.3581233</span></span></code></pre></div>
<p>S3 methods are also available for fit and prediction (results hidden here)</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="kw">fitted</span>(mySimpleSBMCov)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">predict</span>(mySimpleSBMCov)</span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="kw">predict</span>(mySimpleSBMCov, fungus_tree_network<span class="op">$</span>covar_tree)</span></code></pre></div>
</div>
</div>
<div id="analysis-of-the-treefungi-data" class="section level2">
<h2>Analysis of the tree/fungi data</h2>
<p>We now analyze the bipartite tree/fungi interactions. The incidence matrix can be plotted with the function </p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="kw">plotMyMatrix</span>(fungus_tree_network<span class="op">$</span>fungus_tree, <span class="dt">dimLabels =</span> <span class="kw">list</span>(<span class="dt">row =</span> <span class="st">&#39;fungis&#39;</span>, <span class="dt">col=</span> <span class="st">&#39;tree&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>myBipartiteSBM &lt;-<span class="st"> </span></span>
<span id="cb27-2"><a href="#cb27-2"></a><span class="st">  </span>fungus_tree_network<span class="op">$</span>fungus_tree <span class="op">%&gt;%</span><span class="st"> </span></span>
<span id="cb27-3"><a href="#cb27-3"></a><span class="st">  </span><span class="kw">estimateBipartiteSBM</span>(<span class="dt">model =</span> <span class="st">&#39;bernoulli&#39;</span>, <span class="dt">dimLabels =</span> <span class="kw">list</span>(<span class="dt">row =</span> <span class="st">&#39;fungis&#39;</span>, <span class="dt">col=</span> <span class="st">&#39;tree&#39;</span>),<span class="dt">estimOptions =</span> <span class="kw">list</span>(<span class="dt">verbosity =</span> <span class="dv">0</span>, <span class="dt">plot =</span> <span class="ot">FALSE</span>))</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>myBipartiteSBM<span class="op">$</span>nbNodes</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="co">#&gt; [1] 154  51</span></span>
<span id="cb28-3"><a href="#cb28-3"></a>myBipartiteSBM<span class="op">$</span>nbBlocks</span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="co">#&gt; row col </span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co">#&gt;   4   4</span></span>
<span id="cb28-6"><a href="#cb28-6"></a>myBipartiteSBM<span class="op">$</span>connectParam</span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co">#&gt; $mean</span></span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="co">#&gt;            [,1]        [,2]        [,3]        [,4]</span></span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="co">#&gt; [1,] 0.96813478 0.077538579 0.840370657 0.067563355</span></span>
<span id="cb28-10"><a href="#cb28-10"></a><span class="co">#&gt; [2,] 0.52055882 0.584398216 0.230893917 0.107930384</span></span>
<span id="cb28-11"><a href="#cb28-11"></a><span class="co">#&gt; [3,] 0.32450427 0.003624764 0.098526840 0.005780612</span></span>
<span id="cb28-12"><a href="#cb28-12"></a><span class="co">#&gt; [4,] 0.01834547 0.154334411 0.001330278 0.019219920</span></span>
<span id="cb28-13"><a href="#cb28-13"></a><span class="kw">coef</span>(myBipartiteSBM, <span class="st">&#39;block&#39;</span>)</span>
<span id="cb28-14"><a href="#cb28-14"></a><span class="co">#&gt; $row</span></span>
<span id="cb28-15"><a href="#cb28-15"></a><span class="co">#&gt; [1] 0.02655516 0.05570334 0.31666508 0.60107642</span></span>
<span id="cb28-16"><a href="#cb28-16"></a><span class="co">#&gt; </span></span>
<span id="cb28-17"><a href="#cb28-17"></a><span class="co">#&gt; $col</span></span>
<span id="cb28-18"><a href="#cb28-18"></a><span class="co">#&gt; [1] 0.1050494 0.1963968 0.2477304 0.4508234</span></span>
<span id="cb28-19"><a href="#cb28-19"></a><span class="kw">coef</span>(myBipartiteSBM, <span class="st">&#39;connectivity&#39;</span>)</span>
<span id="cb28-20"><a href="#cb28-20"></a><span class="co">#&gt; $mean</span></span>
<span id="cb28-21"><a href="#cb28-21"></a><span class="co">#&gt;            [,1]        [,2]        [,3]        [,4]</span></span>
<span id="cb28-22"><a href="#cb28-22"></a><span class="co">#&gt; [1,] 0.96813478 0.077538579 0.840370657 0.067563355</span></span>
<span id="cb28-23"><a href="#cb28-23"></a><span class="co">#&gt; [2,] 0.52055882 0.584398216 0.230893917 0.107930384</span></span>
<span id="cb28-24"><a href="#cb28-24"></a><span class="co">#&gt; [3,] 0.32450427 0.003624764 0.098526840 0.005780612</span></span>
<span id="cb28-25"><a href="#cb28-25"></a><span class="co">#&gt; [4,] 0.01834547 0.154334411 0.001330278 0.019219920</span></span></code></pre></div>
<p>We can now plot the reorganized matrix.</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1"></a><span class="kw">plot</span>(myBipartiteSBM, <span class="dt">dimLabels =</span> <span class="kw">list</span>(<span class="dt">row =</span> <span class="st">&#39;fungis&#39;</span>, <span class="dt">col =</span> <span class="st">&#39;tree&#39;</span>))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-blockmodels">
<p>Leger, Jean-Benoist. 2016. “Blockmodels: A R-Package for Estimating in Latent Block Model and Stochastic Block Model, with Various Probability Functions, with or Without Covariates.” <em>arXiv Preprint arXiv:1602.07587</em>.</p>
</div>
<div id="ref-tree_fungus_network">
<p>Vacher, Corinne, Dominique Piou, and Marie-Laure Desprez-Loustau. 2008. “Architecture of an Antagonistic Tree/Fungus Network: The Asymmetric Influence of Past Evolutionary History.” <em>PloS One</em> 3 (3): e1740.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
