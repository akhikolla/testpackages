
R version 3.6.2 (2019-12-12) -- "Dark and Stormy Night"
Copyright (C) 2019 The R Foundation for Statistical Computing
Platform: x86_64-pc-linux-gnu (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> library(automap)
Loading required package: sp
> library(psgp)
Loading required package: intamap
> 
> data(meuse)
> observations = data.frame(x = meuse$x,y = meuse$y,value = log(meuse$zinc))
> coordinates(observations) = ~x+y
> set.seed(13531)
> predictionLocations = spsample(observations, 50, "regular")
> 
> krigingObject = createIntamapObject(
+ 	observations = observations,
+ 	predictionLocations = predictionLocations,
+   formulaString = as.formula(value~1),
+ 	params =  list(doAnisotropy = TRUE, thresh = quantile(observations$value,0.9)),
+   outputWhat = list(mean=TRUE, variance=TRUE, excprob = 5.9, cumdistr = 5.9, 
+ 		quantile = .1)
+ )
> class(krigingObject) = c("psgp")
> 
> checkSetup(krigingObject)
Checking object ... OK
> krigingObject = preProcess(krigingObject)
> krigingObject = estimateParameters(krigingObject)
Range: 716.69
Sill: 0.77
Nugget: 0.01
Bias: 0.17
No noise model specified
Defaulting to GAUSSIAN with variance 0.00
Processing observation: 1/155Processing observation: 2/155Processing observation: 3/155Processing observation: 4/155Processing observation: 5/155Processing observation: 6/155Processing observation: 7/155Processing observation: 8/155Processing observation: 9/155Processing observation: 10/155Processing observation: 11/155Processing observation: 12/155Processing observation: 13/155Processing observation: 14/155Processing observation: 15/155Processing observation: 16/155Processing observation: 17/155Processing observation: 18/155Processing observation: 19/155Processing observation: 20/155Processing observation: 21/155Processing observation: 22/155Processing observation: 23/155Processing observation: 24/155Processing observation: 25/155Processing observation: 26/155Processing observation: 27/155Processing observation: 28/155Processing observation: 29/155Processing observation: 30/155Processing observation: 31/155Processing observation: 32/155Processing observation: 33/155Processing observation: 34/155Processing observation: 35/155Processing observation: 36/155Processing observation: 37/155Processing observation: 38/155Processing observation: 39/155Processing observation: 40/155Processing observation: 41/155Processing observation: 42/155Processing observation: 43/155Processing observation: 44/155Processing observation: 45/155Processing observation: 46/155Processing observation: 47/155Processing observation: 48/155Processing observation: 49/155Processing observation: 50/155Processing observation: 51/155Processing observation: 52/155Processing observation: 53/155Processing observation: 54/155Processing observation: 55/155Processing observation: 56/155Processing observation: 57/155Processing observation: 58/155Processing observation: 59/155Processing observation: 60/155Processing observation: 61/155Processing observation: 62/155Processing observation: 63/155Processing observation: 64/155Processing observation: 65/155Processing observation: 66/155Processing observation: 67/155Processing observation: 68/155Processing observation: 69/155Processing observation: 70/155Processing observation: 71/155Processing observation: 72/155Processing observation: 73/155Processing observation: 74/155Processing observation: 75/155Processing observation: 76/155Processing observation: 77/155Processing observation: 78/155Processing observation: 79/155Processing observation: 80/155Processing observation: 81/155Processing observation: 82/155Processing observation: 83/155Processing observation: 84/155Processing observation: 85/155Processing observation: 86/155Processing observation: 87/155Processing observation: 88/155Processing observation: 89/155Processing observation: 90/155Processing observation: 91/155Processing observation: 92/155Processing observation: 93/155Processing observation: 94/155Processing observation: 95/155Processing observation: 96/155Processing observation: 97/155Processing observation: 98/155Processing observation: 99/155Processing observation: 100/155Processing observation: 101/155Processing observation: 102/155Processing observation: 103/155Processing observation: 104/155Processing observation: 105/155Processing observation: 106/155Processing observation: 107/155Processing observation: 108/155Processing observation: 109/155Processing observation: 110/155Processing observation: 111/155Processing observation: 112/155Processing observation: 113/155Processing observation: 114/155Processing observation: 115/155Processing observation: 116/155Processing observation: 117/155Processing observation: 118/155Processing observation: 119/155Processing observation: 120/155Processing observation: 121/155Processing observation: 122/155Processing observation: 123/155Processing observation: 124/155Processing observation: 125/155Processing observation: 126/155Processing observation: 127/155Processing observation: 128/155Processing observation: 129/155Processing observation: 130/155Processing observation: 131/155Processing observation: 132/155Processing observation: 133/155Processing observation: 134/155Processing observation: 135/155Processing observation: 136/155Processing observation: 137/155Processing observation: 138/155Processing observation: 139/155Processing observation: 140/155Processing observation: 141/155Processing observation: 142/155Processing observation: 143/155Processing observation: 144/155Processing observation: 145/155Processing observation: 146/155Processing observation: 147/155Processing observation: 148/155Processing observation: 149/155Processing observation: 150/155Processing observation: 151/155Processing observation: 152/155Processing observation: 153/155Processing observation: 154/155Processing observation: 155/155Processing observation: 1/155Processing observation: 2/155Processing observation: 3/155Processing observation: 4/155Processing observation: 5/155Processing observation: 6/155Processing observation: 7/155Processing observation: 8/155Processing observation: 9/155Processing observation: 10/155Processing observation: 11/155Processing observation: 12/155Processing observation: 13/155Processing observation: 14/155Processing observation: 15/155Processing observation: 16/155Processing observation: 17/155Processing observation: 18/155Processing observation: 19/155Processing observation: 20/155Processing observation: 21/155Processing observation: 22/155Processing observation: 23/155Processing observation: 24/155Processing observation: 25/155Processing observation: 26/155Processing observation: 27/155Processing observation: 28/155Processing observation: 29/155Processing observation: 30/155Processing observation: 31/155Processing observation: 32/155Processing observation: 33/155Processing observation: 34/155Processing observation: 35/155Processing observation: 36/155Processing observation: 37/155Processing observation: 38/155Processing observation: 39/155Processing observation: 40/155Processing observation: 41/155Processing observation: 42/155Processing observation: 43/155Processing observation: 44/155Processing observation: 45/155Processing observation: 46/155Processing observation: 47/155Processing observation: 48/155Processing observation: 49/155Processing observation: 50/155Processing observation: 51/155Processing observation: 52/155Processing observation: 53/155Processing observation: 54/155Processing observation: 55/155Processing observation: 56/155Processing observation: 57/155Processing observation: 58/155Processing observation: 59/155Processing observation: 60/155Processing observation: 61/155Processing observation: 62/155Processing observation: 63/155Processing observation: 64/155Processing observation: 65/155Processing observation: 66/155Processing observation: 67/155Processing observation: 68/155Processing observation: 69/155Processing observation: 70/155Processing observation: 71/155Processing observation: 72/155Processing observation: 73/155Processing observation: 74/155Processing observation: 75/155Processing observation: 76/155Processing observation: 77/155Processing observation: 78/155Processing observation: 79/155Processing observation: 80/155Processing observation: 81/155Processing observation: 82/155Processing observation: 83/155Processing observation: 84/155Processing observation: 85/155Processing observation: 86/155Processing observation: 87/155Processing observation: 88/155Processing observation: 89/155Processing observation: 90/155Processing observation: 91/155Processing observation: 92/155Processing observation: 93/155Processing observation: 94/155Processing observation: 95/155Processing observation: 96/155Processing observation: 97/155Processing observation: 98/155Processing observation: 99/155Processing observation: 100/155Processing observation: 101/155Processing observation: 102/155Processing observation: 103/155Processing observation: 104/155Processing observation: 105/155Processing observation: 106/155Processing observation: 107/155Processing observation: 108/155Processing observation: 109/155Processing observation: 110/155Processing observation: 111/155Processing observation: 112/155Processing observation: 113/155Processing observation: 114/155Processing observation: 115/155Processing observation: 116/155Processing observation: 117/155Processing observation: 118/155Processing observation: 119/155Processing observation: 120/155Processing observation: 121/155Processing observation: 122/155Processing observation: 123/155Processing observation: 124/155Processing observation: 125/155Processing observation: 126/155Processing observation: 127/155Processing observation: 128/155Processing observation: 129/155Processing observation: 130/155Processing observation: 131/155Processing observation: 132/155Processing observation: 133/155Processing observation: 134/155Processing observation: 135/155Processing observation: 136/155Processing observation: 137/155Processing observation: 138/155Processing observation: 139/155Processing observation: 140/155Processing observation: 141/155Processing observation: 142/155Processing observation: 143/155Processing observation: 144/155Processing observation: 145/155Processing observation: 146/155Processing observation: 147/155Processing observation: 148/155Processing observation: 149/155Processing observation: 150/155Processing observation: 151/155Processing observation: 152/155Processing observation: 153/155Processing observation: 154/155Processing observation: 155/155Covariance function : Sum
+ Component: 1
   Covariance function : Isotropic Exponential
   Range  (P0) :716.690
   Variance  (P1) :0.766
+ Component: 2
   Covariance function : Matern 5/2 covariance function
   Length scale  (P0) :716.690
   Variance  (P1) :0.766
+ Component: 3
   Covariance function : Constant
   Amplitude  (P0) :0.170
+ Component: 4
   Covariance function : White noise
   Variance  (P0) :0.007
Finding optimal parametersCycle 1   Error 101.037816  Scale 1.000000
Cycle 2   Error 99.255324  Scale 0.500000
Cycle 3   Error 99.087178  Scale 0.250000
Cycle 4   Error 98.048341  Scale 0.125000
Cycle 5   Error 98.003433  Scale 0.062500
Warning: Maximum number of iterations has been exceeded
Cycle 1   Error 97.968895  Scale 1.000000
Cycle 2   Error 97.507592  Scale 0.500000
Cycle 3   Error 97.495123  Scale 0.250000
Cycle 4   Error 97.495123  Scale 0.125000
Cycle 5   Error 97.167710  Scale 0.500000
Warning: Maximum number of iterations has been exceeded
Cycle 1   Error 97.139195  Scale 1.000000
Cycle 2   Error 97.044461  Scale 0.500000
Cycle 3   Error 97.035602  Scale 0.250000
Cycle 4   Error 97.023475  Scale 0.125000
Cycle 5   Error 97.021581  Scale 0.062500
Warning: Maximum number of iterations has been exceeded
> krigingObject = spatialPredict(krigingObject)
Make prediction
No noise model specified
Defaulting to GAUSSIAN with variance 0.00
Processing observation: 1/155Processing observation: 2/155Processing observation: 3/155Processing observation: 4/155Processing observation: 5/155Processing observation: 6/155Processing observation: 7/155Processing observation: 8/155Processing observation: 9/155Processing observation: 10/155Processing observation: 11/155Processing observation: 12/155Processing observation: 13/155Processing observation: 14/155Processing observation: 15/155Processing observation: 16/155Processing observation: 17/155Processing observation: 18/155Processing observation: 19/155Processing observation: 20/155Processing observation: 21/155Processing observation: 22/155Processing observation: 23/155Processing observation: 24/155Processing observation: 25/155Processing observation: 26/155Processing observation: 27/155Processing observation: 28/155Processing observation: 29/155Processing observation: 30/155Processing observation: 31/155Processing observation: 32/155Processing observation: 33/155Processing observation: 34/155Processing observation: 35/155Processing observation: 36/155Processing observation: 37/155Processing observation: 38/155Processing observation: 39/155Processing observation: 40/155Processing observation: 41/155Processing observation: 42/155Processing observation: 43/155Processing observation: 44/155Processing observation: 45/155Processing observation: 46/155Processing observation: 47/155Processing observation: 48/155Processing observation: 49/155Processing observation: 50/155Processing observation: 51/155Processing observation: 52/155Processing observation: 53/155Processing observation: 54/155Processing observation: 55/155Processing observation: 56/155Processing observation: 57/155Processing observation: 58/155Processing observation: 59/155Processing observation: 60/155Processing observation: 61/155Processing observation: 62/155Processing observation: 63/155Processing observation: 64/155Processing observation: 65/155Processing observation: 66/155Processing observation: 67/155Processing observation: 68/155Processing observation: 69/155Processing observation: 70/155Processing observation: 71/155Processing observation: 72/155Processing observation: 73/155Processing observation: 74/155Processing observation: 75/155Processing observation: 76/155Processing observation: 77/155Processing observation: 78/155Processing observation: 79/155Processing observation: 80/155Processing observation: 81/155Processing observation: 82/155Processing observation: 83/155Processing observation: 84/155Processing observation: 85/155Processing observation: 86/155Processing observation: 87/155Processing observation: 88/155Processing observation: 89/155Processing observation: 90/155Processing observation: 91/155Processing observation: 92/155Processing observation: 93/155Processing observation: 94/155Processing observation: 95/155Processing observation: 96/155Processing observation: 97/155Processing observation: 98/155Processing observation: 99/155Processing observation: 100/155Processing observation: 101/155Processing observation: 102/155Processing observation: 103/155Processing observation: 104/155Processing observation: 105/155Processing observation: 106/155Processing observation: 107/155Processing observation: 108/155Processing observation: 109/155Processing observation: 110/155Processing observation: 111/155Processing observation: 112/155Processing observation: 113/155Processing observation: 114/155Processing observation: 115/155Processing observation: 116/155Processing observation: 117/155Processing observation: 118/155Processing observation: 119/155Processing observation: 120/155Processing observation: 121/155Processing observation: 122/155Processing observation: 123/155Processing observation: 124/155Processing observation: 125/155Processing observation: 126/155Processing observation: 127/155Processing observation: 128/155Processing observation: 129/155Processing observation: 130/155Processing observation: 131/155Processing observation: 132/155Processing observation: 133/155Processing observation: 134/155Processing observation: 135/155Processing observation: 136/155Processing observation: 137/155Processing observation: 138/155Processing observation: 139/155Processing observation: 140/155Processing observation: 141/155Processing observation: 142/155Processing observation: 143/155Processing observation: 144/155Processing observation: 145/155Processing observation: 146/155Processing observation: 147/155Processing observation: 148/155Processing observation: 149/155Processing observation: 150/155Processing observation: 151/155Processing observation: 152/155Processing observation: 153/155Processing observation: 154/155Processing observation: 155/155Processing observation: 1/155Processing observation: 2/155Processing observation: 3/155Processing observation: 4/155Processing observation: 5/155Processing observation: 6/155Processing observation: 7/155Processing observation: 8/155Processing observation: 9/155Processing observation: 10/155Processing observation: 11/155Processing observation: 12/155Processing observation: 13/155Processing observation: 14/155Processing observation: 15/155Processing observation: 16/155Processing observation: 17/155Processing observation: 18/155Processing observation: 19/155Processing observation: 20/155Processing observation: 21/155Processing observation: 22/155Processing observation: 23/155Processing observation: 24/155Processing observation: 25/155Processing observation: 26/155Processing observation: 27/155Processing observation: 28/155Processing observation: 29/155Processing observation: 30/155Processing observation: 31/155Processing observation: 32/155Processing observation: 33/155Processing observation: 34/155Processing observation: 35/155Processing observation: 36/155Processing observation: 37/155Processing observation: 38/155Processing observation: 39/155Processing observation: 40/155Processing observation: 41/155Processing observation: 42/155Processing observation: 43/155Processing observation: 44/155Processing observation: 45/155Processing observation: 46/155Processing observation: 47/155Processing observation: 48/155Processing observation: 49/155Processing observation: 50/155Processing observation: 51/155Processing observation: 52/155Processing observation: 53/155Processing observation: 54/155Processing observation: 55/155Processing observation: 56/155Processing observation: 57/155Processing observation: 58/155Processing observation: 59/155Processing observation: 60/155Processing observation: 61/155Processing observation: 62/155Processing observation: 63/155Processing observation: 64/155Processing observation: 65/155Processing observation: 66/155Processing observation: 67/155Processing observation: 68/155Processing observation: 69/155Processing observation: 70/155Processing observation: 71/155Processing observation: 72/155Processing observation: 73/155Processing observation: 74/155Processing observation: 75/155Processing observation: 76/155Processing observation: 77/155Processing observation: 78/155Processing observation: 79/155Processing observation: 80/155Processing observation: 81/155Processing observation: 82/155Processing observation: 83/155Processing observation: 84/155Processing observation: 85/155Processing observation: 86/155Processing observation: 87/155Processing observation: 88/155Processing observation: 89/155Processing observation: 90/155Processing observation: 91/155Processing observation: 92/155Processing observation: 93/155Processing observation: 94/155Processing observation: 95/155Processing observation: 96/155Processing observation: 97/155Processing observation: 98/155Processing observation: 99/155Processing observation: 100/155Processing observation: 101/155Processing observation: 102/155Processing observation: 103/155Processing observation: 104/155Processing observation: 105/155Processing observation: 106/155Processing observation: 107/155Processing observation: 108/155Processing observation: 109/155Processing observation: 110/155Processing observation: 111/155Processing observation: 112/155Processing observation: 113/155Processing observation: 114/155Processing observation: 115/155Processing observation: 116/155Processing observation: 117/155Processing observation: 118/155Processing observation: 119/155Processing observation: 120/155Processing observation: 121/155Processing observation: 122/155Processing observation: 123/155Processing observation: 124/155Processing observation: 125/155Processing observation: 126/155Processing observation: 127/155Processing observation: 128/155Processing observation: 129/155Processing observation: 130/155Processing observation: 131/155Processing observation: 132/155Processing observation: 133/155Processing observation: 134/155Processing observation: 135/155Processing observation: 136/155Processing observation: 137/155Processing observation: 138/155Processing observation: 139/155Processing observation: 140/155Processing observation: 141/155Processing observation: 142/155Processing observation: 143/155Processing observation: 144/155Processing observation: 145/155Processing observation: 146/155Processing observation: 147/155Processing observation: 148/155Processing observation: 149/155Processing observation: 150/155Processing observation: 151/155Processing observation: 152/155Processing observation: 153/155Processing observation: 154/155Processing observation: 155/155  Predicting chunk [ 0:47 / 48 ]
Predict using PSGP
PSGP used the following parameters:Covariance function : Sum
+ Component: 1
   Covariance function : Isotropic Exponential
   Range  (P0) :853.589
   Variance  (P1) :1.070
+ Component: 2
   Covariance function : Matern 5/2 covariance function
   Length scale  (P0) :1307.069
   Variance  (P1) :0.881
+ Component: 3
   Covariance function : Constant
   Amplitude  (P0) :0.024
> krigingObject = postProcess(krigingObject)
> 
> # Send predictions back to Java. 
> summary(krigingObject$outputTable)
       x                y               mean          variance      
 Min.   :179019   Min.   :330013   Min.   :4.764   Min.   :0.03598  
 1st Qu.:179485   1st Qu.:330829   1st Qu.:5.308   1st Qu.:0.07071  
 Median :180183   Median :331644   Median :5.847   Median :0.25432  
 Mean   :180183   Mean   :331644   Mean   :6.257   Mean   :0.48075  
 3rd Qu.:180882   3rd Qu.:332459   3rd Qu.:7.478   3rd Qu.:0.69737  
 Max.   :181348   Max.   :333275   Max.   :8.178   Max.   :1.91163  
   excprob5.9         cumdistr5.9       quantile0.1   
 Min.   :0.0000083   Min.   :0.00000   Min.   :3.999  
 1st Qu.:0.0549899   1st Qu.:0.01972   1st Qu.:4.638  
 Median :0.4629025   Median :0.53710   Median :5.227  
 Mean   :0.5165062   Mean   :0.48349   Mean   :5.491  
 3rd Qu.:0.9802802   3rd Qu.:0.94501   3rd Qu.:6.480  
 Max.   :1.0000000   Max.   :0.99999   Max.   :7.298  
> summary(krigingObject$observations)
Object of class SpatialPointsDataFrame
Coordinates:
     min    max
x 178605 181390
y 329714 333611
Is projected: NA 
proj4string : [NA]
Number of points: 155
Data attributes:
     value      
 Min.   :4.727  
 1st Qu.:5.288  
 Median :5.787  
 Mean   :5.886  
 3rd Qu.:6.514  
 Max.   :7.517  
> summary(autoKrige(value~1,krigingObject$observations,predictionLocations)$krige_output)
[using ordinary kriging]
Object of class SpatialPointsDataFrame
Coordinates:
        min      max
x1 179018.6 181348.1
x2 330013.4 333274.7
Is projected: NA 
proj4string : [NA]
Number of points: 48
Data attributes:
   var1.pred        var1.var        var1.stdev    
 Min.   :4.929   Min.   :0.1153   Min.   :0.3395  
 1st Qu.:5.518   1st Qu.:0.1615   1st Qu.:0.4018  
 Median :6.047   Median :0.3582   Median :0.5963  
 Mean   :5.978   Mean   :0.3827   Mean   :0.5909  
 3rd Qu.:6.337   3rd Qu.:0.6026   3rd Qu.:0.7762  
 Max.   :7.472   Max.   :0.6752   Max.   :0.8217  
> autofitVariogram(value~1,krigingObject$observations)$var_model
  model      psill    range
1   Nug 0.04848089   0.0000
2   Sph 0.58754741 889.9084
> 
> proc.time()
   user  system elapsed 
  3.484   1.494   1.915 
