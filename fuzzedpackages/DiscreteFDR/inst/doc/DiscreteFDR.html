<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Introduction to DiscreteFDR</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to DiscreteFDR</h1>



<p>Multiple testing procedures are important tools for identifying statistically significant findings in massive and complex data while controlling a specific error rate. An important focus has been given to methods controlling the false discovery rate (FDR), i.e., the expected proportion of falsely rejected hypotheses among all rejected hypotheses, which has become the standard error rate for high dimensional data analysis. Since the original procedure of <a href="https://doi.org/10.1111/j.2517-6161.1995.tb02031.x">Benjamini and Hochberg (1995)</a>, much effort has been undertaken to design FDR controlling procedures that adapt to various underlying structures of the data, such as the quantity of signal, the signal strength and the dependencies, among others.</p>
<p>The <strong>R</strong> package <strong>DiscreteFDR</strong>, presented in this paper, deals with adaptation to discrete and non-identically distributed test statics by implementing procedures developed by <a href="https://doi.org/10.1214/18-EJS1441">Döhler, Durand and Roquain (2018)</a> (in the sequel abbreviated as <a href="https://doi.org/10.1214/18-EJS1441">[DDR]</a>). This type of data arises in many relevant applications, in particular when data represent frequencies or counts. Examples can be found in clinical studies (see e.g., <a href="https://doi.org/10.1080/00031305.1997.10473577">Westfall and Wolfinger (1997)</a>), genome-wide association studies (GWAS) (see e.g., <a href="https://www.degruyter.com/view/j/sagmb.2012.11.issue-4/1544-6115.1776/1544-6115.1776.xml">Dickhaus, Straßburger et al. (2012)</a>) and next generation sequencing data (NGS) (see e.g., <a href="https://arxiv.org/abs/1502.00973">Doerge and Chen (2015)</a>}).</p>
<hr />
<div id="a-toy-example" class="section level1">
<h1>1. A Toy example</h1>
<p>To give a first impression of how <strong>DiscreteFDR</strong> works, we consider an artificial toy example. A more realistic example involving pharmacovigilance data is given in Section 2.</p>
<p>Suppose we would like to compare two treatments in nine different populations. For each population we do this by evaluating the responders and non-responders for each treatment. This leads to categorical data which can be represented, for each population <span class="math inline">\(i = 1, \ldots, 9\)</span> in the following 2 <span class="math inline">\(\times\)</span> 2 table:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Responders</th>
<th align="center">Non-responders</th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Treatment 1</td>
<td align="center"><span class="math inline">\(x_{1i}\)</span></td>
<td align="center"><span class="math inline">\(y_{1i}\)</span></td>
<td align="center"><span class="math inline">\(n_{1i}\)</span></td>
</tr>
<tr class="even">
<td align="left">Treatment 2</td>
<td align="center"><span class="math inline">\(x_{2i}\)</span></td>
<td align="center"><span class="math inline">\(y_{2i}\)</span></td>
<td align="center"><span class="math inline">\(n_{2i}\)</span></td>
</tr>
<tr class="odd">
<td align="left"><strong>Total</strong></td>
<td align="center"><span class="math inline">\(x_{1i} + x_{2i}\)</span></td>
<td align="center"><span class="math inline">\(y_{1i} + y_{2i}\)</span></td>
<td align="center"><span class="math inline">\(n = n_{1i} + n_{2i}\)</span></td>
</tr>
</tbody>
</table>
<p>Denoting the responder probabilities for population <span class="math inline">\(i\)</span> by <span class="math inline">\(\pi_{1i}\)</span> and <span class="math inline">\(\pi_{2i}\)</span> we can test e.g.</p>
<p><span class="math display">\[H_{0i}: \pi_{1i} = \pi_{2i} \qquad \text{vs.} \qquad H_{1i}: \pi_{1i} \neq \pi_{2i}\]</span></p>
<p>by using Fisher’s (two-sided) exact test (see <a href="https://doi.org/10.1214/009053605000000084">Lehmann and Romano (2006)</a>), which is implemented in the <strong>R</strong> function <code>fisher.test</code>. Suppose the data in the nine populations are independent and we observe the following data frame <code>df</code></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">library</span>(knitr)</a>
<a class="sourceLine" id="cb1-2" title="2">X1 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">14</span>, <span class="dv">6</span>, <span class="dv">9</span>, <span class="dv">4</span>, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb1-3" title="3">X2 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb1-4" title="4">N1 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">148</span>, <span class="dv">9</span>)</a>
<a class="sourceLine" id="cb1-5" title="5">N2 &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">132</span>, <span class="dv">9</span>)</a>
<a class="sourceLine" id="cb1-6" title="6">Y1 &lt;-<span class="st"> </span>N1 <span class="op">-</span><span class="st"> </span>X1</a>
<a class="sourceLine" id="cb1-7" title="7">Y2 &lt;-<span class="st"> </span>N2 <span class="op">-</span><span class="st"> </span>X2</a>
<a class="sourceLine" id="cb1-8" title="8">df &lt;-<span class="st"> </span><span class="kw">data.frame</span>(X1, Y1, X2, Y2)</a>
<a class="sourceLine" id="cb1-9" title="9"><span class="kw">kable</span>(df, <span class="dt">caption =</span> <span class="st">&quot;Toy Example&quot;</span>)</a></code></pre></div>
<table>
<caption>Toy Example</caption>
<thead>
<tr class="header">
<th align="right">X1</th>
<th align="right">Y1</th>
<th align="right">X2</th>
<th align="right">Y2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">4</td>
<td align="right">144</td>
<td align="right">0</td>
<td align="right">132</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">146</td>
<td align="right">0</td>
<td align="right">132</td>
</tr>
<tr class="odd">
<td align="right">2</td>
<td align="right">146</td>
<td align="right">1</td>
<td align="right">131</td>
</tr>
<tr class="even">
<td align="right">14</td>
<td align="right">134</td>
<td align="right">3</td>
<td align="right">129</td>
</tr>
<tr class="odd">
<td align="right">6</td>
<td align="right">142</td>
<td align="right">2</td>
<td align="right">130</td>
</tr>
<tr class="even">
<td align="right">9</td>
<td align="right">139</td>
<td align="right">1</td>
<td align="right">131</td>
</tr>
<tr class="odd">
<td align="right">4</td>
<td align="right">144</td>
<td align="right">2</td>
<td align="right">130</td>
</tr>
<tr class="even">
<td align="right">0</td>
<td align="right">148</td>
<td align="right">2</td>
<td align="right">130</td>
</tr>
<tr class="odd">
<td align="right">1</td>
<td align="right">147</td>
<td align="right">2</td>
<td align="right">130</td>
</tr>
</tbody>
</table>
<p>In this data frame each of the 9 rows represents the data of an observed 2 <span class="math inline">\(\times\)</span> 2 table: e.g., the third row of the data corresponds to <span class="math inline">\(x_{13} = 2, y_{13} = 146, x_{23} = 1, y_{23} = 131\)</span>. Even though in this example, the total number of tested hypotheses <span class="math inline">\(m = 9\)</span> is very small, for illustrative purposes we deal with the multiplicity problem here by controlling FDR at level <span class="math inline">\(\alpha = 5\%\)</span>. The DBH step-down procedure can be applied directly to the data frame object <code>df</code> and yields an S3 object of class <code>DiscreteFDR</code>, for which we provide both <code>print</code> and <code>summary</code> methods:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw">library</span>(<span class="st">&quot;DiscreteFDR&quot;</span>)</a>
<a class="sourceLine" id="cb2-2" title="2">DBH.sd.fast &lt;-<span class="st"> </span><span class="kw">fast.Discrete</span>(df, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>, <span class="dt">direction =</span> <span class="st">&quot;sd&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw">print</span>(DBH.sd.fast)</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co">#&gt;   Discrete Benjamini-Hochberg procedure (step-down) </span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co">#&gt; data:  df </span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co">#&gt; number of tests = 9 </span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#&gt; number of rejections = 2 at global FDR level 0.05 </span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co">#&gt; (Original BH rejections = 0)</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co">#&gt; largest rejected p value:  0.02126871</span></a>
<a class="sourceLine" id="cb2-12" title="12"></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="kw">summary</span>(DBH.sd.fast)</a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co">#&gt;   Discrete Benjamini-Hochberg procedure (step-down) </span></a>
<a class="sourceLine" id="cb2-16" title="16"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-17" title="17"><span class="co">#&gt; data:  df </span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="co">#&gt; number of tests = 9 </span></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="co">#&gt; number of rejections = 2 at global FDR level 0.05 </span></a>
<a class="sourceLine" id="cb2-20" title="20"><span class="co">#&gt; (Original BH rejections = 0)</span></a>
<a class="sourceLine" id="cb2-21" title="21"><span class="co">#&gt; largest rejected p value:  0.02126871 </span></a>
<a class="sourceLine" id="cb2-22" title="22"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb2-23" title="23"><span class="co">#&gt;   Index    P.value   Adjusted Rejected</span></a>
<a class="sourceLine" id="cb2-24" title="24"><span class="co">#&gt; 1     4 0.01243145 0.03819796     TRUE</span></a>
<a class="sourceLine" id="cb2-25" title="25"><span class="co">#&gt; 2     6 0.02126871 0.03819796     TRUE</span></a>
<a class="sourceLine" id="cb2-26" title="26"><span class="co">#&gt; 3     1 0.12476691 0.25630985    FALSE</span></a>
<a class="sourceLine" id="cb2-27" title="27"><span class="co">#&gt; 4     8 0.22135177 0.47895996    FALSE</span></a>
<a class="sourceLine" id="cb2-28" title="28"><span class="co">#&gt; 5     5 0.28849298 0.51482782    FALSE</span></a>
<a class="sourceLine" id="cb2-29" title="29"><span class="co">#&gt; 6     2 0.49984639 1.00000000    FALSE</span></a>
<a class="sourceLine" id="cb2-30" title="30"><span class="co">#&gt; 7     9 0.60329543 1.00000000    FALSE</span></a>
<a class="sourceLine" id="cb2-31" title="31"><span class="co">#&gt; 8     7 0.68723229 1.00000000    FALSE</span></a>
<a class="sourceLine" id="cb2-32" title="32"><span class="co">#&gt; 9     3 1.00000000 1.00000000    FALSE</span></a></code></pre></div>
<p>The output of the <code>summary</code> function contains the same output as the <code>print</code> method, but adds a table that lists the raw <span class="math inline">\(p\)</span>-values, their adjusted counterparts and their respective rejection decision. It is sorted by raw <span class="math inline">\(p\)</span>-values in ascending order. Our <code>summary</code> method actually creates a <code>summary.DiscreteFDR</code> object, which includes all contents of an <code>DiscreteFDR</code> object plus the aforementioned table. This table can be accessed directly by the <code>$Table</code> command.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">DBH.sd.fast.summary &lt;-<span class="st"> </span><span class="kw">summary</span>(DBH.sd.fast)</a>
<a class="sourceLine" id="cb3-2" title="2">DBH.sd.fast.summary<span class="op">$</span>Table</a>
<a class="sourceLine" id="cb3-3" title="3"><span class="co">#&gt;   Index    P.value   Adjusted Rejected</span></a>
<a class="sourceLine" id="cb3-4" title="4"><span class="co">#&gt; 1     4 0.01243145 0.03819796     TRUE</span></a>
<a class="sourceLine" id="cb3-5" title="5"><span class="co">#&gt; 2     6 0.02126871 0.03819796     TRUE</span></a>
<a class="sourceLine" id="cb3-6" title="6"><span class="co">#&gt; 3     1 0.12476691 0.25630985    FALSE</span></a>
<a class="sourceLine" id="cb3-7" title="7"><span class="co">#&gt; 4     8 0.22135177 0.47895996    FALSE</span></a>
<a class="sourceLine" id="cb3-8" title="8"><span class="co">#&gt; 5     5 0.28849298 0.51482782    FALSE</span></a>
<a class="sourceLine" id="cb3-9" title="9"><span class="co">#&gt; 6     2 0.49984639 1.00000000    FALSE</span></a>
<a class="sourceLine" id="cb3-10" title="10"><span class="co">#&gt; 7     9 0.60329543 1.00000000    FALSE</span></a>
<a class="sourceLine" id="cb3-11" title="11"><span class="co">#&gt; 8     7 0.68723229 1.00000000    FALSE</span></a>
<a class="sourceLine" id="cb3-12" title="12"><span class="co">#&gt; 9     3 1.00000000 1.00000000    FALSE</span></a></code></pre></div>
<p>Thus we can reject two hypotheses at FDR-level <span class="math inline">\(\alpha = 5\%\)</span>. Note, that our <code>print</code> method also gives the number of rejections of the usual (continuous) BH procedure. In order to compare its adjusted <span class="math inline">\(p\)</span>-values with ours, we have to determine the raw <span class="math inline">\(p\)</span>~values first. This would be possible by applying the <code>fisher.test</code> function to all nine 2 <span class="math inline">\(\times\)</span> 2 tables. Alternatively, we may use the more convenient function <code>fisher.pvalues.support</code> included in our package for accessing the raw <span class="math inline">\(p\)</span>-values. An even more simple way is to extract them from an object that contains the results:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">p &lt;-<span class="st"> </span><span class="kw">fisher.pvalues.support</span>(df, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">raw.pvalues &lt;-<span class="st"> </span>p<span class="op">$</span>raw</a>
<a class="sourceLine" id="cb4-3" title="3"></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co"># or:</span></a>
<a class="sourceLine" id="cb4-5" title="5">raw.pvalues2 &lt;-<span class="st"> </span>DBH.sd.fast<span class="op">$</span>Data<span class="op">$</span>raw.pvalues</a>
<a class="sourceLine" id="cb4-6" title="6"></a>
<a class="sourceLine" id="cb4-7" title="7"><span class="kw">all</span>(raw.pvalues <span class="op">==</span><span class="st"> </span>raw.pvalues2)</a>
<a class="sourceLine" id="cb4-8" title="8"><span class="co">#&gt; [1] TRUE</span></a>
<a class="sourceLine" id="cb4-9" title="9"></a>
<a class="sourceLine" id="cb4-10" title="10"><span class="kw">p.adjust</span>(raw.pvalues, <span class="dt">method =</span> <span class="st">&quot;BH&quot;</span>)</a>
<a class="sourceLine" id="cb4-11" title="11"><span class="co">#&gt; [1] 0.37430072 0.74976959 1.00000000 0.09570921 0.51928737 0.09570921 0.77313633</span></a>
<a class="sourceLine" id="cb4-12" title="12"><span class="co">#&gt; [8] 0.49804147 0.77313633</span></a></code></pre></div>
<p>Applying the continuous BH procedure from the <strong>stats</strong> package in the last line of code, we find that we can not reject any hypotheses at FDR-level <span class="math inline">\(\alpha = 5\%\)</span>. Another approach of determining this is to compare the critical values of the discrete and continuous BH procedures. In the discrete case, we need the observed <span class="math inline">\(p\)</span>-values their distributions. Both were computed by our <code>fisher.pvalues.support</code> function above.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">p &lt;-<span class="st"> </span><span class="kw">fisher.pvalues.support</span>(df, <span class="dt">alternative =</span> <span class="st">&quot;two.sided&quot;</span>)</a>
<a class="sourceLine" id="cb5-2" title="2">raw.pvalues &lt;-<span class="st"> </span>p<span class="op">$</span>raw</a>
<a class="sourceLine" id="cb5-3" title="3">pCDFlist &lt;-<span class="st"> </span>p<span class="op">$</span>support</a>
<a class="sourceLine" id="cb5-4" title="4"></a>
<a class="sourceLine" id="cb5-5" title="5">DBH.sd.crit &lt;-<span class="st"> </span><span class="kw">DBH</span>(raw.pvalues, pCDFlist, <span class="fl">0.05</span>, <span class="st">&quot;sd&quot;</span>, <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb5-6" title="6">crit.vals.BH.disc &lt;-<span class="st"> </span>DBH.sd.crit<span class="op">$</span>Critical.values</a>
<a class="sourceLine" id="cb5-7" title="7">crit.vals.BH.cont &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="fl">0.05</span><span class="op">/</span><span class="dv">9</span></a>
<a class="sourceLine" id="cb5-8" title="8"><span class="kw">cbind</span>(<span class="kw">sort</span>(raw.pvalues), crit.vals.BH.disc, crit.vals.BH.cont)</a>
<a class="sourceLine" id="cb5-9" title="9"><span class="co">#&gt;                  crit.vals.BH.disc crit.vals.BH.cont</span></a>
<a class="sourceLine" id="cb5-10" title="10"><span class="co">#&gt;  [1,] 0.01243145        0.01243145       0.005555556</span></a>
<a class="sourceLine" id="cb5-11" title="11"><span class="co">#&gt;  [2,] 0.02126871        0.02832448       0.011111111</span></a>
<a class="sourceLine" id="cb5-12" title="12"><span class="co">#&gt;  [3,] 0.12476691        0.03109596       0.016666667</span></a>
<a class="sourceLine" id="cb5-13" title="13"><span class="co">#&gt;  [4,] 0.22135177        0.04839433       0.022222222</span></a>
<a class="sourceLine" id="cb5-14" title="14"><span class="co">#&gt;  [5,] 0.28849298        0.05014119       0.027777778</span></a>
<a class="sourceLine" id="cb5-15" title="15"><span class="co">#&gt;  [6,] 0.49984639        0.07657062       0.033333333</span></a>
<a class="sourceLine" id="cb5-16" title="16"><span class="co">#&gt;  [7,] 0.60329543        0.07657062       0.038888889</span></a>
<a class="sourceLine" id="cb5-17" title="17"><span class="co">#&gt;  [8,] 0.68723229        0.10328523       0.044444444</span></a>
<a class="sourceLine" id="cb5-18" title="18"><span class="co">#&gt;  [9,] 1.00000000        0.10328523       0.050000000</span></a></code></pre></div>
<p>Obviously, the critical values of the discrete approach are considerably larger than those of the continuous method. As a result, the two smallest <span class="math inline">\(p\)</span>-values are rejected by the discrete BH procedure, because they are smaller than or equal to the respective critical values. The continuous BH approach does not reject any hypothesis, because all its critical values are smaller than the observed <span class="math inline">\(p\)</span>-values.</p>
<p>For illustration, our package includes a <code>plot</code> method for <code>DiscreteFDR</code> S3 class objects. It allows to define colors, line types and point characters separately for accepted and rejected <span class="math inline">\(p\)</span>-values and for critical values (if present in the object).</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1"><span class="kw">plot</span>(DBH.sd.crit, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">19</span>), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">type.crit =</span> <span class="st">&#39;o&#39;</span>,</a>
<a class="sourceLine" id="cb6-2" title="2">     <span class="dt">legend =</span> <span class="st">&quot;topleft&quot;</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Now, it is visible which observed <span class="math inline">\(p\)</span>-values are rejected. A comparison with the continuous BH procedure could be done as follows:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">plot</span>(DBH.sd.crit, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>), <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">19</span>), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">type.crit =</span> <span class="st">&#39;o&#39;</span>,</a>
<a class="sourceLine" id="cb7-2" title="2">     <span class="dt">cex =</span> <span class="fl">1.3</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>), <span class="dt">main =</span> <span class="st">&quot;Comparison of discrete and continuous BH procedures&quot;</span>)</a>
<a class="sourceLine" id="cb7-3" title="3"><span class="kw">points</span>(crit.vals.BH.cont, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb7-4" title="4"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="kw">c</span>(<span class="st">&quot;Rejected&quot;</span>, <span class="st">&quot;Accepted&quot;</span>, <span class="st">&quot;Critical Values (disc.)&quot;</span>, <span class="st">&quot;Critical Values (cont.)&quot;</span>),</a>
<a class="sourceLine" id="cb7-5" title="5">       <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;blue&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;black&quot;</span>), <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">2</span>, <span class="dv">19</span>, <span class="dv">19</span>), <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">lty =</span> <span class="dv">0</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>As this example illustrates, the discrete approach can potentially yield a large increase in power. The gain depends on the involved distribution functions and the raw <span class="math inline">\(p\)</span>-values. To appreciate where this comes from, it is instructive to consider the distribution functions <span class="math inline">\(F_1, \ldots, F_9\)</span> of the <span class="math inline">\(p\)</span>-values under the null in more detail. Take for instance the first 2 <span class="math inline">\(\times\)</span> 2 table:</p>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="center">Responders</th>
<th align="center">Non-responders</th>
<th align="center"></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Treatment 1</td>
<td align="center">4</td>
<td align="center">144</td>
<td align="center">148</td>
</tr>
<tr class="even">
<td align="left">Treatment 2</td>
<td align="center">0</td>
<td align="center">132</td>
<td align="center">132</td>
</tr>
<tr class="odd">
<td align="left"><strong>Total</strong></td>
<td align="center">4</td>
<td align="center">276</td>
<td align="center">280</td>
</tr>
</tbody>
</table>
<p>Fisher’s exact test works by determining the probability of observing this (or a more ‘extreme’) table, given that the margins are fixed. So each <span class="math inline">\(F_i\)</span> is determined by the margins of table <span class="math inline">\(i\)</span>. Since <span class="math inline">\(x_{11} + x_{21} = 4\)</span>, the only potentially observable tables are given by <span class="math inline">\(x_{11} = 0, \ldots, 4\)</span>. For each one of these 5 values a <span class="math inline">\(p\)</span>-value can be determined using the hypergeometric distribution. Therefore, the <span class="math inline">\(p\)</span>-value of any 2 <span class="math inline">\(\times\)</span> 2 table with margins given by the above table can take (at most) 5 distinct values, say <span class="math inline">\(x_1, \ldots, x_5\)</span>. Combining these 5 values into a set, we obtain the <em>support</em> <span class="math inline">\(\mathcal{A}_1 = \{x_1, \ldots, x_5\}\)</span> of distribution <span class="math inline">\(F_1\)</span>. Now we can continue in this vein for the remaining 2 <span class="math inline">\(\times\)</span> 2 tables to obtain the supports <span class="math inline">\(\mathcal{A}_1, \ldots, \mathcal{A}_9\)</span> for the distribution functions <span class="math inline">\(F_1, \ldots, F_{9}\)</span>. The supports can be accessed via the <code>$support</code> command, e.g.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">p<span class="op">$</span>support[<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>)]</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co">#&gt; [[1]]</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="co">#&gt; [1] 0.04820493 0.12476691 0.34598645 0.62477763 1.00000000</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="co">#&gt; [[2]]</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co">#&gt; [1] 0.002173856 0.007733719 0.028324482 0.069964309 0.154043258 0.288492981</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="co">#&gt; [7] 0.481808361 0.726262402 1.000000000</span></a></code></pre></div>
<p>returns <span class="math inline">\(\mathcal{A}_1\)</span> and <span class="math inline">\(\mathcal{A}_5\)</span>. Panel (a) in the following figure shows a graph of the distribution functions <span class="math inline">\(F_1, \ldots, F_9\)</span>. Each <span class="math inline">\(F_i\)</span> is a step-function with <span class="math inline">\(F_i(0) = 0\)</span>, the jumps occurring only on the support <span class="math inline">\(\mathcal{A}_i\)</span> and <span class="math inline">\(F_i(x) = x\)</span> only for <span class="math inline">\(x \in \mathcal{A}_i\)</span>. In particular, all distributions are stochastically larger than the uniform distribution (i.e., <span class="math inline">\(F_i(x) \le x\)</span>), but in a heterogeneous manner. This heterogeneity can be exploited e.g., by transforming the raw <span class="math inline">\(p\)</span>-values from the exact Fisher’s test using the function <span class="math display">\[\displaystyle \xi_{\text{SD}}(x) = \sum_{i = 1}^{9} \frac{F_i(x)}{1 - F_i(x)}.\]</span> Panel (b) shows that <span class="math inline">\(\xi_{\text{SD}}\)</span> is a step function. Its jumps occur on the joint support <span class="math inline">\(\mathcal{A}= \mathcal{A}_1 \cup \ldots \cup \mathcal{A}_9\)</span>. Panel (b) also shows that <span class="math inline">\(\displaystyle \xi_{\text{SD}}(x) \ll x\)</span>, at least for small values of <span class="math inline">\(x\)</span>. It turns out that the critical values of our new DBH step-down procedure are essentially given by inverting <span class="math inline">\(\xi_{\text{SD}}\)</span> at the critical values of the [BH] procedure <span class="math inline">\(1 \cdot \alpha / 9, 2 \cdot \alpha / 9, \ldots, \alpha\)</span>, so that these values are considerably larger than the [BH] critical values. This is illustrated in panel (c) along with the ordered <span class="math inline">\(p\)</span>~values. In particular, all asterisks are located above the green [BH] dots, therefore this procedure can not reject any hypothesis. In contrast, the two smallest <span class="math inline">\(p\)</span>~values are located below red DBH step-down dots, so that this procedure rejects two hypotheses as we had already seen earlier.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">pCDFlist &lt;-<span class="st"> </span>p<span class="op">$</span>support</a>
<a class="sourceLine" id="cb9-2" title="2">stepf &lt;-<span class="st"> </span><span class="kw">lapply</span>(pCDFlist, <span class="cf">function</span>(x) <span class="kw">stepfun</span>(x, <span class="kw">c</span>(<span class="dv">0</span>, x)))</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw">par</span>(<span class="dt">mfcol =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">mai =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>))</a>
<a class="sourceLine" id="cb9-4" title="4"><span class="kw">plot</span>(stepf[[<span class="dv">1</span>]], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="dt">do.points =</span> <span class="ot">FALSE</span>, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">ylab =</span> <span class="st">&quot;F(x)&quot;</span>, </a>
<a class="sourceLine" id="cb9-5" title="5">     <span class="dt">main =</span> <span class="st">&quot;(a)&quot;</span>)</a>
<a class="sourceLine" id="cb9-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> (<span class="dv">2</span><span class="op">:</span><span class="dv">9</span>)){</a>
<a class="sourceLine" id="cb9-7" title="7">  <span class="kw">plot</span>(stepf[[i]], <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">do.points =</span> <span class="ot">FALSE</span>, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">col =</span> i)</a>
<a class="sourceLine" id="cb9-8" title="8">}</a>
<a class="sourceLine" id="cb9-9" title="9"><span class="kw">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-10" title="10"></a>
<a class="sourceLine" id="cb9-11" title="11"><span class="co">#   Plot xi</span></a>
<a class="sourceLine" id="cb9-12" title="12">support &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">unlist</span>(pCDFlist)))</a>
<a class="sourceLine" id="cb9-13" title="13">components &lt;-<span class="st"> </span><span class="kw">lapply</span>(stepf, <span class="cf">function</span>(s){<span class="kw">s</span>(support) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">s</span>(support))}) </a>
<a class="sourceLine" id="cb9-14" title="14">xi.values &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="kw">Reduce</span>(<span class="st">&#39;+&#39;</span>, components)</a>
<a class="sourceLine" id="cb9-15" title="15">xi &lt;-<span class="st"> </span><span class="kw">stepfun</span>(support, <span class="kw">c</span>(<span class="dv">0</span>, xi.values))</a>
<a class="sourceLine" id="cb9-16" title="16"><span class="kw">plot</span>(xi, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.10</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.10</span>), <span class="dt">do.points =</span> <span class="ot">FALSE</span>, <span class="dt">ylab =</span> <span class="kw">expression</span>(xi), <span class="dt">main =</span> <span class="st">&quot;(b)&quot;</span>)</a>
<a class="sourceLine" id="cb9-17" title="17"><span class="kw">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb9-18" title="18"></a>
<a class="sourceLine" id="cb9-19" title="19"><span class="co">#   Plot discrete critical values as well a BH constants and raw p-values</span></a>
<a class="sourceLine" id="cb9-20" title="20">DBH.sd &lt;-<span class="st"> </span><span class="kw">DBH</span>(raw.pvalues, pCDFlist, <span class="dt">direction =</span> <span class="st">&quot;sd&quot;</span>, <span class="dt">ret.crit.consts =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb9-21" title="21"><span class="kw">plot</span>(DBH.sd, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">19</span>), <span class="dt">type.crit =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>),</a>
<a class="sourceLine" id="cb9-22" title="22">     <span class="dt">cex =</span> <span class="fl">1.3</span>, <span class="dt">main =</span> <span class="st">&quot;(c)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Critical Values&quot;</span>)</a>
<a class="sourceLine" id="cb9-23" title="23"><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="fl">0.05</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>) <span class="op">/</span><span class="st"> </span><span class="dv">9</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>)</a>
<a class="sourceLine" id="cb9-24" title="24"></a>
<a class="sourceLine" id="cb9-25" title="25"><span class="kw">mtext</span>(<span class="st">&quot;Figure 1&quot;</span>, <span class="dv">1</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">line =</span> <span class="dv">-2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /> Panel (a) depicts the distribution functions <span class="math inline">\(F_1, \ldots, F_9\)</span> in various colors, (b) is a graph of the transformation <span class="math inline">\(\xi_{\text{SD}}\)</span>. The uniform distribution function is shown in light grey in (a) and (b). Panel (c) shows the [BH] critical values (green dots), the DBH step-down critical values (red dots) and the sorted raw <span class="math inline">\(p\)</span>-values (asterisks).</p>
<hr />
</div>
<div id="further-analyses" class="section level1">
<h1>2. Further Analyses</h1>
<div id="analysis-of-pharmacovigilance-data" class="section level2">
<h2>2.1. Analysis of Pharmacovigilance Data</h2>
<p>To illustrate how the procedures in <strong>DiscreteFDR</strong> can be used for real data, we revisit the analysis of the pharmacovigilance data from <a href="https://arxiv.org/abs/1112.4627v2">Heller and Gur (2011)</a> performed in <a href="https://doi.org/10.1214/18-EJS1441">[DDR]</a>. This data set is obtained from a database for reporting, investigating and monitoring adverse drug reactions due to the Medicines and Healthcare products Regulatory Agency in the United Kingdom. It contains the number of reported cases of amnesia as well as the total number of adverse events reported for each of the <span class="math inline">\(m = 2446\)</span> drugs in the database. For more details we refer to <a href="https://arxiv.org/abs/1112.4627v2">Heller and Gur (2011)</a> and to the accompanying R-package <strong>discreteMTP</strong> (<a href="https://CRAN.R-project.org/package=discreteMTP">Heller et al. (2012)</a>), which also contains the data. <a href="https://arxiv.org/abs/1112.4627v2">Heller and Gur (2011)</a> investigate the association between reports of amnesia and suspected drugs by performing for each drug a Fisher’s exact test (one-sided) for testing association between the drug and amnesia while adjusting for multiplicity by using several (discrete) FDR procedures. In what follows we present code that reproduces parts of Figure 2 and Table 1 in <a href="https://doi.org/10.1214/18-EJS1441">[DDR]</a>.</p>
<p>We proceed as in the example in Section 1. Since we need to access the critical values, we first determine the <span class="math inline">\(p\)</span>-values and their support for the data set <code>amnesia</code> contained for convenience in the package <strong>DiscreteFDR</strong>. For this, we use the option <code>&quot;HG2011&quot;</code> in the function <code>fisher.pvalues.support</code>.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">data</span>(amnesia)</a>
<a class="sourceLine" id="cb10-2" title="2">amnesia.formatted &lt;-<span class="st"> </span><span class="kw">fisher.pvalues.support</span>(amnesia[, <span class="dv">2</span><span class="op">:</span><span class="dv">3</span>], <span class="dt">input =</span> <span class="st">&quot;HG2011&quot;</span>)</a>
<a class="sourceLine" id="cb10-3" title="3">raw.pvalues &lt;-<span class="st"> </span>amnesia.formatted<span class="op">$</span>raw</a>
<a class="sourceLine" id="cb10-4" title="4">pCDFlist &lt;-<span class="st"> </span>amnesia.formatted<span class="op">$</span>support</a></code></pre></div>
<p>Then we perform the FDR analysis with functions <code>DBH</code> and <code>ADBH</code> (SU and SD) and <code>DBR</code> at level <span class="math inline">\(\alpha = 0.05\)</span> including critical values.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">DBH.su  &lt;-<span class="st">  </span><span class="kw">DBH</span>(raw.pvalues, pCDFlist, <span class="dt">ret.crit.consts =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-2" title="2">DBH.sd  &lt;-<span class="st">  </span><span class="kw">DBH</span>(raw.pvalues, pCDFlist, <span class="dt">direction =</span> <span class="st">&quot;sd&quot;</span>, <span class="dt">ret.crit.consts =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-3" title="3">ADBH.su &lt;-<span class="st"> </span><span class="kw">ADBH</span>(raw.pvalues, pCDFlist, <span class="dt">ret.crit.consts =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-4" title="4">ADBH.sd &lt;-<span class="st"> </span><span class="kw">ADBH</span>(raw.pvalues, pCDFlist, <span class="dt">direction =</span> <span class="st">&quot;sd&quot;</span>, <span class="dt">ret.crit.consts =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb11-5" title="5">DBR.su  &lt;-<span class="st">  </span><span class="kw">DBR</span>(raw.pvalues, pCDFlist, <span class="dt">ret.crit.consts =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>It is helpful to have a histogram of the observed <span class="math inline">\(p\)</span>-pvalues.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">hist</span>(DBH.sd)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>This histogram indicates a highly discrete <span class="math inline">\(p\)</span>~value distribution, which strongly suggests the use of discrete methods.</p>
<p>By accessing the critical values we can now generate a plot similar to Figure 2 from <a href="https://doi.org/10.1214/18-EJS1441">[DDR]</a>. Note that both [DBH-SU] and [DBH-SD] are visually indistinguishable from their adaptive counterparts.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">m &lt;-<span class="st"> </span><span class="kw">length</span>(raw.pvalues)</a>
<a class="sourceLine" id="cb13-2" title="2">crit.values.BH &lt;-<span class="st"> </span><span class="fl">0.05</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span>m) <span class="op">/</span><span class="st"> </span>m</a>
<a class="sourceLine" id="cb13-3" title="3">scale.points &lt;-<span class="st"> </span><span class="fl">0.7</span></a>
<a class="sourceLine" id="cb13-4" title="4"></a>
<a class="sourceLine" id="cb13-5" title="5"><span class="kw">plot</span>(DBH.su, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;orange&quot;</span>), <span class="dt">pch =</span> <span class="ot">NA</span>, <span class="dt">type.crit =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">100</span>),</a>
<a class="sourceLine" id="cb13-6" title="6">     <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, DBH.su<span class="op">$</span>Critical.values[<span class="dv">100</span>]), <span class="dt">ylab =</span> <span class="st">&quot;critical values&quot;</span>, <span class="dt">cex =</span> scale.points, <span class="dt">main =</span> <span class="st">&quot;&quot;</span>)</a>
<a class="sourceLine" id="cb13-7" title="7"></a>
<a class="sourceLine" id="cb13-8" title="8"><span class="kw">points</span>(crit.values.BH[<span class="dv">1</span><span class="op">:</span><span class="dv">105</span>],          <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>,  <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> scale.points)</a>
<a class="sourceLine" id="cb13-9" title="9"><span class="kw">points</span>(DBH.sd<span class="op">$</span>Critical.values[<span class="dv">1</span><span class="op">:</span><span class="dv">105</span>],  <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>,    <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> scale.points)</a>
<a class="sourceLine" id="cb13-10" title="10"><span class="kw">points</span>(ADBH.su<span class="op">$</span>Critical.values[<span class="dv">1</span><span class="op">:</span><span class="dv">105</span>], <span class="dt">col =</span> <span class="st">&quot;blue&quot;</span>,   <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> scale.points)</a>
<a class="sourceLine" id="cb13-11" title="11"><span class="kw">points</span>(ADBH.sd<span class="op">$</span>Critical.values[<span class="dv">1</span><span class="op">:</span><span class="dv">105</span>], <span class="dt">col =</span> <span class="st">&quot;purple&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> scale.points)</a>
<a class="sourceLine" id="cb13-12" title="12"><span class="kw">points</span>(DBR.su<span class="op">$</span>Critical.values[<span class="dv">1</span><span class="op">:</span><span class="dv">105</span>],  <span class="dt">col =</span> <span class="st">&quot;yellow&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> scale.points)</a>
<a class="sourceLine" id="cb13-13" title="13"><span class="kw">points</span>(<span class="kw">sort</span>(raw.pvalues),                              <span class="dt">pch =</span> <span class="dv">4</span>,  <span class="dt">cex =</span> scale.points)</a>
<a class="sourceLine" id="cb13-14" title="14"><span class="kw">mtext</span>(<span class="st">&quot;Figure 2&quot;</span>, <span class="dv">1</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">line =</span> <span class="dv">-1</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Critical values for [BH] (green dots), [DBH-SU] (orange dots), [DBH-SD] (red dots), [A-DBH-SU] (blue dots), [A-DBH-SD] (purple dots), [DBR] (yellow dots). The sorted raw <span class="math inline">\(p\)</span>-values are represented by asterisks.</p>
<p>The rejected hypotheses can be accessed via the command <code>$Indices</code>. The following code yields some of the values from Table 1 in <a href="https://doi.org/10.1214/18-EJS1441">[DDR]</a>:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">rej.BH &lt;-<span class="st"> </span><span class="kw">length</span>(<span class="kw">which</span>(<span class="kw">p.adjust</span>(raw.pvalues, <span class="dt">method =</span> <span class="st">&quot;BH&quot;</span>) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">0.05</span>))</a>
<a class="sourceLine" id="cb14-2" title="2">rej.DBH.su &lt;-<span class="st"> </span><span class="kw">length</span>(DBH.su<span class="op">$</span>Indices)</a>
<a class="sourceLine" id="cb14-3" title="3">rej.DBH.sd &lt;-<span class="st"> </span><span class="kw">length</span>(DBH.sd<span class="op">$</span>Indices)</a>
<a class="sourceLine" id="cb14-4" title="4">rej.ADBH.su &lt;-<span class="st"> </span><span class="kw">length</span>(ADBH.su<span class="op">$</span>Indices)</a>
<a class="sourceLine" id="cb14-5" title="5">rej.ADBH.sd &lt;-<span class="st"> </span><span class="kw">length</span>(ADBH.sd<span class="op">$</span>Indices)</a>
<a class="sourceLine" id="cb14-6" title="6">rej.DBR.su &lt;-<span class="st"> </span><span class="kw">length</span>(DBR.su<span class="op">$</span>Indices)</a>
<a class="sourceLine" id="cb14-7" title="7"><span class="kw">c</span>(rej.BH, rej.DBH.su, rej.DBH.sd, rej.ADBH.su, rej.ADBH.sd, rej.DBR.su)</a>
<a class="sourceLine" id="cb14-8" title="8"><span class="co">#&gt; [1] 24 27 27 27 27 27</span></a></code></pre></div>
<p>The (continuous) BH rejects only 24 hypotheses whereas all the discrete procedures implemented in <strong>DiscreteFDR</strong> are able to identify three additional drug candidates potentially associated with amnesia.</p>
</div>
<div id="other-types-of-discrete-tests" class="section level2">
<h2>2.2. Other Types of Discrete Tests</h2>
<p>In this section we sketch how  can be used to analyze arbitrary multiple discrete tests. <a href="https://doi.org/10.1002/bimj.201700284">Jiménez-Otero et al. (2018)</a> used <strong>DiscreteFDR</strong> to detect disorder in NGS experiments based on one-sample tests of the Poisson mean. Rather than reproducing their analysis in detail, we illustrate the general approach by using a toy example similar to the one in Section 1 and show how the test of the Poisson mean can be accommodated by <strong>DiscreteFDR</strong>.</p>
<p>To fix ideas, suppose we observe <span class="math inline">\(m = 9\)</span> independent Poisson distributed counts <span class="math inline">\(N_1, \ldots, N_9\)</span> (<a href="https://doi.org/10.1002/bimj.201700284">Jiménez-Otero et al. (2018)</a> used this to model the read counts of different DNA bases). We assume that <span class="math inline">\(N_i \sim \text{Pois}(\lambda_i)\)</span> and the goal is to identify cases where <span class="math inline">\(\lambda_i\)</span> is larger than some pre-specified value <span class="math inline">\(\lambda^0_i\)</span>, i.e., we have the (one-sided) multiple testing problem <span class="math display">\[H_{0i}: \lambda_i = \lambda^0_i \qquad \text{vs.} \qquad H_{1i}: \lambda_i &gt; \lambda^0_i.\]</span> As in Section 1, the goal is to adjust for multiple testing by using the [DBH-SD] procedure at FDR-level <span class="math inline">\(\alpha = 5\%\)</span>. In our example the observations <span class="math inline">\(n_1,\ldots, n_9\)</span> and parameters <span class="math inline">\(\lambda^0_1, \ldots, \lambda^0_9\)</span> are given as follows:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">lambda<span class="fl">.0</span> &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.6</span>, <span class="fl">1.2</span>, <span class="fl">0.7</span>, <span class="fl">1.3</span>, <span class="fl">1.0</span>, <span class="fl">0.2</span>, <span class="fl">0.8</span>, <span class="fl">1.3</span>, <span class="fl">0.9</span>)</a>
<a class="sourceLine" id="cb15-2" title="2">lambda.vector &lt;-<span class="st"> </span>lambda<span class="fl">.0</span></a>
<a class="sourceLine" id="cb15-3" title="3">observations &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>)</a>
<a class="sourceLine" id="cb15-4" title="4">configuration &lt;-<span class="st"> </span><span class="kw">cbind</span>(observations, lambda<span class="fl">.0</span>)</a>
<a class="sourceLine" id="cb15-5" title="5">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb15-6" title="6">m &lt;-<span class="st"> </span><span class="kw">length</span>(observations)</a>
<a class="sourceLine" id="cb15-7" title="7"><span class="kw">print</span>(configuration)</a>
<a class="sourceLine" id="cb15-8" title="8"><span class="co">#&gt;       observations lambda.0</span></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co">#&gt;  [1,]            3      0.6</span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co">#&gt;  [2,]            3      1.2</span></a>
<a class="sourceLine" id="cb15-11" title="11"><span class="co">#&gt;  [3,]            1      0.7</span></a>
<a class="sourceLine" id="cb15-12" title="12"><span class="co">#&gt;  [4,]            2      1.3</span></a>
<a class="sourceLine" id="cb15-13" title="13"><span class="co">#&gt;  [5,]            3      1.0</span></a>
<a class="sourceLine" id="cb15-14" title="14"><span class="co">#&gt;  [6,]            3      0.2</span></a>
<a class="sourceLine" id="cb15-15" title="15"><span class="co">#&gt;  [7,]            1      0.8</span></a>
<a class="sourceLine" id="cb15-16" title="16"><span class="co">#&gt;  [8,]            2      1.3</span></a>
<a class="sourceLine" id="cb15-17" title="17"><span class="co">#&gt;  [9,]            4      0.9</span></a></code></pre></div>
<p>Denote by <span class="math inline">\(G_i\)</span> the distribution of <span class="math inline">\(N_i\)</span> under <span class="math inline">\(H_{0i}\)</span> i.e., <span class="math inline">\(G_i(x) = P(N_i \le x)\)</span>. For observations <span class="math inline">\(n_1,\ldots, n_9\)</span> of <span class="math inline">\(N_1, \ldots, N_9\)</span> the <span class="math inline">\(p\)</span>-values for the above one-sided test are given by <span class="math display">\[p_i = P(N_i \ge n_i) = P(N_i &gt; n_i - 1) = \overline{G_i}(n_i - 1),\]</span> where <span class="math inline">\(\overline{G_i}(x) = P(N_i &gt; x) = 1 - G_i(x)\)</span> denotes the survival function of the Poisson distribution with parameter <span class="math inline">\(\lambda^0_i\)</span>. Thus the raw <span class="math inline">\(p\)</span>-values are determined by the following <strong>R</strong> code:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">raw.pvalues &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>m,<span class="cf">function</span>(i){<span class="kw">ppois</span>(observations[i] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, lambda.vector[i], <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)})</a>
<a class="sourceLine" id="cb16-2" title="2"><span class="kw">print</span>(raw.pvalues)</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="co">#&gt; [1] 0.023115288 0.120512901 0.503414696 0.373176876 0.080301397 0.001148481</span></a>
<a class="sourceLine" id="cb16-4" title="4"><span class="co">#&gt; [7] 0.550671036 0.373176876 0.013458721</span></a></code></pre></div>
<p>Following the definition of the  function in <strong>R</strong> we define the inverse function of <span class="math inline">\(\overline{G_i}\)</span> by <span class="math display">\[\left(\overline{G_i}\right)^{-1}(p) = \min\{n \in \mathbb{N}: \overline{G_i}(n) \le  p\}\]</span> and obtain for the distribution function of the <span class="math inline">\(i\)</span>-th <span class="math inline">\(p\)</span>-value under the null <span class="math display">\[F_i(x) = \overline{G_i}\left(\left(\overline{G_i}\right)^{-1}(x)\right).\]</span> Each function <span class="math inline">\(F_i\)</span> is a step function with <span class="math inline">\(F_i(0) = 0\)</span>, <span class="math inline">\(F_i(1) = 1\)</span> and there exists an infinite sequence of jumps at locations <span class="math inline">\(1 = x_1 &gt; x_2 &gt; \ldots &gt; x_n &gt; x_{n + 1} &gt; \ldots &gt; 0\)</span> such that <span class="math inline">\(F(x_j) = x_j\)</span> for <span class="math inline">\(j \in \mathbb{N}\)</span>.</p>
<p>Initially it seems that we run into a problem if we want to determine the critical values of [DBH-SD] since the supports of <span class="math inline">\(F_1, \ldots, F_9\)</span> are no longer finite (but still discrete). We can deal with this problem by using the observation from Section  that it is sufficient to consider new, restricted supports <span class="math inline">\(\mathcal{A}_i \cap [s^{\tiny \mbox{min}},1]\)</span> where the lower threshold satisfies <span class="math display">\[\begin{align}
  s^{\tiny \mbox{min}} &amp;\le \tau^{\tiny \mbox{min}}_1 = \max \left\{t \in \mathcal{A}\::\: t \leq y^{\tiny \mbox{min}} \right\} \qquad \text{where} \qquad y^{\tiny \mbox{min}} = \frac{\alpha}{m} \cdot \left(1 + \frac{\alpha}{m} \right)^{-1}.
\end{align}\]</span> To determine such an <span class="math inline">\(s^{\tiny \mbox{min}}\)</span> we proceed as follows. Define <span class="math inline">\(n^{\tiny \mbox{max}}_i = \left(\overline{G_i}\right)^{-1}(y^{\tiny \mbox{min}}) + 1\)</span>, <span class="math inline">\(t^{\tiny \mbox{min}}_i = \overline{G_i}(n^{\tiny \mbox{max}}_i - 1)\)</span> and set <span class="math inline">\(s^{\tiny \mbox{min}} = \min\left(t^{\tiny \mbox{min}}_1, \ldots, t^{\tiny \mbox{min}}_9 \right)\)</span>. It is easily checked that this choice of <span class="math inline">\(s^{\tiny \mbox{min}}\)</span> satisfies the above equation. We can determine <span class="math inline">\(s^{\tiny \mbox{min}}\)</span> by the following code</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">y.min &lt;-<span class="st"> </span>alpha<span class="op">/</span>m <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">+</span><span class="st"> </span>alpha<span class="op">/</span>m)<span class="op">^</span>(<span class="op">-</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-2" title="2">n.max &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>m, <span class="cf">function</span>(w){<span class="kw">qpois</span>(y.min,        lambda.vector[w], <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)}) <span class="op">+</span><span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb17-3" title="3">t.min &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span><span class="op">:</span>m, <span class="cf">function</span>(w){<span class="kw">ppois</span>(n.max[w] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, lambda.vector[w], <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>)})</a>
<a class="sourceLine" id="cb17-4" title="4">s.min &lt;-<span class="st"> </span><span class="kw">min</span>(t.min)</a>
<a class="sourceLine" id="cb17-5" title="5"><span class="kw">print</span>(s.min)</a>
<a class="sourceLine" id="cb17-6" title="6"><span class="co">#&gt; [1] 0.0007855354</span></a></code></pre></div>
<p>For determining the restricted supports it is actually more convenient to work with <span class="math inline">\(n^{\tiny \mbox{max}}_i\)</span> than <span class="math inline">\(s^{\tiny \mbox{min}}\)</span>. We can subsequently use these supports as the <code>pCDFlist</code> argument in the usual way when calling the <code>DBH</code> function:</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">supports &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span>m, <span class="cf">function</span>(w){<span class="kw">sort</span>(<span class="kw">ppois</span>(<span class="dv">0</span><span class="op">:</span>n.max[w] <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, lambda.vector[w], <span class="dt">lower.tail =</span> <span class="ot">FALSE</span>))})</a>
<a class="sourceLine" id="cb18-2" title="2">DBH.sd &lt;-<span class="st"> </span><span class="kw">DBH</span>(raw.pvalues, supports, <span class="dt">direction =</span> <span class="st">&quot;sd&quot;</span>, <span class="dt">ret.crit.consts =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p>Figure 3 shows a summary similar to Figure 1. Applying the continuous BH procedure</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">p.adjust</span>(raw.pvalues, <span class="dt">method =</span> <span class="st">&quot;BH&quot;</span>)</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="co">#&gt; [1] 0.06934586 0.21692322 0.55067104 0.47979884 0.18067814 0.01033633 0.55067104</span></a>
<a class="sourceLine" id="cb19-3" title="3"><span class="co">#&gt; [8] 0.47979884 0.06056424</span></a></code></pre></div>
<p>results in one rejection at FDR-level <span class="math inline">\(\alpha = 5\%\)</span>, whereas the DBH step-up procedure can reject three hypotheses:</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">DBH.sd<span class="op">$</span>Adjusted</a>
<a class="sourceLine" id="cb20-2" title="2"><span class="co">#&gt; [1] 0.039602625 0.101622881 0.580898946 0.522450788 0.101509307 0.001935955</span></a>
<a class="sourceLine" id="cb20-3" title="3"><span class="co">#&gt; [7] 0.626257875 0.522450788 0.033073393</span></a></code></pre></div>
<p>This information can also be obtained by our <code>print</code> method:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">print</span>(DBH.sd)</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb21-3" title="3"><span class="co">#&gt;   Discrete Benjamini-Hochberg procedure (step-down) </span></a>
<a class="sourceLine" id="cb21-4" title="4"><span class="co">#&gt; </span></a>
<a class="sourceLine" id="cb21-5" title="5"><span class="co">#&gt; data:  raw.pvalues and pCDFlist </span></a>
<a class="sourceLine" id="cb21-6" title="6"><span class="co">#&gt; number of tests = 9 </span></a>
<a class="sourceLine" id="cb21-7" title="7"><span class="co">#&gt; number of rejections = 3 at global FDR level 0.05 </span></a>
<a class="sourceLine" id="cb21-8" title="8"><span class="co">#&gt; (Original BH rejections = 1)</span></a>
<a class="sourceLine" id="cb21-9" title="9"><span class="co">#&gt; largest rejected p value:  0.02311529</span></a></code></pre></div>
<p>As in Figure 1, Panel (c) presents a graphical comparison between the two procedures applied to the <span class="math inline">\(p\)</span>-values.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">stepf &lt;-<span class="st"> </span><span class="kw">lapply</span>(supports, <span class="cf">function</span>(x) <span class="kw">stepfun</span>(x, <span class="kw">c</span>(<span class="dv">0</span>, x)))</a>
<a class="sourceLine" id="cb22-2" title="2"><span class="kw">par</span>(<span class="dt">mfcol =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">3</span>), <span class="dt">mai =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.1</span>))</a>
<a class="sourceLine" id="cb22-3" title="3"></a>
<a class="sourceLine" id="cb22-4" title="4"><span class="kw">plot</span>(stepf[[<span class="dv">1</span>]], <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>), <span class="dt">do.points =</span> <span class="ot">FALSE</span>, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">ylab =</span> <span class="st">&quot;F(x)&quot;</span>, </a>
<a class="sourceLine" id="cb22-5" title="5">     <span class="dt">main =</span> <span class="st">&quot;(a)&quot;</span>)</a>
<a class="sourceLine" id="cb22-6" title="6"><span class="cf">for</span>(i <span class="cf">in</span> (<span class="dv">2</span><span class="op">:</span><span class="dv">9</span>)){</a>
<a class="sourceLine" id="cb22-7" title="7">  <span class="kw">plot</span>(stepf[[i]], <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">do.points =</span> <span class="ot">FALSE</span>, <span class="dt">lwd =</span> <span class="dv">1</span>, <span class="dt">col =</span> i)</a>
<a class="sourceLine" id="cb22-8" title="8">}</a>
<a class="sourceLine" id="cb22-9" title="9"><span class="kw">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb22-10" title="10"></a>
<a class="sourceLine" id="cb22-11" title="11"><span class="co">#   Plot xi</span></a>
<a class="sourceLine" id="cb22-12" title="12">support &lt;-<span class="st"> </span><span class="kw">sort</span>(<span class="kw">unique</span>(<span class="kw">unlist</span>(supports)))</a>
<a class="sourceLine" id="cb22-13" title="13">components &lt;-<span class="st"> </span><span class="kw">lapply</span>(stepf, <span class="cf">function</span>(s){<span class="kw">s</span>(support) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">s</span>(support))}) </a>
<a class="sourceLine" id="cb22-14" title="14">xi.values &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span><span class="dv">9</span> <span class="op">*</span><span class="st"> </span><span class="kw">Reduce</span>(<span class="st">&#39;+&#39;</span>, components)</a>
<a class="sourceLine" id="cb22-15" title="15">xi &lt;-<span class="st"> </span><span class="kw">stepfun</span>(support, <span class="kw">c</span>(<span class="dv">0</span>, xi.values))</a>
<a class="sourceLine" id="cb22-16" title="16"><span class="kw">plot</span>(xi, <span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.10</span>), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.10</span>), <span class="dt">do.points =</span> <span class="ot">FALSE</span>, <span class="dt">ylab =</span> <span class="kw">expression</span>(xi), <span class="dt">main =</span> <span class="st">&quot;(b)&quot;</span>)</a>
<a class="sourceLine" id="cb22-17" title="17"><span class="kw">segments</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="dt">col =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">lty =</span> <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb22-18" title="18"></a>
<a class="sourceLine" id="cb22-19" title="19"><span class="co">#   Plot discrete critical values as well a BH constants</span></a>
<a class="sourceLine" id="cb22-20" title="20">DBH.sd &lt;-<span class="st"> </span><span class="kw">DBH</span>(raw.pvalues, supports, <span class="dt">direction =</span> <span class="st">&quot;sd&quot;</span>, <span class="dt">ret.crit.consts =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb22-21" title="21"><span class="kw">plot</span>(DBH.sd, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;black&quot;</span>, <span class="st">&quot;black&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">pch =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">19</span>), <span class="dt">type.crit =</span> <span class="st">&#39;p&#39;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>),</a>
<a class="sourceLine" id="cb22-22" title="22">     <span class="dt">cex =</span> <span class="fl">1.3</span>, <span class="dt">main =</span> <span class="st">&quot;(c)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;Critical Values&quot;</span>)</a>
<a class="sourceLine" id="cb22-23" title="23"><span class="kw">points</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>, <span class="fl">0.05</span> <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>) <span class="op">/</span><span class="st"> </span><span class="dv">9</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>, <span class="dt">pch =</span> <span class="dv">19</span>, <span class="dt">cex =</span> <span class="fl">1.3</span>)</a>
<a class="sourceLine" id="cb22-24" title="24"></a>
<a class="sourceLine" id="cb22-25" title="25"><span class="kw">mtext</span>(<span class="st">&quot;Figure 3&quot;</span>, <span class="dv">1</span>, <span class="dt">outer =</span> <span class="ot">TRUE</span>, <span class="dt">line =</span> <span class="dv">-2</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>Panel (a) depicts the distribution functions <span class="math inline">\(F_1, \ldots, F_9\)</span> in various colors, (b) is a graph of the transformation function <span class="math inline">\(\xi_{\text{SD}}\)</span>. The uniform distribution function is shown in light grey in (a) and (b). Panel (c) shows the [BH] critical values (green dots), the DBH step-down critical values (red dots) and the sorted raw <span class="math inline">\(p\)</span>-values (asterisks).</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
