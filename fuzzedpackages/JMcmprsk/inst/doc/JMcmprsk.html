<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />


<meta name="date" content="2020-11-21" />

<title>Joint Models for Longitudinal Measurements and Competing Risks Failure Time Data</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Joint Models for Longitudinal Measurements and Competing Risks Failure Time Data</h1>
<h4 class="date">2020-11-21</h4>



<p>Joint analysis of longitudinal outcomes and survival times has gained a lot of attention in recent years. There have been extended to handle competing risks for both continuous and ordinal outcomes <span class="citation">(Elashoff, Li, and Li 2008, @MR2758452)</span>. This vignette offers a brief introduction to the R package JMcmprsk, which implements the methods proposed to deal with such joint models, and two competing risks are assumed. The data sets for generating the initial values are provided.</p>
<div id="joint-modeling-framework" class="section level2">
<h2>Joint modeling framework</h2>
<div id="continuous-outcomes" class="section level4">
<h4>Continuous outcomes</h4>
<p>Let <span class="math inline">\(Y_i(t)\)</span> be the longitudinal outcome measured at time <span class="math inline">\(t\)</span> for subject <span class="math inline">\(i\)</span>, <span class="math inline">\(i=1,2,\cdots,n\)</span>, and <span class="math inline">\(n\)</span> is the total number of subjects in study. Let <span class="math inline">\(C_i=(T_i,D_i)\)</span> denote the competing risks data on subject <span class="math inline">\(i\)</span>, where <span class="math inline">\(T_i\)</span> is the failure time or censoring time, and <span class="math inline">\(D_i\)</span> takes value in <span class="math inline">\(\{0,1,\cdots,g\}\)</span>, with <span class="math inline">\(D_i=0\)</span> indicating a censored event and <span class="math inline">\(D_i=k\)</span> showing that subject <span class="math inline">\(i\)</span> fails from the <span class="math inline">\(k\)</span>th type of failure, where <span class="math inline">\(k=1,\cdots,g\)</span>.</p>
<p>The joint model is specified in terms of the following two linked components: <span class="math display">\[\begin{eqnarray*}
Y_i(t)&amp;=&amp;X_i^{(1)}(t)^\top \beta+\tilde X_i^{(1)}(t)^\top b_i+\epsilon_i(t),\\
\lambda_k(t)&amp;=&amp;\lambda_{0k}(t)\exp(X_i^{(2)}(t)^\top \gamma_k+\nu_k u_i),~~\mbox{for}~~k=1,\cdots,g,
\end{eqnarray*}\]</span> where <span class="math inline">\(X_i^{(1)}(t)\)</span>, <span class="math inline">\(X_i^{(2)}(t)\)</span> denote the covaraites for the fixed-effects <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\gamma_k\)</span>, <span class="math inline">\(\tilde X_i^{(1)}(t)\)</span> denotes the covaraites for the random-effects <span class="math inline">\(b_i\)</span>, and <span class="math inline">\(\epsilon_i(t)\sim N(0,\sigma^2)\)</span> for all <span class="math inline">\(t\geq 0\)</span>. The parameter <span class="math inline">\(\nu_1\)</span> is set to 1 to ensure identifiability. We assume that <span class="math inline">\(b_i\)</span> is independent of <span class="math inline">\(\epsilon_i(t)\)</span> and that <span class="math inline">\(\epsilon_i(t_1)\)</span> is independent of <span class="math inline">\(\epsilon_i(t_2)\)</span> for any <span class="math inline">\(t_1\neq t_2\)</span>. We further assume the random effects <span class="math inline">\(b_i\)</span> and <span class="math inline">\(u_i\)</span> jointly have a multivariate normal distribution, denoted by <span class="math inline">\(\theta_i\sim N(0,\Sigma)\)</span>, where <span class="math inline">\(\Sigma=(\Sigma_{b},\Sigma_{bu}^\top;\Sigma_{bu},\sigma_u)\)</span>.</p>
<p>Denote <span class="math inline">\(\Psi\)</span> as the unknown parameters from the joint models. We propose to obtain the maximum likelihood estimate of <span class="math inline">\(\Psi\)</span> through an EM algorithm. The complete data likelihood is <span class="math display">\[\begin{eqnarray*}
&amp;&amp;L(\Psi;Y,C,\theta)\\
&amp;&amp;\propto \Pi_{i=1}^n\Big[\Pi_{j=1}^{n_i}\frac{1}{\sqrt{2\pi\sigma^2}}\exp(-\frac{1}{2\sigma^2}(Y_{ij}-X_i^{(1)}(t_{ij})^\top\beta-\tilde X_i^{(1)}(t_{ij})^\top b_i)^2)\Big]\\
&amp;&amp;\times \Pi_{k=1}^g\lambda_k(T_i)^{I(D_i=k)}\exp\Big\{-\int_0^{T_i}\sum_{k=1}^g\lambda_k(t)dt\Big\}\\
&amp;&amp;\times \frac{1}{\sqrt{(2\pi)^d|\Sigma|}}\exp(-\frac{1}{2}\theta_i^\top\Sigma^{-1}\theta_i).
\end{eqnarray*}\]</span> In the E-step, we need to calculate the expected value of all the functions of <span class="math inline">\(\theta\)</span>, The integral does not have a closed-form solution, and thus a numerical method must be employed for its evaluation. Standard option is the Gaussian quadratic rules. In the M-step, we can update <span class="math inline">\(\Psi\)</span> through maximizing the function obtained from the E-step.</p>
</div>
<div id="ordinal-outcomes" class="section level4">
<h4>Ordinal outcomes</h4>
<p>Let <span class="math inline">\(Y_{ij}\)</span> denote the <span class="math inline">\(j\)</span>th response measured on subject <span class="math inline">\(i\)</span>, where <span class="math inline">\(i=1,\cdots,n\)</span>, <span class="math inline">\(j=1,\cdots,n_i\)</span>, and <span class="math inline">\(Y_{ij}\)</span> takes values in <span class="math inline">\(\{1,\cdots,K\}\)</span>. The competing risks failure times on subject <span class="math inline">\(i\)</span> is <span class="math inline">\((T_i,D_i)\)</span>, and the meaning is the same as in subsection of “Continuous outcomes”.</p>
<p>we propose the following partial proportional odds model for <span class="math inline">\(Y_{ij}\)</span> <span class="math display">\[\begin{eqnarray*}
P(Y_{ij}\leq k|X_{ij},\tilde X_{ij},W_{ij},b_i)=\frac{1}{1+\exp(-\theta_{k}-X_{ij}\beta-\tilde X_{ij}\alpha_{k}-W_{ij}^\top b_i)}.
\end{eqnarray*}\]</span> where <span class="math inline">\(k=1,\cdots,K-1\)</span>, <span class="math inline">\(X_{ij}\)</span> and <span class="math inline">\(\tilde X_{ij}\)</span> are <span class="math inline">\(p\times 1\)</span> and <span class="math inline">\(s\times 1\)</span> vectors of covaraites for the fixed-effect <span class="math inline">\(\beta\)</span> and <span class="math inline">\(\alpha_{k}\)</span>, with <span class="math inline">\(\alpha_{1}=0\)</span>, and <span class="math inline">\(\tilde X_{ij}\)</span> is a subset of <span class="math inline">\(X_{ij}\)</span> for which the proportional odds assumption may not be satisfied. The <span class="math inline">\(q\times 1\)</span> vector <span class="math inline">\(b_i\)</span> represents random effects of the associated covaraites <span class="math inline">\(W_{ij}\)</span>.</p>
<p>The distribution of the competing risks failure times <span class="math inline">\((T_i,D_i)\)</span> are assumed to take the form of the following cause-specific hazards frailty model: <span class="math display">\[\begin{eqnarray*}
\lambda_d(t|Z_i(t),u_i)&amp;=&amp;\lambda_{0d}(t)\exp(Z_i(t)^\top \gamma_d+\nu_d u_i),~~\mbox{for}~~d=1,\cdots,g,
\end{eqnarray*}\]</span> where the <span class="math inline">\(l\times 1\)</span> vector <span class="math inline">\(\gamma_d\)</span> and <span class="math inline">\(\nu_d\)</span> are cause-specific coefficients for the covariates <span class="math inline">\(Z_i(t)\)</span> and the random effects <span class="math inline">\(u_i\)</span>, respectively.</p>
<p>The parameter <span class="math inline">\(\nu_1\)</span> is set to 1 to ensure identifiability. We assume the random effects <span class="math inline">\(b_i\)</span> and <span class="math inline">\(u_i\)</span> jointly have a multivariate normal distribution, denoted by <span class="math inline">\(a_i\sim N(0,\Sigma)\)</span>.</p>
<p>Denote <span class="math inline">\(\Psi\)</span> as the unknown parameters from the joint models. We propose to obtain the maximum likelihood estimate of <span class="math inline">\(\Psi\)</span> through an EM algorithm. The complete data likelihood is <span class="math display">\[\begin{eqnarray*}
&amp;&amp;L(\Psi;Y,C,a)\\
&amp;&amp;\propto \Pi_{i=1}^n\Big[\Pi_{j=1}^{n_i}\Pi_{k=1}^{K}\{\pi_{ij}(k)-\pi_{ij}(k-1)\}^{I(Y_{ij}=k)}\Big]\\
&amp;&amp;\times \Pi_{d=1}^g\lambda_d(T_i)^{I(D_i=d)}\exp\Big\{-\int_0^{T_i}\sum_{k=1}^d\lambda_d(t)dt\Big\}\\
&amp;&amp;\times \frac{1}{\sqrt{(2\pi)^{q+1}|\Sigma|}}\exp(-\frac{1}{2}a_i^\top\Sigma^{-1}a_i).
\end{eqnarray*}\]</span> where <span class="math inline">\(\pi_{ij}(k)\)</span> stands for the probability that <span class="math inline">\(Y_{ij}\leq k\)</span> given the covariates and the random effects. The implementation of EM algorithm is the same as that of subection of “Continuous outcomes”.</p>
</div>
</div>
<div id="the-r-package-jmcmprsk" class="section level2">
<h2>The R package JMcmprsk</h2>
<p>The function that fits continuous outcomes in JMcmprsk is called jmc(). As an illustrative example of jmc(), we consider Scleroderma Lung Study <span class="citation">(Tashkin et al. 2006)</span>, a double-blinded, randomized clinical trial to evaluate effectiveness of oral cyclophosphamide (CYC) versus placebo in the treatment of lung disease due to scleroderma. This study includes 158 patients, the primary outcome is forced vital capacity (FVC, as % predicted) determined at 3-month intervals from the baseline. The event of interest is the time-to-treatment failure or death. We consider two factors baseline %FVC (<span class="math inline">\(FVC_0\)</span>) and baseline lung fibrosis (<span class="math inline">\(FIB_0\)</span>) and two risks, informative and noninformative. The model setups are as follows, <span class="math display">\[\begin{eqnarray*}
\%FVC_{ij}&amp;=&amp;\beta_1+\beta_2t_{ij}+\beta_3FVC_{0i}+\beta_4FIB_{0i}+\beta_5CYC_i\\
&amp;&amp;+\beta_6FVC_{0i}\times CYC_i+\beta_7FIB_{0i}\times CYC_i+\beta_8 t_{ij}\times CYC_i+b_it_{ij}+\epsilon,
\end{eqnarray*}\]</span> and the cause-specific hazards frailty models are <span class="math display">\[\begin{eqnarray*}
\lambda_1(t)=\lambda_{01}(t)\exp(\gamma_{11}FVC_{0i}+\gamma_{12}FIB_{0i}+\gamma_{13}CYC_i+\gamma_{14}FVC_{0i}\times CYC_i+\gamma_{15}FIB_{0i}\times CYC_i+u_i)\\
\lambda_2(t)=\lambda_{02}(t)\exp(\gamma_{21}FVC_{0i}+\gamma_{22}FIB_{0i}+\gamma_{23}CYC_i+\gamma_{24}FVC_{0i}\times CYC_i+\gamma_{25}FIB_{0i}\times CYC_i+\nu_2u_i),
\end{eqnarray*}\]</span></p>
</div>
<div id="examples" class="section level2">
<h2>Examples</h2>
<p>We first load the package and the data.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">require</span>(JMcmprsk)</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb1-3" title="3"><span class="kw">data</span>(lung)</a>
<a class="sourceLine" id="cb1-4" title="4">yread &lt;-<span class="st"> </span>lung[, <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span><span class="op">:</span><span class="dv">11</span>)]</a>
<a class="sourceLine" id="cb1-5" title="5">cread &lt;-<span class="st"> </span><span class="kw">unique</span>(lung[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">6</span><span class="op">:</span><span class="dv">10</span>)])</a></code></pre></div>
<p>The model can be specified by the function jmc():</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">jmcfit &lt;-<span class="st"> </span><span class="kw">jmc</span>(<span class="dt">long_data =</span> yread, <span class="dt">surv_data =</span> cread, <span class="dt">out =</span> <span class="st">&quot;FVC&quot;</span>, </a>
<a class="sourceLine" id="cb2-2" title="2">           <span class="dt">FE =</span> <span class="kw">c</span>(<span class="st">&quot;time&quot;</span>, <span class="st">&quot;FVC0&quot;</span>, <span class="st">&quot;FIB0&quot;</span>, <span class="st">&quot;CYC&quot;</span>, <span class="st">&quot;FVC0.CYC&quot;</span>, </a>
<a class="sourceLine" id="cb2-3" title="3">                  <span class="st">&quot;FIB0.CYC&quot;</span>, <span class="st">&quot;time.CYC&quot;</span>), </a>
<a class="sourceLine" id="cb2-4" title="4">           <span class="dt">RE =</span> <span class="st">&quot;linear&quot;</span>, <span class="dt">ID =</span> <span class="st">&quot;ID&quot;</span>,<span class="dt">cate =</span> <span class="ot">NULL</span>, <span class="dt">intcpt =</span> <span class="dv">0</span>, </a>
<a class="sourceLine" id="cb2-5" title="5">            <span class="dt">quad.points =</span> <span class="dv">20</span>, <span class="dt">quiet =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb2-6" title="6">jmcfit</a></code></pre></div>
<p>We can also call the internal function jmc_0() to get the same model fit. Below is the illustrative example of using the same dataset.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">require</span>(JMcmprsk)</a>
<a class="sourceLine" id="cb3-2" title="2"><span class="kw">data</span>(lung)</a>
<a class="sourceLine" id="cb3-3" title="3">lungY &lt;-<span class="st"> </span>lung[, <span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">11</span>)]</a>
<a class="sourceLine" id="cb3-4" title="4">lungC &lt;-<span class="st"> </span><span class="kw">unique</span>(lung[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">12</span>, <span class="dv">13</span>, <span class="dv">6</span><span class="op">:</span><span class="dv">10</span>)])</a>
<a class="sourceLine" id="cb3-5" title="5">lungC &lt;-<span class="st"> </span>lungC[, <span class="dv">-1</span>]</a>
<a class="sourceLine" id="cb3-6" title="6">lungM &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="kw">table</span>(lung<span class="op">$</span>ID))</a>
<a class="sourceLine" id="cb3-7" title="7">lungM &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(lungM[, <span class="dv">2</span>])</a></code></pre></div>
<p>The number of rows in lungY is the total number of measurements for all subjects in the study. The columns in yfile should start with the longitudinal outcome (column 1), the covariates for the random effects, and then the covariates for the fixed effects. For lungC, the survival / censoring time is included in the first column, and the failure type coded as 0 (censored events), 1 (risk 1), or 2 (risk 2) is given in the second column. Two competing risks are assumed. The covariates are included in the third column and on. lungM is to indicate the number of longitudinal measurements per subject. The number of rows equals to the number of subjects.</p>
<p>Hence, the model can be specified by the function jmc_0():</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">res1=<span class="kw">jmc_0</span>(<span class="dt">p=</span><span class="dv">8</span>, lungY, lungC, lungM, <span class="dt">point=</span><span class="dv">20</span>, <span class="dt">do.trace =</span> <span class="ot">FALSE</span>, <span class="dt">type_file =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb4-2" title="2">res1</a></code></pre></div>
<p>with <span class="math inline">\(p\)</span> the dimension of fixed effects (include intercept) in yfile, the option “point” is the number of points used to approximate the integral in the E-step, default is 20, and “do.trace” is used to control whether the programm prints the iteration details. “type_file” is to control whether the datasets are called from file paths / data frames, default is TRUE, i.e., file paths. If we would like to see a concise summary of the result we can simply type</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="co">#because of the long running time, we save the jmo and jmc results within the package</span></a>
<a class="sourceLine" id="cb5-2" title="2">fitfile=<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;runfit.RData&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;JMcmprsk&quot;</span>)</a>
<a class="sourceLine" id="cb5-3" title="3"><span class="kw">load</span>(fitfile)</a>
<a class="sourceLine" id="cb5-4" title="4">jmcfit</a></code></pre></div>
<pre><code>## 
## Call:
##  jmc(long_data = yread, surv_data = cread, out = &quot;FVC&quot;, FE = c(&quot;time&quot;, &quot;FVC0&quot;, &quot;FIB0&quot;, &quot;CYC&quot;, &quot;FVC0.CYC&quot;, &quot;FIB0.CYC&quot;, &quot;time.CYC&quot;), RE = &quot;linear&quot;, ID = &quot;ID&quot;, cate = NULL, intcpt = 0, quad.points = 20, quiet = FALSE) 
## 
## Data Summary:
## Number of observations: 715 
## Number of groups: 140 
## 
## Proportion of competing risks: 
## Risk 1 : 10 %
## Risk 2 : 22.86 %
## 
## Numerical intergration:
## Method: standard Guass-Hermite quadrature
## Number of quadrature points:  20 
## 
## Model Type: joint modeling of longitudinal continuous and competing risks data 
## 
## Model summary:
## Longitudinal process: linear mixed effects model
## Event process: cause-specific Cox proportional hazard model with unspecified baseline hazard
## 
## Loglikelihood:  -3799.044 
## 
## Longitudinal sub-model fixed effects:  FVC ~ time + FVC0 + FIB0 + CYC + FVC0.CYC + FIB0.CYC + time.CYC 
## 
##                   Estimate   Std. Error       95% CI            Pr(&gt;|Z|)    
## Longitudinal:                
##  Fixed effects:                 
##   intercept      66.0415      0.7541      ( 64.5634, 67.5196)      0.0000    
##   time           -0.0616      0.0790      (-0.2165, 0.0932)      0.4353    
##   FVC0           0.9017       0.0365      ( 0.8302, 0.9732)      0.0000    
##   FIB0           -1.7780      0.5605      (-2.8767,-0.6793)      0.0015    
##   CYC            0.0150       0.9678      (-1.8819, 1.9119)      0.9876    
##   FVC0.CYC       0.1380       0.0650      ( 0.0106, 0.2654)      0.0338    
##   FIB0.CYC       1.7088       0.7643      ( 0.2109, 3.2068)      0.0254    
##   time.CYC       0.1278       0.1102      (-0.0883, 0.3438)      0.2464    
## Random effects:                 
##   sigma^2         22.7366       0.6575  ( 21.4478, 24.0253)      0.0000    
## 
## Survival sub-model fixed effects:  Surv(surv, failure_type) ~ FVC0 + FIB0 + CYC + FVC0.CYC + FIB0.CYC 
## 
##                   Estimate   Std. Error       95% CI           Pr(&gt;|Z|)    
## Survival:                
##  Fixed effects:                 
##   FVC0_1         0.0187       0.0326      (-0.0452, 0.0826)      0.5660    
##   FIB0_1         0.1803       0.3521      (-0.5098, 0.8705)      0.6086    
##   CYC_1          -0.6872      0.7653      (-2.1872, 0.8128)      0.3692    
##   FVC0.CYC_1     -0.0517      0.0746      (-0.1979, 0.0945)      0.4880    
##   FIB0.CYC_1     -0.4665      1.1099      (-2.6419, 1.7089)      0.6743    
##   FVC0_2         -0.0677      0.0271      (-0.1208,-0.0147)      0.0123    
##   FIB0_2         0.1965       0.3290      (-0.4484, 0.8414)      0.5503    
##   CYC_2          0.3137       0.4665      (-0.6007, 1.2280)      0.5013    
##   FVC0.CYC_2     0.1051       0.0410      ( 0.0248, 0.1854)      0.0103    
##   FIB0.CYC_2     0.1239       0.4120      (-0.6836, 0.9314)      0.7636    
## 
## Association parameter:                 
##   v2             1.9949       2.3093      (-2.5314, 6.5212)      0.3877    
## 
## Random effects:                 
##   sigma_b11      0.2215       0.0294      ( 0.1638, 0.2792)      0.0000    
##   sigma_u        0.0501       0.0898      (-0.1259, 0.2260)      0.5772    
##  Covariance:                 
##   sigma_b1u      -0.0997      0.0797      (-0.2560, 0.0565)      0.2109</code></pre>
<p>The resulting table contains three parts, the fixed effects in longitudinal model, survival model and random effects. It gives the estimated parameters in the first column, standard error in the second column, 95% confidence interval and <span class="math inline">\(p\)</span>-value for these parameters in the third and forth columns. In our example, there is only one random effect, if there are more than one random effect, the outputs will include <span class="math inline">\(sigma_b11, sigma_b12, sigma_b22, sigma_b1u, sigma_b2u\)</span> and so on.</p>
<p>By the way, the supporting function coef() can be used to extract the coefficients of the longitudinal/survival process:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw">coef</span>(jmcfit, <span class="dt">coeff =</span> <span class="st">&quot;beta&quot;</span>)</a></code></pre></div>
<pre><code>##   intercept        time        FVC0        FIB0         CYC    FVC0.CYC 
## 66.04146267 -0.06164756  0.90166283 -1.77799172  0.01503104  0.13798885 
##    FIB0.CYC    time.CYC 
##  1.70883750  0.12776670</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="kw">coef</span>(jmcfit, <span class="dt">coeff =</span> <span class="st">&quot;gamma&quot;</span>)</a></code></pre></div>
<pre><code>##             FVC0      FIB0        CYC    FVC0.CYC   FIB0.CYC
## [1,]  0.01871359 0.1803249 -0.6872099 -0.05172157 -0.4664724
## [2,] -0.06772664 0.1965190  0.3136709  0.10509986  0.1239203</code></pre>
<p>We proceed by checking the fit of the model using linearTest().</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="co">## Linear hypothesis of testing all coefficients of beta&#39;s / gamma&#39;s equal 0</span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="kw">linearTest</span>(jmcfit,<span class="dt">coeff=</span><span class="st">&quot;beta&quot;</span>)</a></code></pre></div>
<pre><code>##              Chisq df Pr(&gt;|Chi|)
## L*beta=Cb 1072.307  7 0.0000</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">linearTest</span>(jmcfit,<span class="dt">coeff=</span><span class="st">&quot;gamma&quot;</span>)</a></code></pre></div>
<pre><code>##               Chisq df Pr(&gt;|Chi|)
## L*gamma=Cg 11.06558 10 0.3524</code></pre>
<p>We can see that the hypothesis that <span class="math inline">\(\beta_1=\beta_2=\cdots=\beta_7=0\)</span> will be rejected, and the hypothesis <span class="math inline">\(\gamma_{11}=\gamma_{12}=\cdots= \gamma_{15}=0\)</span> and <span class="math inline">\(\gamma_{21}=\gamma_{22}=\cdots=\gamma_{25}=0\)</span> will not be rejected at the nominal level of 0.05.</p>
<p>We extract the standard error and 95 percent confidence interval using summary().</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co">## Extract the standard errors for the longitudinal portion</span></a>
<a class="sourceLine" id="cb15-2" title="2"><span class="kw">summary</span>(jmcfit, <span class="dt">coeff =</span> <span class="st">&quot;longitudinal&quot;</span>)</a></code></pre></div>
<pre><code>##   Longitudinal Estimate     SE 95%Lower 95%Upper p-values
## 1    intercept  66.0415 0.7541  64.5634  67.5196   0.0000
## 2         time  -0.0616 0.0790  -0.2165   0.0932   0.4353
## 3         FVC0   0.9017 0.0365   0.8302   0.9732   0.0000
## 4         FIB0  -1.7780 0.5605  -2.8767  -0.6793   0.0015
## 5          CYC   0.0150 0.9678  -1.8819   1.9119   0.9876
## 6     FVC0.CYC   0.1380 0.0650   0.0106   0.2654   0.0338
## 7     FIB0.CYC   1.7088 0.7643   0.2109   3.2068   0.0254
## 8     time.CYC   0.1278 0.1102  -0.0883   0.3438   0.2464</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="co">## Extract the standard errors for the survival portion</span></a>
<a class="sourceLine" id="cb17-2" title="2"><span class="kw">summary</span>(jmcfit, <span class="dt">coeff =</span> <span class="st">&quot;survival&quot;</span>)</a></code></pre></div>
<pre><code>##      Survival    coef exp(coef) SE(coef) 95%Lower 95%Upper p-values
## 1      FVC0_1  0.0187    1.0189   0.0326  -0.0452   0.0826   0.5660
## 2      FIB0_1  0.1803    1.1976   0.3521  -0.5098   0.8705   0.6086
## 3       CYC_1 -0.6872    0.5030   0.7653  -2.1872   0.8128   0.3692
## 4  FVC0.CYC_1 -0.0517    0.9496   0.0746  -0.1979   0.0945   0.4880
## 5  FIB0.CYC_1 -0.4665    0.6272   1.1099  -2.6419   1.7089   0.6743
## 6      FVC0_2 -0.0677    0.9345   0.0271  -0.1208  -0.0147   0.0123
## 7      FIB0_2  0.1965    1.2172   0.3290  -0.4484   0.8414   0.5503
## 8       CYC_2  0.3137    1.3684   0.4665  -0.6007   1.2280   0.5013
## 9  FVC0.CYC_2  0.1051    1.1108   0.0410   0.0248   0.1854   0.0103
## 10 FIB0.CYC_2  0.1239    1.1319   0.4120  -0.6836   0.9314   0.7636</code></pre>
<p>The implement of jmo() is the same as that of jmc(). As an illustrative example, we use the data from NINDS rt-PA stroke trial <span class="citation">(Group 1995)</span>. In this study, 624 patients are included, and the patients treated with rt-PA were compared with those given placebo to look for an improvement from baseline in the score on the modified Rankin scale, an ordinal measure of degree of disability with categories ranging from no symptoms, no significant disability to severe disability or death, which means in this example, <span class="math inline">\(Y_{ij}\)</span> takes <span class="math inline">\(K=4\)</span> ordinal values. The following covaraites are considered: treatment group (rt-PA or placebo), modified Rankin scale prior stroke onset, time since randomization (dummy variables for 3, 6 and 12 months), and the three subtypes of acute stroke (small vessel occlusive disease, large vessel atherosclerosis or cardioembolic stroke, and unknown reasons). Similarly, we also consider the informative and noninformative risks. The model setups are as follows, <span class="math display">\[\begin{eqnarray*}
P(Y_{ij}\leq k)&amp;=&amp;[1+\exp(-\theta_{k}-(\beta_1Group+\beta_2\mbox{Modified Rankin scale prior onset}+\beta_3time3\\
&amp;&amp;+\beta_4time6+\beta_5time12+\beta_6\mbox{Small vessel}+\beta_7\mbox{Large vessel or cardioembolic stroke}\\
&amp;&amp;+\beta_8 \mbox{Small vessel*group}+\beta_9\mbox{Large vessel or cardioembolic stroke*group})\\
&amp;&amp;-(\alpha_{k1}\mbox{Small vessel}+\alpha_{k2}\mbox{Large vessel or cardioembolic stroke})-b_i)]^{-1}.
\end{eqnarray*}\]</span> where <span class="math inline">\(k=1,\cdots,K-1\)</span>. <span class="math display">\[\begin{eqnarray*}
\lambda_1(t)&amp;=&amp;\lambda_{01}(t)\exp(\gamma_{11}Group+\gamma_{12}\mbox{Modified Rankin scale prior onset}\\
&amp;&amp;+\gamma_{13}\mbox{Small vessel}+\gamma_{14}\mbox{Large vessel or cardioembolic stroke}\\
&amp;&amp;+\gamma_{15} \mbox{Small vessel*group}+\gamma_{16}\mbox{Large vessel or cardioembolic stroke*group}+u_i)\\
\lambda_2(t)&amp;=&amp;\lambda_{02}(t)\exp(\gamma_{21}Group+\gamma_{22}\mbox{Modified Rankin scale prior onset}\\
&amp;&amp;+\gamma_{23}\mbox{Small vessel}+\gamma_{24}\mbox{Large vessel or cardioembolic stroke}\\
&amp;&amp;+\gamma_{25} \mbox{Small vessel*group}+\gamma_{26}\mbox{Large vessel or cardioembolic stroke*group}+\nu_2u_i),
\end{eqnarray*}\]</span></p>
<p>We first load the package and the data.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb19-2" title="2"><span class="kw">require</span>(JMcmprsk)</a>
<a class="sourceLine" id="cb19-3" title="3"><span class="kw">data</span>(ninds)</a>
<a class="sourceLine" id="cb19-4" title="4">yread &lt;-<span class="st"> </span>ninds[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span><span class="op">:</span><span class="dv">14</span>)]</a>
<a class="sourceLine" id="cb19-5" title="5">cread &lt;-<span class="st"> </span>ninds[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">6</span>, <span class="dv">10</span><span class="op">:</span><span class="dv">14</span>)]</a>
<a class="sourceLine" id="cb19-6" title="6">cread &lt;-<span class="st"> </span><span class="kw">unique</span>(cread)</a></code></pre></div>
<p>Next, the model can be specified by the function jmo():</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1">jmofit &lt;-<span class="st"> </span><span class="kw">jmo</span>(yread, cread, <span class="dt">out =</span> <span class="st">&quot;Y&quot;</span>,</a>
<a class="sourceLine" id="cb20-2" title="2">            <span class="dt">FE =</span> <span class="kw">c</span>(<span class="st">&quot;group&quot;</span>, <span class="st">&quot;time3&quot;</span>, <span class="st">&quot;time6&quot;</span>, <span class="st">&quot;time12&quot;</span>, <span class="st">&quot;mrkprior&quot;</span>,</a>
<a class="sourceLine" id="cb20-3" title="3">                   <span class="st">&quot;smlves&quot;</span>, <span class="st">&quot;lvORcs&quot;</span>, <span class="st">&quot;smlves.group&quot;</span>, <span class="st">&quot;lvORcs.group&quot;</span>),</a>
<a class="sourceLine" id="cb20-4" title="4">            <span class="dt">cate =</span> <span class="ot">NULL</span>,<span class="dt">RE =</span> <span class="st">&quot;intercept&quot;</span>, <span class="dt">NP =</span> <span class="kw">c</span>(<span class="st">&quot;smlves&quot;</span>, <span class="st">&quot;lvORcs&quot;</span>), </a>
<a class="sourceLine" id="cb20-5" title="5">            <span class="dt">ID =</span> <span class="st">&quot;ID&quot;</span>,<span class="dt">intcpt =</span> <span class="dv">1</span>, <span class="dt">quad.points =</span> <span class="dv">20</span>, </a>
<a class="sourceLine" id="cb20-6" title="6">            <span class="dt">max.iter =</span> <span class="dv">1000</span>, <span class="dt">quiet =</span> <span class="ot">FALSE</span>, <span class="dt">do.trace =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb20-7" title="7">jmofit</a></code></pre></div>
<p>We can also call the internal function jmo_0() to get the same model fit. Below is the illustrative example of using the same dataset.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">require</span>(JMcmprsk)</a>
<a class="sourceLine" id="cb21-2" title="2"><span class="kw">data</span>(ninds)</a>
<a class="sourceLine" id="cb21-3" title="3">yread &lt;-<span class="st"> </span>ninds[, <span class="kw">c</span>(<span class="dv">2</span><span class="op">:</span><span class="dv">14</span>)]</a>
<a class="sourceLine" id="cb21-4" title="4">mread &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(<span class="kw">table</span>(ninds<span class="op">$</span>ID))</a>
<a class="sourceLine" id="cb21-5" title="5">mread &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(mread[, <span class="dv">2</span>])</a>
<a class="sourceLine" id="cb21-6" title="6">cread &lt;-<span class="st"> </span>ninds[, <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">15</span>, <span class="dv">16</span>, <span class="dv">6</span>, <span class="dv">10</span><span class="op">:</span><span class="dv">14</span>)]</a>
<a class="sourceLine" id="cb21-7" title="7">cread &lt;-<span class="st"> </span><span class="kw">unique</span>(cread)</a>
<a class="sourceLine" id="cb21-8" title="8">cread &lt;-<span class="st"> </span>cread[, <span class="dv">-1</span>]</a></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">jmofit &lt;-<span class="st"> </span><span class="kw">jmo_0</span>(<span class="dt">p=</span><span class="dv">9</span>,<span class="dt">s=</span><span class="dv">2</span>, yread,cread,mread,<span class="dt">point=</span><span class="dv">6</span>,<span class="dt">do.trace =</span> <span class="ot">FALSE</span>, <span class="dt">type_file =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb22-2" title="2">jmofit</a></code></pre></div>
<p>with <span class="math inline">\(p\)</span> the dimension of proportional odds covariates (not including intercept) in yread and <span class="math inline">\(s\)</span> the dimension of non-proportional odds covariates in yread. If we would like to see a concise summary of the result we can simply type</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1"><span class="co">#because of the long running time, we save the jmo and jmc results within the package</span></a>
<a class="sourceLine" id="cb23-2" title="2">fitfile=<span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="st">&quot;runfit.RData&quot;</span>, <span class="dt">package =</span> <span class="st">&quot;JMcmprsk&quot;</span>)</a>
<a class="sourceLine" id="cb23-3" title="3"><span class="kw">load</span>(fitfile)</a>
<a class="sourceLine" id="cb23-4" title="4">jmofit</a></code></pre></div>
<pre><code>## 
## Call:
##  jmo(long_data = yread, surv_data = cread, out = &quot;Y&quot;, FE = c(&quot;group&quot;, &quot;time3&quot;, &quot;time6&quot;, &quot;time12&quot;, &quot;mrkprior&quot;, &quot;smlves&quot;, &quot;lvORcs&quot;, &quot;smlves.group&quot;, &quot;lvORcs.group&quot;), RE = &quot;intercept&quot;, NP = c(&quot;smlves&quot;, &quot;lvORcs&quot;), ID = &quot;ID&quot;, cate = NULL, intcpt = 1, quad.points = 20, max.iter = 1000, quiet = FALSE, do.trace = FALSE) 
## 
## Data Summary:
## Number of observations: 1906 
## Number of groups: 587 
## 
## Proportion of competing risks: 
## Risk 1 : 32.88 %
## Risk 2 : 4.26 %
## 
## Numerical intergration:
## Method: Standard Guass-Hermite quadrature
## Number of quadrature points:  20 
## 
## Model Type: joint modeling of longitudinal ordinal and competing risks data 
## 
## Model summary:
## Longitudinal process: partial proportional odds model
## Event process: cause-specific Cox proportional hazard model with unspecified baseline hazard
## 
## Loglikelihood:  -2292.271 
## 
## Longitudinal sub-model proportional odds:  Y ~ group + time3 + time6 + time12 + mrkprior + smlves + lvORcs + smlves.group + lvORcs.group 
## Longitudinal sub-model non-proportional odds: smlves_NP + lvORcs_NP 
## 
##                   Estimate   Std. Error       95% CI            Pr(&gt;|Z|)    
## Longitudinal:                
##  Fixed effects:                 
##   proportional odds:
##   group          1.6053       0.1905      ( 1.2319, 1.9786)      0.0000    
##   time3          2.5132       0.1934      ( 2.1341, 2.8923)      0.0000    
##   time6          2.6980       0.1962      ( 2.3134, 3.0825)      0.0000    
##   time12         2.9415       0.2004      ( 2.5486, 3.3344)      0.0000    
##   mrkprior       -2.1815      0.2167      (-2.6063,-1.7567)      0.0000    
##   smlves         6.4358       0.4228      ( 5.6072, 7.2644)      0.0000    
##   lvORcs         -1.2907      0.2861      (-1.8515,-0.7300)      0.0000    
##   smlves.group   0.4903       0.7498      (-0.9793, 1.9598)      0.5132    
##   lvORcs.group   -3.2277      0.4210      (-4.0528,-2.4026)      0.0000    
##   Non-proportional odds:
##   smlves_NP_2    0.2725       0.4485      (-0.6066, 1.1515)      0.5435    
##   lvORcs_NP_2    -0.4528      0.2466      (-0.9362, 0.0305)      0.0663    
##   smlves_NP_3    1.7844       1.0613      (-0.2958, 3.8645)      0.0927    
##   lvORcs_NP_3    -0.1364      0.4309      (-0.9809, 0.7081)      0.7516    
##   Logit-specific intercepts: 
##   theta1         -6.2336      0.1722      (-6.5712,-5.8960)      0.0000    
##   theta2         -4.1911      0.1561      (-4.4971,-3.8851)      0.0000    
##   theta3         3.9806       0.1896      ( 3.6091, 4.3522)      0.0000    
## 
## Survival sub-model fixed effects:  Surv(surv, comprisk) ~ group + mrkprior + smlves + lvORcs + smlves.group + lvORcs.group 
## 
##                   Estimate   Std. Error       95% CI            Pr(&gt;|Z|)    
## Survival:                
##  Fixed effects:                 
##   group_1        -0.4630      0.2434      (-0.9400, 0.0140)      0.0571    
##   mrkprior_1     0.5874       0.1371      ( 0.3187, 0.8560)      0.0000    
##   smlves_1       -2.5570      0.7223      (-3.9728,-1.1413)      0.0004    
##   lvORcs_1       0.5992       0.2485      ( 0.1120, 1.0863)      0.0159    
##   smlves.group_1 -0.4990      1.4257      (-3.2934, 2.2955)      0.7264    
##   lvORcs.group_1 1.1675       0.4692      ( 0.2479, 2.0871)      0.0128    
##   group_2        0.2087       0.4834      (-0.7388, 1.1562)      0.6659    
##   mrkprior_2     0.0616       0.4277      (-0.7766, 0.8998)      0.8854    
##   smlves_2       0.7758       0.6217      (-0.4428, 1.9943)      0.2121    
##   lvORcs_2       -0.3256      0.5120      (-1.3291, 0.6778)      0.5247    
##   smlves.group_2 -0.0437      1.1573      (-2.3120, 2.2245)      0.9699    
##   lvORcs.group_2 0.0991       1.0718      (-2.0015, 2.1998)      0.9263    
## 
## Association prameter:                 
##   v2             0.0101       0.1595      (-0.3025, 0.3227)      0.9496    
## 
## Random effects:                 
##   sigma_b11      55.6404       5.6560      ( 44.5547, 66.7261)      0.0000    
##   sigma_u        6.6598       1.7196      ( 3.2894, 10.0303)      0.0001    
##  Covariance:                 
##   sigma_b1u      -19.2452      0.7730      (-20.7602,-17.7302)      0.0000</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="co">##extract the parameter estimates of longitudinal proportional odds fixed effects</span></a>
<a class="sourceLine" id="cb25-2" title="2">beta &lt;-<span class="st"> </span><span class="kw">coef</span>(jmofit, <span class="dt">coeff =</span> <span class="st">&quot;beta&quot;</span>)</a>
<a class="sourceLine" id="cb25-3" title="3">beta</a></code></pre></div>
<pre><code>##        group        time3        time6       time12     mrkprior       smlves 
##    1.6052525    2.5132318    2.6979598    2.9415109   -2.1815040    6.4357680 
##       lvORcs smlves.group lvORcs.group 
##   -1.2907438    0.4902711   -3.2276972</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1"><span class="co">##extract the parameter estimates of longitudinal non-proportional odds fixed effects</span></a>
<a class="sourceLine" id="cb27-2" title="2">alpha &lt;-<span class="st"> </span><span class="kw">coef</span>(jmofit, <span class="dt">coeff =</span> <span class="st">&quot;alpha&quot;</span>)</a>
<a class="sourceLine" id="cb27-3" title="3">alpha</a></code></pre></div>
<pre><code>##      smlves_NP  lvORcs_NP
## [1,] 0.2724605 -0.4528214
## [2,] 1.7843743 -0.1363731</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="co">##extract the parameter estimates of longitudinal logit-specific intercept</span></a>
<a class="sourceLine" id="cb29-2" title="2">theta &lt;-<span class="st"> </span><span class="kw">coef</span>(jmofit, <span class="dt">coeff =</span> <span class="st">&quot;theta&quot;</span>)</a>
<a class="sourceLine" id="cb29-3" title="3">theta</a></code></pre></div>
<pre><code>## [1] -6.233618 -4.191114  3.980638</code></pre>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co">##extract the parameter estimates of survival fixed effects</span></a>
<a class="sourceLine" id="cb31-2" title="2">gamma &lt;-<span class="st"> </span><span class="kw">coef</span>(jmofit, <span class="dt">coeff =</span> <span class="st">&quot;gamma&quot;</span>)</a>
<a class="sourceLine" id="cb31-3" title="3">gamma</a></code></pre></div>
<pre><code>##           group   mrkprior     smlves     lvORcs smlves.group lvORcs.group
## [1,] -0.4629623 0.58738262 -2.5570430  0.5991513  -0.49896915   1.16751407
## [2,]  0.2087199 0.06161447  0.7757617 -0.3256335  -0.04372659   0.09914707</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="co">## Linear hypothesis of testing all coefficients of beta&#39;s / gamma&#39;s / alpha&#39;s equal 0</span></a>
<a class="sourceLine" id="cb33-2" title="2"><span class="kw">linearTest</span>(jmofit,<span class="dt">coeff=</span><span class="st">&quot;beta&quot;</span>)</a></code></pre></div>
<pre><code>##              Chisq df Pr(&gt;|Chi|)
## L*beta=Cb 1096.991  9 0.0000</code></pre>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="kw">linearTest</span>(jmofit,<span class="dt">coeff=</span><span class="st">&quot;gamma&quot;</span>)</a></code></pre></div>
<pre><code>##               Chisq df Pr(&gt;|Chi|)
## L*gamma=Cg 47.15038 12 0.0000</code></pre>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1"><span class="kw">linearTest</span>(jmofit,<span class="dt">coeff=</span><span class="st">&quot;alpha&quot;</span>)</a></code></pre></div>
<pre><code>##               Chisq df Pr(&gt;|Chi|)
## L*alpha=Ca 8.776262  4 0.0669</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1"><span class="co">## Extract the standard errors of both longitudinal and survival portions</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="kw">summary</span>(jmofit, <span class="dt">coeff =</span> <span class="st">&quot;longitudinal&quot;</span>)</a></code></pre></div>
<pre><code>##    Longitudinal    coef     SE 95%Lower 95%Upper p-values
## 1         group  1.6053 0.1905   1.2319   1.9786   0.0000
## 2         time3  2.5132 0.1934   2.1341   2.8923   0.0000
## 3         time6  2.6980 0.1962   2.3134   3.0825   0.0000
## 4        time12  2.9415 0.2004   2.5486   3.3344   0.0000
## 5      mrkprior -2.1815 0.2167  -2.6063  -1.7567   0.0000
## 6        smlves  6.4358 0.4228   5.6072   7.2644   0.0000
## 7        lvORcs -1.2907 0.2861  -1.8515  -0.7300   0.0000
## 8  smlves.group  0.4903 0.7498  -0.9793   1.9598   0.5132
## 9  lvORcs.group -3.2277 0.4210  -4.0528  -2.4026   0.0000
## 10  smlves_NP_2  0.2725 0.4485  -0.6066   1.1515   0.5435
## 11  lvORcs_NP_2 -0.4528 0.2466  -0.9362   0.0305   0.0663
## 12  smlves_NP_3  1.7844 1.0613  -0.2958   3.8645   0.0927
## 13  lvORcs_NP_3 -0.1364 0.4309  -0.9809   0.7081   0.7516
## 14       theta1 -6.2336 0.1722  -6.5712  -5.8960   0.0000
## 15       theta2 -4.1911 0.1561  -4.4971  -3.8851   0.0000
## 16       theta3  3.9806 0.1896   3.6091   4.3522   0.0000</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1"><span class="kw">summary</span>(jmofit, <span class="dt">coeff =</span> <span class="st">&quot;survival&quot;</span>)</a></code></pre></div>
<pre><code>##          Survival    coef exp(coef) SE(coef) 95%Lower 95%Upper p-values
## 1         group_1 -0.4630    0.6294   0.2434  -0.9400   0.0140   0.0571
## 2      mrkprior_1  0.5874    1.7993   0.1371   0.3187   0.8560   0.0000
## 3        smlves_1 -2.5570    0.0775   0.7223  -3.9728  -1.1413   0.0004
## 4        lvORcs_1  0.5992    1.8206   0.2485   0.1120   1.0863   0.0159
## 5  smlves.group_1 -0.4990    0.6072   1.4257  -3.2934   2.2955   0.7264
## 6  lvORcs.group_1  1.1675    3.2140   0.4692   0.2479   2.0871   0.0128
## 7         group_2  0.2087    1.2321   0.4834  -0.7388   1.1562   0.6659
## 8      mrkprior_2  0.0616    1.0636   0.4277  -0.7766   0.8998   0.8854
## 9        smlves_2  0.7758    2.1722   0.6217  -0.4428   1.9943   0.2121
## 10       lvORcs_2 -0.3256    0.7221   0.5120  -1.3291   0.6778   0.5247
## 11 smlves.group_2 -0.0437    0.9572   1.1573  -2.3120   2.2245   0.9699
## 12 lvORcs.group_2  0.0991    1.1042   1.0718  -2.0015   2.1998   0.9263</code></pre>
</div>
<div id="references" class="section level1 unnumbered">
<h1>References</h1>
<div id="refs" class="references">
<div id="ref-MR2526626">
<p>Elashoff, Robert M., Gang Li, and Ning Li. 2008. “A Joint Model for Longitudinal Measurements and Survival Data in the Presence of Multiple Failure Types.” <em>Biometrics</em> 64 (3): 762–71. <a href="https://doi.org/10.1111/j.1541-0420.2007.00952.x">https://doi.org/10.1111/j.1541-0420.2007.00952.x</a>.</p>
</div>
<div id="ref-stroke1995tissue">
<p>Group, Stroke Study. 1995. “Tissue Plasminogen Activator for Acute Ischemic Stroke.” <em>N Eng J Med.</em> 333: 1581–7.</p>
</div>
<div id="ref-MR2758452">
<p>Li, Ning, Robert M. Elashoff, Gang Li, and Jeffrey Saver. 2010. “Joint Modeling of Longitudinal Ordinal Data and Competing Risks Survival Times and Analysis of the NINDS Rt-PA Stroke Trial.” <em>Stat. Med.</em> 29 (5): 546–57. <a href="https://doi.org/10.1002/sim.3798">https://doi.org/10.1002/sim.3798</a>.</p>
</div>
<div id="ref-tashkin2006cyclophosphamide">
<p>Tashkin, Donald P, Robert Elashoff, Philip J Clements, Jonathan Goldin, Michael D Roth, Daniel E Furst, Edgar Arriola, et al. 2006. “Cyclophosphamide Versus Placebo in Scleroderma Lung Disease.” <em>New England Journal of Medicine</em> 354 (25): 2655–66.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
