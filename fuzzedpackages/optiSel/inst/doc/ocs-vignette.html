<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Robin Wellmann" />

<meta name="date" content="2020-03-12" />

<title>3. Optimum Contribution Selection</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">3. Optimum Contribution Selection</h1>
<h4 class="author">Robin Wellmann</h4>
<h4 class="date">2020-03-12</h4>



<p>The aim of optimum contribution selection (OCS) is to find the optimum number of offspring for each breeding animal and to determine if a young animal (a selection candidate) should be selected for breeding or not. This is done in an optimal way, i.e. in a way that ensures that genetic gain is achieved, and that genetic diversity and genetic originality of the population are maintained or recovered. It can be based either on pedigree data or on marker data, whereby the latter approach is recommended. It requires that data is available from a sample of the population which includes the selection candidates.</p>
<p>OCS can be done for populations with overlapping and non-overlapping generations. For OCS with overlapping generations, the percentage which each age class represents in the population must be defined, and the data set should contain individuals from all age classes with non-zero contribution.</p>
<p>Even if the frequency of use of breeding animals is not regulated by the breeding organization, running the optimization still provides valuable information for a breeder, as the animals with highest optimum contributions are most valuable for a breeding program.</p>
<p>This vignette is organized as follows:</p>
<ul>
<li><a href="#example-data-set">Example Data Set</a></li>
<li><a href="#introductory-example-traditional-ocs">Introductory Example: Traditional OCS</a></li>
<li><a href="#defining-the-objective-of-a-breeding-program">Defining the Objective of a Breeding Program</a></li>
<li><a href="#marker-based-ocs">Marker-based OCS</a> - <a href="#maximize-genetic-gain-marker-based">Maximize Genetic Gain</a> - <a href="#minimize-inbreeding-marker-based">Minimize Inbreeding</a> - <a href="#recover-the-native-genetic-background-marker-based">Recover the Native Genetic Background</a> - <a href="#increase-diversity-between-breeds">Increase Diversity Between Breeds</a></li>
<li><a href="#pedigree-based-ocs">Pedigree-based OCS</a> - <a href="#maximize-genetic-gain-pedigree-based">Maximize Genetic Gain</a> - <a href="#minimize-inbreeding-pedigree-based">Minimize Inbreeding</a> - <a href="#recover-the-native-genetic-background-pedigree-based">Recover the Native Genetic Background</a></li>
</ul>
<div id="example-data-set" class="section level2">
<h2>Example Data Set</h2>
<p>All evaluations using marker data are demonstrated at the example of cattle data included in the package. This multi-breed data has already been described in the <a href="seg-vignette.html">companion vignette for basic marker-based evaluations</a>.</p>
<p>Data frame <code>Cattle</code> includes simulated phenotypic information and has columns <code>Indiv</code> (individual IDs), <code>Born</code> (years of birth), <code>Breed</code> (breed names), <code>BV</code> (breeding values), <code>Sex</code> (sexes), and <code>herd</code> (herds).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw">library</span>(<span class="st">&quot;optiSel&quot;</span>)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">data</span>(Cattle)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">head</span>(Cattle)</span></code></pre></div>
<pre><code>##           Indiv Born  Breed         BV    Sex herd
## Angler1 Angler1 1991 Angler -1.0706066   male &lt;NA&gt;
## Angler2 Angler2 1994 Angler -0.3362574 female    2
## Angler3 Angler3 1986 Angler -2.0735649 female    1
## Angler4 Angler4 1987 Angler  1.5968307   male &lt;NA&gt;
## Angler5 Angler5 1994 Angler  1.0023969   male &lt;NA&gt;
## Angler6 Angler6 1998 Angler -0.2426676   male &lt;NA&gt;</code></pre>
<p>The data frame contains information on the 4 breeds Angler, Fleckvieh, Holstein, Rotbunt. The “Angler” is an endangered German cattle breed, which had been upgraded with Red Holstein (also called “Rotbunt”). The Rotbunt cattle are a subpopulation of the “Holstein” breed. The “Fleckvieh” or Simmental breed is unrelated to the Angler. The Angler cattle are the selection candidates.</p>
<p>This small example data set contains only genotypes from the first parts of the first two chromosomes. Vector <code>GTfiles</code> defined below contains the names of the genotype files. There is one file for each chromosome. Data frame <code>map</code> contains the marker map and has columns <code>Name</code> (marker name), <code>Chr</code> (chromosome number), <code>Position</code>, <code>Mb</code> (position in Mega base pairs), and <code>cM</code> (position in centiMorgan):</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">data</span>(map)</span>
<span id="cb3-2"><a href="#cb3-2"></a>dir     &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">&quot;extdata&quot;</span>, <span class="dt">package=</span><span class="st">&quot;optiSel&quot;</span>)</span>
<span id="cb3-3"><a href="#cb3-3"></a>GTfiles &lt;-<span class="st"> </span><span class="kw">file.path</span>(dir, <span class="kw">paste</span>(<span class="st">&quot;Chr&quot;</span>, <span class="kw">unique</span>(map<span class="op">$</span>Chr), <span class="st">&quot;.phased&quot;</span>, <span class="dt">sep=</span><span class="st">&quot;&quot;</span>))</span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="kw">head</span>(map)</span></code></pre></div>
<pre><code>##                                    Name Chr Position cM       Mb
## ARS-BFGL-NGS-16466   ARS-BFGL-NGS-16466   1   267940  0 0.267940
## ARS-BFGL-NGS-98142   ARS-BFGL-NGS-98142   1   471078  0 0.471078
## ARS-BFGL-NGS-114208 ARS-BFGL-NGS-114208   1   533815  0 0.533815
## ARS-BFGL-NGS-65067   ARS-BFGL-NGS-65067   1   883895  0 0.883895
## ARS-BFGL-BAC-32722   ARS-BFGL-BAC-32722   1   929617  0 0.929617
## ARS-BFGL-BAC-34682   ARS-BFGL-BAC-34682   1   950841  0 0.950841</code></pre>
</div>
<div id="introductory-example-traditional-ocs" class="section level2">
<h2>Introductory Example: Traditional OCS</h2>
<p>As an introductory example consider traditional OCS with marker based kinship matrices. All alternative approaches involve the same steps, so it is recommended to read this section even if you want to minimize inbreeding instead of maximizing genetic gain. The following steps are involved:</p>
<p>For populations with overlapping generations you need to define the percentage which each age class represents in the population. One possibility is to assume that the percentage represented by a class is proportional to the percentage of offspring that is not yet born. Moreover, males and females (excluding newborn individuals) should be equally represented. These percentages can be estimated with function agecont from pedigree data. Since pedigree data is not available for this data set, the percentages are entered by hand:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>cont  &lt;-<span class="st"> </span><span class="kw">data.frame</span>(</span>
<span id="cb5-2"><a href="#cb5-2"></a>  <span class="dt">age   =</span> <span class="kw">c</span>(   <span class="dv">1</span>,    <span class="dv">2</span>,    <span class="dv">3</span>,    <span class="dv">4</span>,    <span class="dv">5</span>,    <span class="dv">6</span>,    <span class="dv">7</span>,   <span class="dv">8</span>,    <span class="dv">9</span>,    <span class="dv">10</span>), </span>
<span id="cb5-3"><a href="#cb5-3"></a>  <span class="dt">male  =</span> <span class="kw">c</span>(<span class="fl">0.14</span>, <span class="fl">0.14</span>, <span class="fl">0.09</span>, <span class="fl">0.04</span>, <span class="fl">0.03</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.02</span>, <span class="fl">0.01</span>, <span class="fl">0.01</span>),</span>
<span id="cb5-4"><a href="#cb5-4"></a>  <span class="dt">female=</span> <span class="kw">c</span>(<span class="fl">0.08</span>, <span class="fl">0.08</span>, <span class="fl">0.07</span>, <span class="fl">0.06</span>, <span class="fl">0.05</span>, <span class="fl">0.04</span>, <span class="fl">0.03</span>, <span class="fl">0.02</span>, <span class="fl">0.02</span>, <span class="fl">0.02</span>))</span></code></pre></div>
<p>One age class spans one year and the individuals born in the current year are in age class 1. Note that in this example young male classes have higher percentages than young female classes because males were used for breeding at an earlier age. The generation interval in years is approximately</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>L &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">4</span><span class="op">*</span>cont<span class="op">$</span>male[<span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">4</span><span class="op">*</span>cont<span class="op">$</span>female[<span class="dv">1</span>])</span>
<span id="cb6-2"><a href="#cb6-2"></a>L</span></code></pre></div>
<pre><code>## [1] 4.910714</code></pre>
<p>Define a data frame containing the phenotypes of a sample from the population which includes the selection candidates. Make sure that there is one column for each trait that should be improved. Logical column <code>isCandidate</code> is appended indicating the individuals available as selection candidates.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>phen &lt;-<span class="st"> </span>Cattle[Cattle<span class="op">$</span>Breed<span class="op">==</span><span class="st">&quot;Angler&quot;</span>,]</span>
<span id="cb8-2"><a href="#cb8-2"></a>phen<span class="op">$</span>isCandidate &lt;-<span class="st"> </span>phen<span class="op">$</span>Born<span class="op">&lt;=</span><span class="dv">2013</span></span></code></pre></div>
<p>Compute the kinships that are to be managed. Below, the kinship is named <code>sKin</code>, which is a shorthand for <em>segment based kinship</em>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>sKin &lt;-<span class="st"> </span><span class="kw">segIBD</span>(GTfiles, map)</span></code></pre></div>
<pre><code>## Using  skip = 2 
## Using cskip = 2 
## Reading chromosome 1 ...M=400
## Reading chromosome 2 ...M=400</code></pre>
<p>Create variable <code>cand</code> with function <a href="https://rdrr.io/cran/optiSel/man/candes.html">candes</a>, containing all information required to describe the selection candidates, which are the phenptypes and the kinships. The current values of the parameters in the population and the available objective functions and constraints for OCS are shown. Generations are defined to be non-overlapping if argument <code>cont</code> is omitted.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>cand  &lt;-<span class="st"> </span><span class="kw">candes</span>(<span class="dt">phen=</span>phen, <span class="dt">sKin=</span>sKin, <span class="dt">cont=</span>cont)</span></code></pre></div>
<pre><code>## Column &#39;Sire&#39; was missing. It is set to NA.
## Column &#39;Dam&#39; was missing. It is set to NA.
## The population is evaluated at time 2014
## 
##  Mean values of the parameters are:   Value 
##  for trait   &#39;BV&#39;   in Angler:       -0.0530
##  for kinship &#39;sKin&#39; in Angler:        0.0552
## 
##  Available objective functions and constraints:                   
##  for trait   &#39;BV&#39;   in Angler: min.BV, max.BV, lb.BV, eq.BV, ub.BV
##  for kinship &#39;sKin&#39; in Angler: min.sKin, ub.sKin                  
## 
##  ub  lb uniform</code></pre>
<p>For numeric columns in data frame <code>phen</code> the possibility is provided to define an upper bound (prefix <code>ub</code>), a lower bound (prefix <code>lb</code>), an equality constraint (prefix <code>eq</code>), or to minimize (prefix <code>min</code>) or to maximize (prefix <code>max</code>) the weighted sum of the values, whereby the weights are the contributions of the selection candidates. If the column contains breeding values, then this is the expected mean breeding value in the offspring.</p>
<p>For each kinship and native kinship included in the call of function candes, the possibility is provided to define an upper bound for the expected mean value of the kinship in the offspring (prefix <code>ub</code>), or to minimize the value (prefix <code>min</code>).</p>
<p>Constraints <code>ub</code> and <code>lb</code> allow to define upper bounds and lower bounds for the contributions of the selection candidates. Constraint <code>uniform</code> allows to assume that individuals belonging to specified groups have equal contributions.</p>
<p>Now choose the parameters you want to restrict and the parameters you want to optimize. For traditional OCs the objective is to maximize genetic gain with method <code>max.BV</code>, and to restrict the mean kinship in the offspring by defining constraint <code>ub.sKin</code>.</p>
<p>The upper bound for the mean kinship in the offspring should depend on the current mean kinship in the population, which is included in component <code>mean</code> of <code>cand</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>cand<span class="op">$</span>mean</span></code></pre></div>
<pre><code>##           BV       sKin
## 1 -0.0529632 0.05515035</code></pre>
<p>In general, if an upper bound for a kinship <span class="math inline">\(K\)</span> should be defined, it is recommended to derive the threshold value from the desired effective size <span class="math inline">\(N_e\)</span> of the population. If the OCS program started at time <span class="math inline">\(t_0\)</span>, then the upper bound for the mean kinship at time <span class="math inline">\(t\)</span> should be <span class="math display">\[ub.K=1-(1-\overline{K}_{t_0})\left(1-\frac{1}{2 N_e}\right)^{\frac{t-t_0}{L}},\]</span> where <span class="math inline">\(\overline{K}_{t_0}\)</span> is the mean kinship in the population at time <span class="math inline">\(t_0\)</span>, and <span class="math inline">\(L\)</span> is the generation interval. The critical effective size, i. e. the size below which the fitness of the population steadily decreases, depends on the population and is usually between 50 and 100. But there seems to be a consensus that 50-100 is a long-term viable effective size. To be on the safe side, an effective size of <span class="math inline">\(N_e=100\)</span> should be envisaged <span class="citation">(Meuwissen 2009)</span>.</p>
<p>A list containing the constraints is defined below.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>Ne &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb15-2"><a href="#cb15-2"></a></span>
<span id="cb15-3"><a href="#cb15-3"></a>con &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb15-4"><a href="#cb15-4"></a>  <span class="dt">uniform =</span> <span class="st">&quot;female&quot;</span>,</span>
<span id="cb15-5"><a href="#cb15-5"></a>  <span class="dt">ub.sKin =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>sKin)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L)</span>
<span id="cb15-6"><a href="#cb15-6"></a>)</span></code></pre></div>
<p>The component named <code>ub.sKin</code> defines the upper bound for the mean kinship <code>sKin</code> in the population in the next year. Component <code>uniform = &quot;female&quot;</code> states that all females from a particular age cohort should have equal contributions, so only the contributions of male selection candidates will be optimized. Upper and lower bounds for the contributions of selection candidates could be defined with <code>lb</code> and <code>ub</code> (see the help page of function <a href="https://rdrr.io/cran/optiSel/man/opticont.html">opticont</a>).</p>
<p>Now the optimum contributions of the selection candidates can be calculated:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>Offspring &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;max.BV&quot;</span>, cand, con, <span class="dt">trace=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## Using solver &#39;cccp2&#39; with parameters: 
##          Value
## trace        0
## abstol   1e-05
## feastol  1e-05
## stepadj    0.9
## maxiters   100
## reltol   1e-06
## beta       0.5
## 
##             valid solver  status
##              TRUE  cccp2 optimal
## 
##    Variable                  Value      Bound    OK?
##    --------------------------------------------------
##    BV                 Angler 0.26   max        :      
##    --------------------------------------------------
##    lower bounds              all x  &gt;=  lb     : TRUE 
##    upper bounds              all x  &lt;=  ub     : TRUE 
##    breed contribution Angler 1      ==  1      : TRUE 
##    sex contrib. diff. Angler 0      ==  0      : TRUE 
##    BV                 Angler 0.26              :      
##    sKin               Angler 0.0561 &lt;=  0.0561 : TRUE 
##    --------------------------------------------------</code></pre>
<p>The report above states that the solution is considered optimal by the solver and that all constraints are fulfilled since valid=TRUE. This information can also be obtained as</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>Offspring<span class="op">$</span>info</span></code></pre></div>
<pre><code>##   valid solver  status
## 1  TRUE  cccp2 optimal</code></pre>
<p>The value of the objective function can be accessed as</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>Offspring<span class="op">$</span>obj.fun</span></code></pre></div>
<pre><code>##        BV 
## 0.2599875</code></pre>
<p>and the expected average values of the kinshps and traits in the offspring are</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>Offspring<span class="op">$</span>mean</span></code></pre></div>
<pre><code>##          BV       sKin
## 1 0.2599875 0.05611446</code></pre>
<p>The results are OK. If they are not, then try to use another solver. The solver can be specified in parameter <code>solver</code> of function <a href="https://rdrr.io/cran/optiSel/man/opticont.html">opticont</a>. Available solvers are <code>&quot;alabama&quot;</code>, <code>&quot;cccp&quot;</code>, <code>&quot;cccp2&quot;</code>, and <code>&quot;slsqp&quot;</code>. By default the solver is chosen automatically. Alternatively, the same solver may be used but with different tuning parameters. The available paramters are displayed if the function <a href="https://rdrr.io/cran/optiSel/man/opticont.html">opticont</a> is called (as shown above).</p>
<p>The optimum contributions of the selection candidates are in component <code>parent</code>:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>Candidate &lt;-<span class="st"> </span>Offspring<span class="op">$</span>parent[,  <span class="kw">c</span>(<span class="st">&quot;Indiv&quot;</span>, <span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;oc&quot;</span>, <span class="st">&quot;herd&quot;</span>)]</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="kw">head</span>(Candidate[Candidate<span class="op">$</span>Sex<span class="op">==</span><span class="st">&quot;male&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Candidate<span class="op">$</span>oc<span class="op">&gt;</span><span class="fl">0.001</span>,])</span></code></pre></div>
<pre><code>##               Indiv  Sex        oc herd
## Angler147 Angler147 male 0.2874756 &lt;NA&gt;
## Angler166 Angler166 male 0.1357735 &lt;NA&gt;
## Angler171 Angler171 male 0.0766724 &lt;NA&gt;</code></pre>
<p>In general, since the number of females with offspring is large, we expect that about <span class="math inline">\(\frac{N_e}{4L}\approx 5\)</span> new males are selected each year. In the first year of OCS with overlapping generation often only very few individuals are selected for breeding. This changes in subsequent years and can be avoided by imposing upper bounds for the optimum contributions.</p>
<p>The numbers of offspring can be obtained from the optimum contributions and the size <code>N</code> of the offspring population with function <a href="https://rdrr.io/cran/optiSel/man/noffspring.html">noffspring</a>. These values are rounded up or down to whole numbers.</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>Candidate<span class="op">$</span>n &lt;-<span class="st"> </span><span class="kw">noffspring</span>(Candidate, <span class="dt">N=</span><span class="dv">20</span>)<span class="op">$</span>nOff</span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="kw">head</span>(Candidate[Candidate<span class="op">$</span>Sex<span class="op">==</span><span class="st">&quot;male&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Candidate<span class="op">$</span>oc<span class="op">&gt;</span><span class="fl">0.001</span>,])</span></code></pre></div>
<pre><code>##               Indiv  Sex        oc herd  n
## Angler147 Angler147 male 0.2874756 &lt;NA&gt; 11
## Angler166 Angler166 male 0.1357735 &lt;NA&gt;  6
## Angler171 Angler171 male 0.0766724 &lt;NA&gt;  3</code></pre>
<p>Males and females can be allocated for mating with function matings such that all breeding animals have the desired number of matings. In the example below the mean marker-based inbreeding coefficient in the offspring is minimized.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>Mating &lt;-<span class="st"> </span><span class="kw">matings</span>(Candidate, <span class="dt">Kin=</span>sKin)</span></code></pre></div>
<pre><code>## Optimal branch and bound solution found</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">head</span>(Mating)</span></code></pre></div>
<pre><code>##         Sire       Dam n
## 2  Angler166  Angler66 1
## 4  Angler147  Angler76 1
## 7  Angler147  Angler80 1
## 10 Angler147  Angler81 1
## 13 Angler147  Angler83 1
## 17 Angler166 Angler104 1</code></pre>
<p>The mean inbreeding in the offspring (which is equal to the mean kinship of the parents) is:</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="kw">attributes</span>(Mating)<span class="op">$</span>objval</span></code></pre></div>
<pre><code>## [1] 0.02484619</code></pre>
</div>
<div id="defining-the-objective-of-a-breeding-program" class="section level2">
<h2>Defining the Objective of a Breeding Program</h2>
<p>The objective of a breeding program depends on several factors. These are the intended use of the breed, the presence of historic bottlenecks, and the importance being placed on the maintenance of genetic originality. In most livestock breeds the focus is on increasing the economic merit, so the objective of the breeding program is to <em>maximize genetic gain</em>. In contrast, companion animals often suffer from historic bottlenecks due to an overuse of popular sires. Hence, in these breeds the objective is to <em>minimize inbreeding</em>. In endangered breeds, which get subsidies for conservation, the focus may be on increasing their conservation values by <em>recovering the native genetic background</em> or by <em>increasing the genetic distance to other breeds</em>.</p>
<p>However, these are conflicting objectives: For maximizing genetic gain, the animals with highest breeding values would be used for breeding, which may create a new bottleneck and contribute to inbreeding depression. Maximizing genetic gain would also favor the use of animals with high genetic contributions from commercial breeds because these animals often have the highest breeding values. But this would reduce the genetic originality of the breed. Minimizing inbreeding in the offspring favors the use of animals with high contributions from other breeds because they have low kinship with the population and it may require the use of outcross animals with breeding values below average.</p>
<p>Thus, focussing on only one aspect automatically worsens the other ones. This can be avoided by imposing constraints on the aspects that are not optimized.</p>
<p>In general, best practice is genotying all selection candidates to enable marker based evaluations. A breeding program based on marker information is more efficient than a breeding program based only on pedigree information, provided that the animals are genotyped for a sufficient number of markers. For several species, however, genotyping is still too expensive, so the breeding programs rely only on pedigree information.</p>
<p>Depending on what the objective of the breeding program is, you may continue reading at the appropriate section:</p>
<ul>
<li><a href="#marker-based-ocs">Marker-based OCS</a>
<ul>
<li>Maximize Genetic Gain</li>
<li>Minimize Inbreeding</li>
<li>Recover the Native Genetic Background</li>
<li>Increase Diversity Between Breeds</li>
</ul></li>
<li><a href="#pedigree-based-ocs">Pedigree-based OCS</a>
<ul>
<li>Maximize Genetic Gain</li>
<li>Minimize Inbreeding]</li>
<li>Recover the Native Genetic Background</li>
</ul></li>
</ul>
</div>
<div id="marker-based-ocs" class="section level2">
<h2>Marker-based OCS</h2>
<p>The required genotype file format, the marker map, the parameters <code>minSNP</code>, <code>minL</code>, <code>unitL</code>, <code>unitP</code>, and <code>ubFreq</code>, which are used for estimating the <em>segment based kinship</em>, the <em>kinships at native haplotype segments</em>, and the <em>breed composition</em>, have been described in the <a href="seg-vignette.html">companion vignette for basic marker-based evaluations</a>.</p>
<p>The <em>breed composition</em> of individuals can be estimated with function <a href="https://rdrr.io/cran/optiSel/man/segBreedComp.html">segBreedComp</a>. Since native contributions <code>NC</code> of the Angler cattle should be considered, they are computed and added as an additional column to data frame <code>Cattle</code>.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a>wdir  &lt;-<span class="st"> </span><span class="kw">file.path</span>(<span class="kw">tempdir</span>(), <span class="st">&quot;HaplotypeEval&quot;</span>)</span>
<span id="cb34-2"><a href="#cb34-2"></a>wfile &lt;-<span class="st"> </span><span class="kw">haplofreq</span>(GTfiles, Cattle, map, <span class="dt">thisBreed=</span><span class="st">&quot;Angler&quot;</span>, <span class="dt">minL=</span><span class="fl">1.0</span>, <span class="dt">w.dir=</span>wdir)</span>
<span id="cb34-3"><a href="#cb34-3"></a>Comp  &lt;-<span class="st"> </span><span class="kw">segBreedComp</span>(wfile<span class="op">$</span>match, map)</span>
<span id="cb34-4"><a href="#cb34-4"></a>Cattle[<span class="kw">rownames</span>(Comp), <span class="st">&quot;NC&quot;</span>] &lt;-<span class="st"> </span>Comp<span class="op">$</span>native</span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1"></a><span class="kw">head</span>(Cattle[,<span class="op">-</span><span class="dv">1</span>])</span></code></pre></div>
<pre><code>##         Born  Breed         BV    Sex herd        NC
## Angler1 1991 Angler -1.0706066   male &lt;NA&gt; 0.5805690
## Angler2 1994 Angler -0.3362574 female    2 0.5687157
## Angler3 1986 Angler -2.0735649 female    1 0.7418098
## Angler4 1987 Angler  1.5968307   male &lt;NA&gt; 0.4045441
## Angler5 1994 Angler  1.0023969   male &lt;NA&gt; 0.2239983
## Angler6 1998 Angler -0.2426676   male &lt;NA&gt; 0.2458519</code></pre>
<p>A matrix containing the <em>segment based kinship</em> between all pairs of individuals can be computed with function <a href="https://rdrr.io/cran/optiSel/man/segIBD.html">segIBD</a>, whereas the <em>kinships at native haplotype segments</em> can be calculated from the results of function <a href="https://rdrr.io/cran/optiSel/man/segIBDatN.html">segIBDatN</a>. Both kinships are computed below. These kinships and the phenotypes of the selection candidates are combined into a single R-object with function candes. This function computes also the current values of the parameters in the population and displays the available objective functions and constraints. Below, the <em>kinship at native haplotype segments</em> is named <code>sKinatN</code>:</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a>phen    &lt;-<span class="st"> </span>Cattle[Cattle<span class="op">$</span>Breed<span class="op">==</span><span class="st">&quot;Angler&quot;</span>,]</span>
<span id="cb37-2"><a href="#cb37-2"></a>phen<span class="op">$</span>isCandidate &lt;-<span class="st"> </span>phen<span class="op">$</span>Born<span class="op">&lt;=</span><span class="dv">2013</span></span>
<span id="cb37-3"><a href="#cb37-3"></a></span>
<span id="cb37-4"><a href="#cb37-4"></a>sKin    &lt;-<span class="st"> </span><span class="kw">segIBD</span>(GTfiles, map, <span class="dt">minL=</span><span class="fl">1.0</span>)</span>
<span id="cb37-5"><a href="#cb37-5"></a>sKinatN &lt;-<span class="st"> </span><span class="kw">segIBDatN</span>(GTfiles, Cattle, map, <span class="dt">thisBreed=</span><span class="st">&quot;Angler&quot;</span>, <span class="dt">minL=</span><span class="fl">1.0</span>)</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a>cand  &lt;-<span class="st"> </span><span class="kw">candes</span>(<span class="dt">phen=</span>phen, <span class="dt">sKin=</span>sKin, <span class="dt">sKinatN=</span>sKinatN, <span class="dt">cont=</span>cont)</span></code></pre></div>
<pre><code>## Column &#39;Sire&#39; was missing. It is set to NA.
## Column &#39;Dam&#39; was missing. It is set to NA.
## The population is evaluated at time 2014
## 
##  Mean values of the parameters are:   Value 
##  for trait     &#39;BV&#39;      in Angler:  -0.0530
##  for trait     &#39;NC&#39;      in Angler:   0.4091
##  for kinship   &#39;sKin&#39;    in Angler:   0.0552
##  for nat. kin. &#39;sKinatN&#39; in Angler:   0.0770
## 
##  Available objective functions and constraints:                        
##  for trait     &#39;BV&#39;      in Angler: min.BV, max.BV, lb.BV, eq.BV, ub.BV
##  for trait     &#39;NC&#39;      in Angler: min.NC, max.NC, lb.NC, eq.NC, ub.NC
##  for kinship   &#39;sKin&#39;    in Angler: min.sKin, ub.sKin                  
##  for nat. kin. &#39;sKinatN&#39; in Angler: min.sKinatN, ub.sKinatN            
## 
##  ub  lb uniform</code></pre>
<p>Compared to the introductory example the possibility to restrict or to maximize native contributions became available because column <code>NC</code> was added to data frame <code>Cattle</code>. Additionally, the possibility to minimize or to restrict the kinship at native segments <code>sKinatN</code> became available since this kinship was used as an argument to function candes. The current mean values in the population are</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a>cand<span class="op">$</span>mean</span></code></pre></div>
<pre><code>##           BV        NC       sKin    sKinatN
## 1 -0.0529632 0.4090566 0.05515035 0.07701049</code></pre>
<p>Function <a href="https://rdrr.io/cran/optiSel/man/opticont.html">opticont</a> can now be used to perform the optimization.</p>
<p>Depending on what the objective of the breeding program is, you may continue reading at the appropriate section:</p>
<ul>
<li><a href="#maximize-genetic-gain-marker-based">Maximize Genetic Gain</a></li>
<li><a href="#minimize-inbreeding-marker-based">Minimize Inbreeding</a></li>
<li><a href="#recover-the-native-genetic-background-marker-based">Recover the Native Genetic Background</a></li>
<li><a href="#increase-diversity-between-breeds">Increase Diversity Between Breeds</a></li>
</ul>
<div id="maximize-genetic-gain" class="section level3">
<h3><a name="maximize-genetic-gain-marker-based"></a>Maximize Genetic Gain</a></h3>
<p>First we create a list of constraints:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a>con &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb42-2"><a href="#cb42-2"></a>  <span class="dt">uniform =</span> <span class="st">&quot;female&quot;</span>,</span>
<span id="cb42-3"><a href="#cb42-3"></a>  <span class="dt">ub.sKin =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>sKin)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L)</span>
<span id="cb42-4"><a href="#cb42-4"></a>  )</span></code></pre></div>
<p>Again, equal contributions are assumed for the females and only the contributions of males are to be optimized. The upper bound for the mean segment based kinship was derived from the effective population size as explained above. Now the optimum contributions of the selection candidates can be calculated:</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a>Offspring   &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;max.BV&quot;</span>, cand, con, <span class="dt">trace=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a>Offspring<span class="op">$</span>info</span></code></pre></div>
<pre><code>##   valid solver  status
## 1  TRUE  cccp2 optimal</code></pre>
<p>The expected values of the parameters in the next generation are</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>Offspring<span class="op">$</span>mean</span></code></pre></div>
<pre><code>##          BV        NC       sKin    sKinatN
## 1 0.2599875 0.4013466 0.05611446 0.08003438</code></pre>
<p>The results are the same as in the introductory example (as expected). This approach may be apppropriate for a population without introgression, but for populations with historic introgression, the kinship at native alleles should be restricted as well in accordance with the desired effective size, and the native contributions should be restricted in order not to decrease. Otherwise the genetic originality of the breed may get lost in the long term.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>con &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="dt">uniform    =</span><span class="st">&quot;female&quot;</span>,</span>
<span id="cb48-3"><a href="#cb48-3"></a>  <span class="dt">ub.sKin    =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>sKin)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L),</span>
<span id="cb48-4"><a href="#cb48-4"></a>  <span class="dt">ub.sKinatN =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>sKinatN)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L),</span>
<span id="cb48-5"><a href="#cb48-5"></a>  <span class="dt">lb.NC      =</span> cand<span class="op">$</span>mean<span class="op">$</span>NC</span>
<span id="cb48-6"><a href="#cb48-6"></a>  )</span>
<span id="cb48-7"><a href="#cb48-7"></a></span>
<span id="cb48-8"><a href="#cb48-8"></a>Offspring2 &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;max.BV&quot;</span>, cand, con)</span></code></pre></div>
<p>For comparison, the summaries of both scenarios are combined into a single data frame:</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="kw">rbind</span>(<span class="dt">Ref=</span>cand<span class="op">$</span>mean, <span class="dt">maxBV=</span>Offspring<span class="op">$</span>mean, <span class="dt">maxBV2=</span>Offspring2<span class="op">$</span>mean)</span></code></pre></div>
<pre><code>##                BV        NC       sKin    sKinatN
## Ref    -0.0529632 0.4090566 0.05515035 0.07701049
## maxBV   0.2599875 0.4013466 0.05611446 0.08003438
## maxBV2  0.2375770 0.4090579 0.05545872 0.07795296</code></pre>
<p>Since native contributions and breeding values are negatively correlated, the genetic gain decreases slightly when native contributions are constrained not to decrease.</p>
</div>
<div id="minimize-inbreeding" class="section level3">
<h3><a name="minimize-inbreeding-marker-based"></a>Minimize Inbreeding</a></h3>
<p>Minimizing inbreeding means to minimize the average kinship of the population in order to enable breeders to avoid inbreeding. This is the appropriate approach e.g. for companion animals suffering from a historic bottleneck. It can be done with or without accounting for breeding values. In the example below no breeding values are considered since accurate breeding values are not available for most of these breeds.</p>
<p>First we create a list of constraints:</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a>con  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">uniform=</span><span class="st">&quot;female&quot;</span>)</span></code></pre></div>
<p>Again, equal contributions are assumed for the females and only the contributions of males are to be optimized. The segment based kinship is not constrained in this example because it should be minimized.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>Offspring   &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;min.sKin&quot;</span>, cand, con)</span></code></pre></div>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1"></a><span class="kw">rbind</span>(cand<span class="op">$</span>mean, Offspring<span class="op">$</span>mean)</span></code></pre></div>
<pre><code>##           BV        NC       sKin    sKinatN
## 1 -0.0529632 0.4090566 0.05515035 0.07701049
## 2 -0.1413072 0.4320944 0.04878925 0.06388093</code></pre>
<p>Minimizing kinship without constraining the mean breeding value decreases the mean breeding value in the offspring slightly because the individuals with high breeding values are related. For this breed, it also increases the native contribution because the individuals from other breeds that were used for upgrading were related.</p>
<p>While in livestock breeds the native contributions should be restricted in order to maintain the genetic originality of the breeds, in several companion breeds the opposite is true. Several companion breeds have high inbreeding coefficients and descend from only very few (e.g. 3) founders <span class="citation">(Wellmann and Pfeiffer 2009)</span>, and purging seems to be not feasible. Hence, a sufficient genetic diversity of the population cannot be achieved in the population even if marker data is used to minimize inbreeding. For these breeds it may be appropriate to use unrelated individuals from a variety of other breeds in order to increase the genetic diversity. However, only a small contribution from other breeds is needed, so the native contributions should be restricted also for these breeds in order to preserve their genetic originality. Hence, the difference between a breed with high diversity and a breed with low diversity suffering from inbreeding depression is, that the optimum value for the native contribution is smaller than 1 for the latter.</p>
<p>For such a breed it is advisable to allow the use of unrelated individuals from other breeds but to restrict the admissible mean contribution from other breeds in the population. The mean kinship at native alleles should be restricted as well to require only a small amount of introgression:</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1"></a>con &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb55-2"><a href="#cb55-2"></a>  <span class="dt">uniform    =</span> <span class="st">&quot;female&quot;</span>,</span>
<span id="cb55-3"><a href="#cb55-3"></a>  <span class="dt">lb.NC      =</span> cand<span class="op">$</span>mean<span class="op">$</span>NC <span class="op">+</span><span class="st"> </span><span class="fl">0.04</span>,</span>
<span id="cb55-4"><a href="#cb55-4"></a>  <span class="dt">ub.sKinatN =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>sKinatN)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L)</span>
<span id="cb55-5"><a href="#cb55-5"></a>)</span>
<span id="cb55-6"><a href="#cb55-6"></a>Offspring2     &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;min.sKin&quot;</span>, cand, con)</span></code></pre></div>
<p>For comparison, the estimates for both scenarios are combined into a single data frame:</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">rbind</span>(<span class="dt">Ref=</span>cand<span class="op">$</span>mean, <span class="dt">minKin=</span>Offspring<span class="op">$</span>mean, <span class="dt">minKin2=</span>Offspring2<span class="op">$</span>mean)</span></code></pre></div>
<pre><code>##                 BV        NC       sKin    sKinatN
## Ref     -0.0529632 0.4090566 0.05515035 0.07701049
## minKin  -0.1413072 0.4320944 0.04878925 0.06388093
## minKin2 -0.1855771 0.4490567 0.05099124 0.07268120</code></pre>
<p>Of course, for a companion breed, the lower bound for the native contribution should be much higher.</p>
</div>
<div id="recover-the-native-genetic-background" class="section level3">
<h3><a name="recover-the-native-genetic-background-marker-based"></a>Recover the Native Genetic Background</a></h3>
<p>For endangered breeds the priority of a breeding program could be to recover the original genetic background by maximizing native contributions. However, since the individuals with highest native contributions are related, this may considerably increase the inbreeding coefficients if the diversity at native alleles is not preserved. Hence, constraints are defined below not only for the segment based kinship but also for the kinship at native segments in accordance with the desired effective size:</p>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a>con &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb58-2"><a href="#cb58-2"></a>  <span class="dt">uniform    =</span> <span class="st">&quot;female&quot;</span>,</span>
<span id="cb58-3"><a href="#cb58-3"></a>  <span class="dt">ub.sKin    =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>sKin)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L),</span>
<span id="cb58-4"><a href="#cb58-4"></a>  <span class="dt">ub.sKinatN =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>sKinatN)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L)</span>
<span id="cb58-5"><a href="#cb58-5"></a>)</span>
<span id="cb58-6"><a href="#cb58-6"></a>Offspring &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;max.NC&quot;</span>, cand, con)</span></code></pre></div>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>Offspring<span class="op">$</span>info</span></code></pre></div>
<pre><code>##   valid solver  status
## 1  TRUE  cccp2 optimal</code></pre>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>Offspring<span class="op">$</span>mean</span></code></pre></div>
<pre><code>##          BV        NC       sKin    sKinatN
## 1 -0.148259 0.4507987 0.05247014 0.07796462</code></pre>
<p>For this breed, maximizing native contributions results in negative genetic gain because native contributions and breeding values are negatively correlated. This can be avoided by adding an additional constraint for the breeding values:</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>con &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb63-2"><a href="#cb63-2"></a>  <span class="dt">uniform    =</span> <span class="st">&quot;female&quot;</span>,</span>
<span id="cb63-3"><a href="#cb63-3"></a>  <span class="dt">ub.sKin    =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>sKin)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L),</span>
<span id="cb63-4"><a href="#cb63-4"></a>  <span class="dt">ub.sKinatN =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>sKinatN)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L),</span>
<span id="cb63-5"><a href="#cb63-5"></a>  <span class="dt">lb.BV      =</span> cand<span class="op">$</span>mean<span class="op">$</span>BV</span>
<span id="cb63-6"><a href="#cb63-6"></a>)</span>
<span id="cb63-7"><a href="#cb63-7"></a></span>
<span id="cb63-8"><a href="#cb63-8"></a>Offspring2  &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;max.NC&quot;</span>, cand, con)</span></code></pre></div>
<p>For comparison, the estimated parameters of both scenarios are combined into a single data frame:</p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1"></a><span class="kw">rbind</span>(<span class="dt">Ref=</span>cand<span class="op">$</span>mean, <span class="dt">maxNC=</span>Offspring<span class="op">$</span>mean, <span class="dt">maxNC2=</span>Offspring2<span class="op">$</span>mean)</span></code></pre></div>
<pre><code>##                 BV        NC       sKin    sKinatN
## Ref    -0.05296320 0.4090566 0.05515035 0.07701049
## maxNC  -0.14825900 0.4507987 0.05247014 0.07796462
## maxNC2 -0.05295398 0.4489678 0.05236699 0.07795276</code></pre>
</div>
<div id="increase-diversity-between-breeds" class="section level3">
<h3>Increase Diversity Between Breeds</h3>
<p>While removing introgressed genetic material from the population is one possibility to increase the conservation value of an endangered breed, an alternative approach is to increase the genetic distance between the endangered breed and commercial breeds. In this case we do not care about whether alleles are native or not. We just want to accumulate haplotype segments which are rare in commercial breeds. This can be done with a core set approach.</p>
<p>In the core set approach, a hypothetical population is considered, consisting of individuals from various breeds. This population is called the core set. The contributions of each breed to the core set are such that the genetic diversity of the core set is maximized.</p>
<p>In the following example the parameter to be minimized is the mean kinship of individuals from the core set in the next generation. Constraint <code>uniform</code> defined below states that the contributions of the male selection candidates from the breed of interest are to be optimized, whereas individuals from all other breeds have uniform contributions.</p>
<p>Since the average kinship in a multi-breed population should be managed, argument <code>phen</code> of function cand contains individuals from all genotyped breeds. This was not the case in the above examples, where argument <code>phen</code> contained only the selection candidates.</p>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1"></a>Cattle<span class="op">$</span>isCandidate &lt;-<span class="st"> </span>Cattle<span class="op">$</span>Born<span class="op">&lt;=</span><span class="dv">2013</span></span>
<span id="cb66-2"><a href="#cb66-2"></a>cand &lt;-<span class="st"> </span><span class="kw">candes</span>(<span class="dt">phen=</span>Cattle, <span class="dt">sKin=</span>sKin, <span class="dt">sKinatN.Angler=</span>sKinatN, <span class="dt">bc=</span><span class="st">&quot;sKin&quot;</span>, <span class="dt">cont=</span>cont)</span></code></pre></div>
<pre><code>## Column &#39;Sire&#39; was missing. It is set to NA.
## Column &#39;Dam&#39; was missing. It is set to NA.
## The population is evaluated at time 2014
## 
##  Mean values of the parameters are:              Value 
##  for trait     &#39;NC&#39;             in Angler    :   0.4091
##  for trait     &#39;BV&#39;             across breeds:  -0.0684
##  for trait     &#39;BV.Angler&#39;      in Angler    :  -0.0530
##  for trait     &#39;BV.Holstein&#39;    in Holstein  :   0.0130
##  for trait     &#39;BV.Fleckvieh&#39;   in Fleckvieh :  -0.1136
##  for trait     &#39;BV.Rotbunt&#39;     in Rotbunt   :   0.0886
##  for kinship   &#39;sKin&#39;           across breeds:   0.0350
##  for nat. kin. &#39;sKinatN.Angler&#39; in Angler    :   0.0770
##  for kinship   &#39;sKin.Angler&#39;    in Angler    :   0.0552
##  for kinship   &#39;sKin.Holstein&#39;  in Holstein  :   0.1073
##  for kinship   &#39;sKin.Fleckvieh&#39; in Fleckvieh :   0.0686
##  for kinship   &#39;sKin.Rotbunt&#39;   in Rotbunt   :   0.1071
## 
##  Available objective functions and constraints:                                                                                     
##  for trait     &#39;NC&#39;             in Angler    : min.NC, max.NC, lb.NC, eq.NC, ub.NC                                                  
##  for trait     &#39;BV&#39;             across breeds: min.BV, max.BV, lb.BV, eq.BV, ub.BV                                                  
##  for trait     &#39;BV.Angler&#39;      in Angler    : min.BV.Angler, max.BV.Angler, lb.BV.Angler, eq.BV.Angler, ub.BV.Angler               
##  for trait     &#39;BV.Holstein&#39;    in Holstein  : min.BV.Holstein, max.BV.Holstein, lb.BV.Holstein, eq.BV.Holstein, ub.BV.Holstein     
##  for trait     &#39;BV.Fleckvieh&#39;   in Fleckvieh : min.BV.Fleckvieh, max.BV.Fleckvieh, lb.BV.Fleckvieh, eq.BV.Fleckvieh, ub.BV.Fleckvieh
##  for trait     &#39;BV.Rotbunt&#39;     in Rotbunt   : min.BV.Rotbunt, max.BV.Rotbunt, lb.BV.Rotbunt, eq.BV.Rotbunt, ub.BV.Rotbunt          
##  for kinship   &#39;sKin&#39;           across breeds: min.sKin, ub.sKin                                                                    
##  for nat. kin. &#39;sKinatN.Angler&#39; in Angler    : min.sKinatN.Angler, ub.sKinatN.Angler                                                
##  for kinship   &#39;sKin.Angler&#39;    in Angler    : min.sKin.Angler, ub.sKin.Angler                                                      
##  for kinship   &#39;sKin.Holstein&#39;  in Holstein  : min.sKin.Holstein, ub.sKin.Holstein                                                  
##  for kinship   &#39;sKin.Fleckvieh&#39; in Fleckvieh : min.sKin.Fleckvieh, ub.sKin.Fleckvieh                                                
##  for kinship   &#39;sKin.Rotbunt&#39;   in Rotbunt   : min.sKin.Rotbunt, ub.sKin.Rotbunt                                                    
## 
##  ub  lb uniform</code></pre>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a>mKin &lt;-<span class="st"> </span>cand<span class="op">$</span>mean<span class="op">$</span>sKinatN.Angler</span>
<span id="cb68-2"><a href="#cb68-2"></a>con  &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb68-3"><a href="#cb68-3"></a>  <span class="dt">uniform =</span> <span class="kw">c</span>(<span class="st">&quot;Angler.female&quot;</span>, <span class="st">&quot;Fleckvieh&quot;</span>, <span class="st">&quot;Holstein&quot;</span>, <span class="st">&quot;Rotbunt&quot;</span>), </span>
<span id="cb68-4"><a href="#cb68-4"></a>  <span class="dt">ub.sKinatN.Angler =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>mKin)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L)</span>
<span id="cb68-5"><a href="#cb68-5"></a>  )</span></code></pre></div>
<p>The upper bound for the mean native kinship was derived from the effective population size as explained above. Now the optimum contributions of the selection candidates can be calculated:</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a>Offspring &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;min.sKin&quot;</span>, cand, con, <span class="dt">trace=</span><span class="ot">FALSE</span>)</span></code></pre></div>
<pre><code>## 
## Using solver &#39;cccp&#39; with parameters: 
##          Value
## trace        0
## abstol   1e-05
## feastol  1e-05
## stepadj    0.9
## maxiters   100
## reltol   1e-06
## beta       0.5
## 
## A square matrix was approximated by a positive
##   definite matrix with relative distance 6e-04.
##             valid solver  status
##              TRUE   cccp optimal
## 
##    Variable                         Value      Bound    OK?
##    ---------------------------------------------------------
##    sKin               across breeds 0.0332 min        :      
##    ---------------------------------------------------------
##    lower bounds                     all x  &gt;=  lb     : TRUE 
##    upper bounds                     all x  &lt;=  ub     : TRUE 
##    breed contribution Angler        0.4791 ==  0.4791 : TRUE 
##    breed contribution Holstein      0.0443 ==  0.0443 : TRUE 
##    breed contribution Fleckvieh     0.4243 ==  0.4243 : TRUE 
##    breed contribution Rotbunt       0.0523 ==  0.0523 : TRUE 
##    sex contrib. diff. Angler        0      ==  0      : TRUE 
##    sex contrib. diff. Holstein      0      ==  0      : TRUE 
##    sex contrib. diff. Fleckvieh     0      ==  0      : TRUE 
##    sex contrib. diff. Rotbunt       0      ==  0      : TRUE 
##    NC                 Angler        0.4333            :      
##    BV                 across breeds -0.1166            :      
##    BV                 Angler        -0.1453            :      
##    BV                 Holstein      0.029             :      
##    BV                 Fleckvieh     -0.1244            :      
##    BV                 Rotbunt       0.0861            :      
##    sKin               across breeds 0.0332            :      
##    sKin               Angler        0.0488            :      
##    sKin               Holstein      0.1076            :      
##    sKin               Fleckvieh     0.0688            :      
##    sKin               Rotbunt       0.1079            :      
##    sKinatN            Angler        0.0639 &lt;=  0.078  : TRUE 
##    ---------------------------------------------------------</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>Offspring<span class="op">$</span>info</span></code></pre></div>
<pre><code>##   valid solver  status
## 1  TRUE   cccp optimal</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a>Offspring<span class="op">$</span>mean</span></code></pre></div>
<pre><code>##          NC         BV  BV.Angler BV.Holstein BV.Fleckvieh BV.Rotbunt      sKin
## 1 0.4333205 -0.1165914 -0.1453215  0.02899812    -0.124364 0.08612751 0.0331582
##   sKin.Angler sKin.Holstein sKin.Fleckvieh sKin.Rotbunt sKinatN.Angler
## 1  0.04883195     0.1075815     0.06882723     0.107866     0.06394063</code></pre>
<p>Since the contributions of the selection candidates minimize the mean kinship <code>sKin</code> in the core set, they maximize the genetic diversity of the core set. This is achieved by increasing the gentic diversity within the breed or by increasing the genetic distance between the breed of interest and the other breeds. The optimum contributions are standardized so that their sum is equal to one within each breed:</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="kw">head</span>(Offspring<span class="op">$</span>parent[Offspring<span class="op">$</span>parent<span class="op">$</span>oc<span class="op">&gt;</span><span class="fl">0.02</span>,<span class="kw">c</span>(<span class="st">&quot;Breed&quot;</span>,<span class="st">&quot;lb&quot;</span>,<span class="st">&quot;oc&quot;</span>,<span class="st">&quot;ub&quot;</span>)])</span></code></pre></div>
<pre><code>##           Breed lb         oc ub
## Angler8  Angler  0 0.02384619 NA
## Angler14 Angler  0 0.13924780 NA
## Angler16 Angler  0 0.07642795 NA
## Angler25 Angler  0 0.05765760 NA
## Angler30 Angler  0 0.02744606 NA
## Angler53 Angler  0 0.07553520 NA</code></pre>
</div>
</div>
<div id="pedigree-based-ocs" class="section level2">
<h2>Pedigree-based OCS</h2>
<p>All evaluations using pedigree data are demonstrated at the example of the Hinterwald cattle. A pedigree is contained in the package. The pedigree and the functions dealing with pedigree data have already been described in the <a href="ped-vignette.html">companion vignette for basic pedigree-based evaluations</a>.</p>
<p>The pedigree completeness is an important factor to get reliable results. If an animal has many missing ancestors, then it would falsely considered to be unrelated to other animals, so it will falsely obtain high optimum contributions. There are several approaches to overcome this problem:</p>
<ul>
<li><p>Calculate the pedigree completeness for all selection candidates and exclude individuals with a small number of equivalent complete generations from the evaluations. The number of equivalent complete generations can be computed with function <a href="https://rdrr.io/cran/optiSel/man/summary.Pedig.html">summary</a>.</p></li>
<li><p>Classify the breed of founders born after some fixed date as <code>unknown</code>, and restrict the genetic contribution from these founders in the offspring. The breed names of the founders can be classified by using appropriate values for parameters <code>lastNative</code> and <code>thisBreed</code> in function <a href="https://rdrr.io/cran/optiSel/man/prePed.html">prePed</a>.</p></li>
<li><p>Classify the breed of founders born after some fixed date as <code>unknown</code>, so that these founders are considered non-native, and restrict or minimize the kinship at native alleles which is less affected by incomplete pedigrees than the classical pedigree-based kinship.</p></li>
</ul>
<p>Of course, all 3 approaches can be followed simultaneously. First, we prepare the pedigree and classify the breed of founders born after 1970 to be <code>unknown</code>:</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="kw">data</span>(<span class="st">&quot;PedigWithErrors&quot;</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a>Pedig &lt;-<span class="st"> </span><span class="kw">prePed</span>(PedigWithErrors, <span class="dt">thisBreed=</span><span class="st">&quot;Hinterwaelder&quot;</span>, <span class="dt">lastNative=</span><span class="dv">1970</span>)</span></code></pre></div>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="kw">tail</span>(Pedig[,<span class="op">-</span><span class="dv">1</span>])</span></code></pre></div>
<pre><code>##                             Sire             Dam    Sex         Breed Born   I
## 276000813677673  276000813368988 276000812749878 female Hinterwaelder 2007 1.5
## 276000812771580  276000812771544 276000891438774 female Hinterwaelder 2006 3.5
## 276000892197676  276000812771544 276000811287686 female Hinterwaelder 2006 4.5
## 276000813517568  276000813121706 276000812905334 female Hinterwaelder 2007 2.0
## 276000813752879  276000811903592 276000812803634 female Hinterwaelder 2007 4.0
## 276000891978029 S276000891978029 276000891978027 female Hinterwaelder 2008 2.0
##                        BV Offspring
## 276000813677673 0.6354795     FALSE
## 276000812771580 1.2294519     FALSE
## 276000892197676 0.5375719     FALSE
## 276000813517568 0.6818203     FALSE
## 276000813752879 0.7640241     FALSE
## 276000891978029 1.3397333     FALSE</code></pre>
<p>The <em>breed composition</em> of individuals can be estimated with function <a href="https://rdrr.io/cran/optiSel/man/pedBreedComp.html">pedBreedComp</a>. Since the native contribution should be considered in some scenarios, they are added as additional column <code>NC</code> to the pedigree.</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>cont     &lt;-<span class="st"> </span><span class="kw">pedBreedComp</span>(Pedig, <span class="dt">thisBreed=</span><span class="st">&quot;Hinterwaelder&quot;</span>)</span>
<span id="cb80-2"><a href="#cb80-2"></a>Pedig<span class="op">$</span>NC &lt;-<span class="st"> </span>cont<span class="op">$</span>native</span>
<span id="cb80-3"><a href="#cb80-3"></a><span class="kw">tail</span>(cont[, <span class="dv">2</span><span class="op">:</span><span class="dv">5</span>])</span></code></pre></div>
<pre><code>##                     native   unknown      unbek0  Fleckvieh
## 276000813677673 0.48454285 0.2441406 0.029510498 0.09605408
## 276000812771580 0.31429291 0.5390625 0.020900726 0.06287766
## 276000892197676 0.37435150 0.4394531 0.023830414 0.06507492
## 276000813517568 0.50592804 0.1152344 0.032798767 0.08444214
## 276000813752879 0.58937836 0.1464844 0.035198212 0.10577011
## 276000891978029 0.08495712 0.8837891 0.004339218 0.01391411</code></pre>
<p>Below, the Hinterwald cattle born between 1980 and 1990 with at least 4 complete equivalent generations in the pedigree are selected to describe the population and the individuals being at least 1 year old are chosen as selection candidates. The aim is computing optimum contributions of the selection candidates to the birth cohort 1991. Data frame <code>phen</code> is defined below, which contains the individual IDs in Colmumn 1 (<code>Indiv</code>), sexes in Column 2 (<code>Sex</code>), breed names (<code>Breed</code>), years of birth (<code>Born</code>), breeding values (<code>BV</code>), and the native contributions (<code>NC</code>) of the individuals. Finally, the logical column <code>isCandidate</code> indicating the selection candidates is appended.</p>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>use   &lt;-<span class="st"> </span>Pedig<span class="op">$</span>Born <span class="op">%in%</span><span class="st"> </span>(<span class="dv">1980</span><span class="op">:</span><span class="dv">1990</span>) <span class="op">&amp;</span><span class="st"> </span>Pedig<span class="op">$</span>Breed<span class="op">==</span><span class="st">&quot;Hinterwaelder&quot;</span></span>
<span id="cb82-2"><a href="#cb82-2"></a>use   &lt;-<span class="st"> </span>use <span class="op">&amp;</span><span class="st"> </span><span class="kw">summary</span>(Pedig)<span class="op">$</span>equiGen<span class="op">&gt;=</span><span class="dv">4</span></span>
<span id="cb82-3"><a href="#cb82-3"></a>phen  &lt;-<span class="st"> </span>Pedig[use, <span class="kw">c</span>(<span class="st">&quot;Indiv&quot;</span>, <span class="st">&quot;Sex&quot;</span>, <span class="st">&quot;Breed&quot;</span>, <span class="st">&quot;Born&quot;</span>, <span class="st">&quot;BV&quot;</span>, <span class="st">&quot;NC&quot;</span>)]</span>
<span id="cb82-4"><a href="#cb82-4"></a>phen<span class="op">$</span>isCandidate &lt;-<span class="st"> </span>phen<span class="op">$</span>Born<span class="op">&lt;=</span><span class="dv">1991</span></span></code></pre></div>
<p>Since cattle have overlapping generations, the percentage which each age class represents in the population must be defined. One possibility is to assume that the percentage represented by a class is proportional to the percentage of offspring that is not yet born. Moreover, males and females (excluding newborn individuals) should be equally represented. Percentages fulfilling these assumptions can obtained with function agecont:</p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1"></a>cont     &lt;-<span class="st"> </span><span class="kw">agecont</span>(Pedig, phen<span class="op">$</span>Indiv)</span>
<span id="cb83-2"><a href="#cb83-2"></a><span class="kw">head</span>(cont)</span></code></pre></div>
<pre><code>##   age       male     female
## 1   1 0.16547917 0.07255799
## 2   2 0.16500502 0.07255799
## 3   3 0.12162008 0.06704857
## 4   4 0.05500167 0.05675740
## 5   5 0.01849194 0.04740178
## 6   6 0.01090550 0.03804617</code></pre>
<p>The generation interval is approximately</p>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1"></a>L &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">4</span><span class="op">*</span>cont<span class="op">$</span>male[<span class="dv">1</span>]) <span class="op">+</span><span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">4</span><span class="op">*</span>cont<span class="op">$</span>female[<span class="dv">1</span>])</span>
<span id="cb85-2"><a href="#cb85-2"></a>L</span></code></pre></div>
<pre><code>## [1] 4.956284</code></pre>
<p>The breeding values were simulated such that breeding values and native contributions are negatively correlated. This mimics historic introgression from a high-yielding commercial breed.</p>
<p>A matrix containing the <em>pedigree based kinship</em> between all pairs of individuals can be computed with function <a href="https://rdrr.io/cran/optiSel/man/pedIBD.html">pedIBD</a>. It is half the additive relationship matrix. The <em>pedigree based kinship at native alleles</em> can be calculated from the results of function <a href="https://rdrr.io/cran/optiSel/man/pedIBDatN.html">pedIBDatN</a>.</p>
<p>The data fame containing phenotypes and the kinships are combined below into a single R-object with function candes. This function also estimates the current values of the parameters in the population and displays the available objective functions and constraints. Below, the <em>pedigree based kinship</em> is named <code>pKin</code>, and the <em>kinship at native alleles</em> is named <code>pKinatN</code>:</p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1"></a>pKin    &lt;-<span class="st"> </span><span class="kw">pedIBD</span>(Pedig, <span class="dt">keep.only=</span>phen<span class="op">$</span>Indiv)</span>
<span id="cb87-2"><a href="#cb87-2"></a>pKinatN &lt;-<span class="st"> </span><span class="kw">pedIBDatN</span>(Pedig, <span class="dt">thisBreed=</span><span class="st">&quot;Hinterwaelder&quot;</span>, <span class="dt">keep.only=</span>phen<span class="op">$</span>Indiv)</span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>cand &lt;-<span class="st"> </span><span class="kw">candes</span>(<span class="dt">phen=</span>phen, <span class="dt">pKin=</span>pKin, <span class="dt">pKinatN=</span>pKinatN, <span class="dt">cont=</span>cont)</span></code></pre></div>
<pre><code>## Column &#39;Sire&#39; was missing. It is set to NA.
## Column &#39;Dam&#39; was missing. It is set to NA.
## The population is evaluated at time 1990
## 
##  Mean values of the parameters are:          Value 
##  for trait     &#39;BV&#39;      in Hinterwaelder:  -0.6212
##  for trait     &#39;NC&#39;      in Hinterwaelder:   0.6236
##  for kinship   &#39;pKin&#39;    in Hinterwaelder:   0.0254
##  for nat. kin. &#39;pKinatN&#39; in Hinterwaelder:   0.0452
## 
##  Available objective functions and constraints:                               
##  for trait     &#39;BV&#39;      in Hinterwaelder: min.BV, max.BV, lb.BV, eq.BV, ub.BV
##  for trait     &#39;NC&#39;      in Hinterwaelder: min.NC, max.NC, lb.NC, eq.NC, ub.NC
##  for kinship   &#39;pKin&#39;    in Hinterwaelder: min.pKin, ub.pKin                  
##  for nat. kin. &#39;pKinatN&#39; in Hinterwaelder: min.pKinatN, ub.pKinatN            
## 
##  ub  lb uniform</code></pre>
<p>Compared to the introductory example the possibility to restrict or to maximize native contributions becomes available because column <code>NC</code> is now included in data frame <code>phen</code>. Additionally, there is the possibility to minimize or to restrict the <em>kinship at native alleles</em> <code>pKinatN</code> and the <em>pedigree based kinship</em> <code>pKin</code>.</p>
<p>For defining appropriate threshold values for the constraints, the current mean kinships, the mean native contribution, and the mean breeding value in the population need to be known. The values can be obtained as</p>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a>cand<span class="op">$</span>mean</span></code></pre></div>
<pre><code>##           BV        NC       pKin    pKinatN
## 1 -0.6212472 0.6235631 0.02540349 0.04524766</code></pre>
<p>Depending on what the objective of the breeding program is, you may continue reading at the appropriate section:</p>
<ul>
<li><a href="#maximize-genetic-gain-pedigree-based">Maximize Genetic Gain</a></li>
<li><a href="#minimize-inbreeding-pedigree-based">Minimize Inbreeding</a></li>
<li><a href="#recover-the-native-genetic-background-pedigree-based">Recover the Native Genetic Background</a></li>
</ul>
<div id="maximize-genetic-gain-1" class="section level3">
<h3><a name="maximize-genetic-gain-pedigree-based"></a>Maximize Genetic Gain</a></h3>
<p>This is the traditional approach proposed by <span class="citation">Meuwissen (1997)</span>. First we create a list of constraints:</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a>con &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb92-2"><a href="#cb92-2"></a>  <span class="dt">uniform =</span> <span class="st">&quot;female&quot;</span>,</span>
<span id="cb92-3"><a href="#cb92-3"></a>  <span class="dt">ub.pKin =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>pKin)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L)</span>
<span id="cb92-4"><a href="#cb92-4"></a>)</span></code></pre></div>
<p>Here, equal numbers of offspring are assumed for the females and only the contributions of males are to be optimized. The upper bound for the mean pedigree based kinship was derived from the effective population size as explained above. Now the optimum contributions of the selection candidates can be calculated:</p>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1"></a>Offspring &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;max.BV&quot;</span>, cand, con)</span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="kw">rbind</span>(cand<span class="op">$</span>mean, Offspring<span class="op">$</span>mean)</span></code></pre></div>
<pre><code>##           BV        NC       pKin    pKinatN
## 1 -0.6212472 0.6235631 0.02540349 0.04524766
## 2 -0.5375074 0.6152876 0.02638890 0.04724233</code></pre>
<p>This approach may be apppropriate for a population without introgression and complete pedigrees, but for populations with historic introgression, the kinship at native alleles should be restricted as well in accordance with the desired effective size, and the native contributions should be restricted in order not to decrease. Otherwise the genetic originality of the breed may get lost in the long term.</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a>con &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb96-2"><a href="#cb96-2"></a>  <span class="dt">uniform    =</span> <span class="st">&quot;female&quot;</span>,</span>
<span id="cb96-3"><a href="#cb96-3"></a>  <span class="dt">ub.pKin    =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>pKin)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L),</span>
<span id="cb96-4"><a href="#cb96-4"></a>  <span class="dt">ub.pKinatN =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>pKinatN)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L),</span>
<span id="cb96-5"><a href="#cb96-5"></a>  <span class="dt">lb.NC      =</span> cand<span class="op">$</span>mean<span class="op">$</span>NC</span>
<span id="cb96-6"><a href="#cb96-6"></a>)</span>
<span id="cb96-7"><a href="#cb96-7"></a>Offspring2     &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;max.BV&quot;</span>, cand, con)</span></code></pre></div>
<p>For comparison, the parameters of both scenarios are combined into a single data frame with <code>rbind</code>:</p>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1"></a><span class="kw">rbind</span>(<span class="dt">Ref=</span>cand<span class="op">$</span>mean, <span class="dt">maxBV=</span>Offspring<span class="op">$</span>mean, <span class="dt">maxBV2=</span>Offspring2<span class="op">$</span>mean)</span></code></pre></div>
<pre><code>##                BV        NC       pKin    pKinatN
## Ref    -0.6212472 0.6235631 0.02540349 0.04524766
## maxBV  -0.5375074 0.6152876 0.02638890 0.04724233
## maxBV2 -0.5484134 0.6235636 0.02600256 0.04621494</code></pre>
<p>Thus, genetic gain in Method 2 is only slightly below the genetic gain in Method 1, but the native contributions do not decrease and the kinship at native alleles increases at a lower rate.</p>
</div>
<div id="minimize-inbreeding-1" class="section level3">
<h3><a name="minimize-inbreeding-pedigree-based"></a>Minimize Inbreeding</a></h3>
<p>Minimizing inbreeding means to minimize the average kinship of the population in order to enable breeders to avoid inbreeding. This is the appropriate approach e.g. for companion animals suffering from a historic bottleneck. It can be done with or without accounting for breeding values. In the example below no breeding values are considered since accurate breeding values are not available for most of these breeds.</p>
<p>First we create a list of constraints:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a>con  &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">uniform=</span><span class="st">&quot;female&quot;</span>)</span></code></pre></div>
<p>Again, equal numbers of offspring are assumed for all females and only the contributions of males are to be optimized. The pedigree based kinship is not constrained in this example because it should be minimized.</p>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1"></a>Offspring &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;min.pKin&quot;</span>, cand, con)</span></code></pre></div>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="kw">rbind</span>(cand<span class="op">$</span>mean, Offspring<span class="op">$</span>mean)</span></code></pre></div>
<pre><code>##           BV        NC       pKin    pKinatN
## 1 -0.6212472 0.6235631 0.02540349 0.04524766
## 2 -0.6740305 0.6293595 0.02202135 0.03889580</code></pre>
<p>The approach shown above has the disadvantage that kinships between individuals are less reliable if ancestors are missing in the pedigree. The alternative approach, shown below, is to minimize the kinship at native alleles and to restrict pedigree based kinship.</p>
<p>While in livestock breeds the native contributions should be preserved in order to maintain the genetic originality of the breeds, in several companion breeds the opposite is true. Several companion breeds have high inbreeding coefficients and descend from only very few (e.g. 3) founders. Hence, a sufficient genetic diversity cannot be achieved in the population. For these breeds it may be appropriate to use unrelated individuals from a variety of other breeds in order to increase the genetic diversity. However, only a small contribution from other breeds is needed, so the native contributions should be restricted also for these breeds in order to preserve their genetic originality. The difference between a breed with high diversity and a breed with low diversity suffering from inbreeding depression is, that the optimum value for the native contribution is smaller than 1 for the latter. For such a breed it is advisable to allow the use of individuals from other breeds but to restrict the admissible mean contribution from other breeds.</p>
<p>In summary, the alternative approach is to minimize the kinship at native alleles and to restrict pedigree based kinship and native contributions:</p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a>con  &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb103-2"><a href="#cb103-2"></a>  <span class="dt">uniform =</span> <span class="st">&quot;female&quot;</span>,</span>
<span id="cb103-3"><a href="#cb103-3"></a>  <span class="dt">lb.NC   =</span> <span class="fl">1.02</span><span class="op">*</span>cand<span class="op">$</span>mean<span class="op">$</span>NC,</span>
<span id="cb103-4"><a href="#cb103-4"></a>  <span class="dt">ub.pKin =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>pKin)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L)</span>
<span id="cb103-5"><a href="#cb103-5"></a>)</span>
<span id="cb103-6"><a href="#cb103-6"></a></span>
<span id="cb103-7"><a href="#cb103-7"></a>Offspring2  &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;min.pKinatN&quot;</span>, cand, con)</span></code></pre></div>
<pre><code>## For consistency with the rest of the package the inequality sign may be switched from &gt;= to &lt;= in a future nloptr version.</code></pre>
<p>For comparison, the parameter estimates are combined into a single data frame:</p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="kw">rbind</span>(<span class="dt">Ref=</span>cand<span class="op">$</span>mean, <span class="dt">minKin=</span>Offspring<span class="op">$</span>mean, <span class="dt">minKin2=</span>Offspring2<span class="op">$</span>mean)</span></code></pre></div>
<pre><code>##                 BV        NC       pKin    pKinatN
## Ref     -0.6212472 0.6235631 0.02540349 0.04524766
## minKin  -0.6740305 0.6293595 0.02202135 0.03889580
## minKin2 -0.6813346 0.6360344 0.02220580 0.03864749</code></pre>
<p>The pedigree based kinship is slightly higher in the second approach, but the kinship at native alleles is lower. Since pedigree based kinships are less reliable due to missing ancestors in the pedigree, the second approach is recommended. However, the use of pedigree data has the disadvantage that only the expected kinships can be minimized. The expected kinships deviate from the realized kinships due to mendelian segregation. Hence, for breeds with serious inbreeding problems it is recommended to genotype the selection candidates and to perform marker-based optimum contribution selection.</p>
</div>
<div id="recover-the-native-genetic-background-1" class="section level3">
<h3><a name="recover-the-native-genetic-background-pedigree-based"></a>Recover the Native Genetic Background</a></h3>
<p>For endangered breeds the priority of a breeding program could be to recover the original genetic background by maximizing native contributions. However, since the individuals with highest native contributions are related, this may considerably increase the inbreeding coefficients if the diversity at native alleles is not preserved. Hence, constraints are defined below not only for the pedigree based kinship, but also for the kinship at native alleles in accordance with the desired effective size:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>con &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb107-2"><a href="#cb107-2"></a>  <span class="dt">uniform    =</span> <span class="st">&quot;female&quot;</span>,</span>
<span id="cb107-3"><a href="#cb107-3"></a>  <span class="dt">ub.pKin    =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>pKin)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L),</span>
<span id="cb107-4"><a href="#cb107-4"></a>  <span class="dt">ub.pKinatN =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>pKinatN)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L)</span>
<span id="cb107-5"><a href="#cb107-5"></a>)</span>
<span id="cb107-6"><a href="#cb107-6"></a>Offspring &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;max.NC&quot;</span>, cand, con)</span></code></pre></div>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1"></a>Offspring<span class="op">$</span>mean</span></code></pre></div>
<pre><code>##           BV        NC       pKin   pKinatN
## 1 -0.6944177 0.6534971 0.02638971 0.0459631</code></pre>
<p>For some breeds, native contributions and breeding values are negatively correlated, so maximizing native contributions results in negative genetic. This can be avoided by adding an additional constraint for the breeding values:</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a>con &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb110-2"><a href="#cb110-2"></a>  <span class="dt">uniform    =</span> <span class="st">&quot;female&quot;</span>,</span>
<span id="cb110-3"><a href="#cb110-3"></a>  <span class="dt">ub.pKin    =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>pKin)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L),</span>
<span id="cb110-4"><a href="#cb110-4"></a>  <span class="dt">ub.pKinatN =</span> <span class="dv">1</span><span class="op">-</span>(<span class="dv">1</span><span class="op">-</span>cand<span class="op">$</span>mean<span class="op">$</span>pKinatN)<span class="op">*</span>(<span class="dv">1-1</span><span class="op">/</span>(<span class="dv">2</span><span class="op">*</span>Ne))<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span>L),</span>
<span id="cb110-5"><a href="#cb110-5"></a>  <span class="dt">lb.BV      =</span> cand<span class="op">$</span>mean<span class="op">$</span>BV</span>
<span id="cb110-6"><a href="#cb110-6"></a>)</span>
<span id="cb110-7"><a href="#cb110-7"></a>Offspring2 &lt;-<span class="st"> </span><span class="kw">opticont</span>(<span class="st">&quot;max.NC&quot;</span>, cand, con)</span></code></pre></div>
<p>For comparison, the estimates for both scenarios are combined into a single data frame:</p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="kw">rbind</span>(<span class="dt">Ref=</span>cand<span class="op">$</span>mean, <span class="dt">maxNC=</span>Offspring<span class="op">$</span>mean, <span class="dt">maxNC2=</span>Offspring2<span class="op">$</span>mean)</span></code></pre></div>
<pre><code>##                BV        NC       pKin    pKinatN
## Ref    -0.6212472 0.6235631 0.02540349 0.04524766
## maxNC  -0.6944177 0.6534971 0.02638971 0.04596310
## maxNC2 -0.6212451 0.6478644 0.02639075 0.04608267</code></pre>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-Meuwissen2009">
<p>Meuwissen, T H E. 2009. “Genetic Management of Small Populations: A Review.” <em>Acta Agriculturae Scand Section A</em> 59: 71–79.</p>
</div>
<div id="ref-Meuwissen1997">
<p>Meuwissen, T. H. E. 1997. “Maximising the Response of Selection with a Predefined Rate of Inbreeding.” <em>J. Animal Sci</em> 75: 934–40.</p>
</div>
<div id="ref-Wellmann2009">
<p>Wellmann, R., and I. Pfeiffer. 2009. “Pedigree Analysis for Conservation of Genetic Diversity and Purging.” <em>Genetical Research (Camb)</em> 91 (34).</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
