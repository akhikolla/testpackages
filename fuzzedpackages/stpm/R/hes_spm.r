d_f_j1_a_abq <- function (a, b, q, r0, tij, t0) 
{
    .e1 <- b^2
    .e2 <- a^2
    .e4 <- 2 * (.e1 * q) + .e2
    .e5 <- sqrt(.e4)
    .e6 <- 2 * q
    .e7 <- a + .e5
    .e8 <- .e7/.e6
    .e9 <- r0 - .e8
    .e10 <- tij - t0
    .e11 <- a/.e5
    .e13 <- 2 * (.e5/.e9) + .e6
    .e15 <- exp(2 * (.e5 * .e10))
    .e16 <- 1 + .e11
    .e18 <- .e13 * .e15 - .e6
    .e19 <- q * .e9
    .e20 <- 2 * .e11
    .e21 <- .e16 * .e5
    .e23 <- .e21/.e19 + .e20
    .e24 <- 2 * (a * .e13 * .e10/.e5)
    .e25 <- .e23/.e9
    .e26 <- .e1/.e5
    .e27 <- .e25 + .e24
    .e28 <- 2 * .e19
    .e30 <- .e26 - .e7/q
    .e34 <- .e8 + 2 * (.e5/.e18)
    .e36 <- .e20 - 2 * (.e27 * .e15 * .e5/.e18)
    .e37 <- 2 * (q/.e5)
    .e38 <- .e4 * .e5
    .e41 <- .e21/.e28 + .e11
    .e42 <- .e16/.e6
    .e44 <- 1 - .e2/.e4
    .e46 <- 2 * ((1/.e9 + .e37)/.e9)
    .e47 <- 2 + 2 * ((.e30 * .e5/.e28 + .e26)/.e9)
    .e48 <- a/.e4
    .e49 <- .e1 * .e13
    .e50 <- q * .e13
    .e52 <- .e42 + .e36/.e18
    .e53 <- .e16/.e5
    .e55 <- (.e47 + 2 * (.e49 * .e10/.e5)) * .e15 - 2
    .e56 <- .e19^2
    .e58 <- 2 * (.e41/.e9) + .e24
    .e59 <- .e46 + 4 * (.e50 * .e10/.e5)
    .e61 <- a * .e1/.e38
    .e65 <- .e53 - .e48
    .e72 <- 2 * (.e44/.e5)
    .e73 <- 2 * .e61
    .e74 <- .e37 - .e59 * .e15 * .e5/.e18
    .e75 <- .e11 - .e58 * .e15 * .e5/.e18
    .e76 <- .e26 - .e55 * .e5/.e18
    c(a = -(0.5 * ((.e44/(2 * (q * .e5)) + (.e72 - (.e58 * .e36 + 
        2 * (((((.e25 + q * .e16 * .e5/.e56) * .e16/2 + (1 + 
            a * .e65)/.e9)/q + .e72)/.e9 + (2 * (.e44 * .e13 + 
            2 * (a * .e41/.e9)) + 2 * (a * .e27)) * .e10/.e5) * 
            .e5 + .e27 * .e75)) * .e15/.e18)/.e18 - .e52 * (.e42 + 
        2 * (.e75/.e18))/.e34)/.e34)), b = 0.5 * (b * (((.e59 * 
        .e36 + 2 * ((((.e25 + q * (.e21/.e56 - 4 * .e48))/.e5 + 
        (2 * .e53 - 2 * .e48)/.e9)/.e9 + (2 * (a * (.e46 - 2 * 
        (.e50/.e4))) + 4 * (q * .e27)) * .e10/.e5) * .e5 + .e27 * 
        .e74)) * .e15/.e18 + 4 * (a * q/.e38))/.e18 + .e52 * 
        (1/.e5 + 2 * (.e74/.e18))/.e34 + a/.e38)/.e34), q = 0.5 * 
        ((((.e55 * .e36 + 2 * (((((.e23 * .e30/2 + .e1 * .e65)/.e19 - 
            (.e16 * (r0 - (.e8 + .e30/2)) * .e5/.e56 + .e73))/.e9 + 
            (2 * (a * (.e47 - .e49/.e4)) + 2 * (.e1 * .e27)) * 
                .e10/.e5) * .e5 + .e27 * .e76) * .e15))/.e18 + 
            .e73)/.e18 + (.e16/q + .e61)/.e6 + .e52 * (.e30/.e6 + 
            2 * (.e76/.e18))/.e34)/.e34))
}


d_f_j1_b_bq <- function (a, b, q, r0, tij, t0) 
{
    .e1 <- b^2
    .e2 <- .e1 * q
    .e4 <- 2 * .e2 + a^2
    .e5 <- sqrt(.e4)
    .e6 <- 2 * q
    .e7 <- a + .e5
    .e8 <- .e7/.e6
    .e9 <- r0 - .e8
    .e10 <- tij - t0
    .e12 <- 2 * (.e5/.e9) + .e6
    .e14 <- exp(2 * (.e5 * .e10))
    .e16 <- .e12 * .e14 - .e6
    .e17 <- q/.e5
    .e18 <- 4 * .e17
    .e19 <- q * .e12
    .e20 <- 4 * (.e19 * .e10/.e5)
    .e21 <- .e1/.e5
    .e23 <- (2/.e9 + .e18)/.e9 + .e20
    .e25 <- 2 * .e17
    .e26 <- .e21 - .e7/q
    .e31 <- 2 * (q * .e9)
    .e32 <- .e18 - 2 * (.e23 * .e14 * .e5/.e16)
    .e35 <- .e8 + 2 * (.e5/.e16)
    .e36 <- 1/.e5
    .e38 <- 2 * ((1/.e9 + .e25)/.e9)
    .e39 <- 2 + 2 * ((.e26 * .e5/.e31 + .e21)/.e9)
    .e40 <- .e4 * .e5
    .e42 <- (.e39 + 2 * (.e1 * .e12 * .e10/.e5)) * .e14 - 2
    .e44 <- .e32/.e16 + .e36
    .e45 <- 1 - .e2/.e4
    .e46 <- .e38 + .e20
    .e53 <- .e25 - .e46 * .e14 * .e5/.e16
    .e54 <- 4 * (.e45/.e5)
    .e55 <- .e18 + 4/.e9
    .e56 <- .e21 - .e42 * .e5/.e16
    .e57 <- q^2
    c(b = -(0.5 * ((.e44 - .e1 * (((.e46 * .e32 + 2 * (.e23 * 
        .e53 + (.e55/.e9 - 8 * (.e57/.e4))/.e9 + q * (4 * .e23 + 
        4 * (.e38 - 2 * (.e19/.e4))) * .e10)) * .e14/.e16 + 8 * 
        (.e57/.e40))/.e16 + .e44 * (.e36 + 2 * (.e53/.e16))/.e35 + 
        2 * (q/.e40)))/.e35)), q = -(0.5 * (b * ((.e54 - (.e42 * 
        .e32 + 2 * ((((.e55 * .e26/.e31 + .e54)/.e9 + (2 * (.e1 * 
        .e23) + 4 * (.e45 * .e12 + q * .e39)) * .e10/.e5) * .e5 + 
        .e23 * .e56) * .e14))/.e16)/.e16 - (.e44 * (.e26/.e6 + 
        2 * (.e56/.e16))/.e35 + .e1/.e40))/.e35)))
}

d_f_j1_q_qb <- 
function (a, b, q, r0, tij, t0) 
{
    .e1 <- b^2
    .e2 <- .e1 * q
    .e4 <- 2 * .e2 + a^2
    .e5 <- sqrt(.e4)
    .e6 <- 2 * q
    .e7 <- a + .e5
    .e8 <- .e7/.e6
    .e9 <- r0 - .e8
    .e10 <- tij - t0
    .e12 <- 2 * (.e5/.e9) + .e6
    .e14 <- exp(2 * (.e5 * .e10))
    .e15 <- .e1/.e5
    .e17 <- .e12 * .e14 - .e6
    .e18 <- .e6^2
    .e19 <- 2 * (q * .e5)
    .e21 <- 2 * (.e7/.e18)
    .e22 <- 2 * .e15
    .e23 <- .e1/.e19
    .e24 <- .e1 * .e12
    .e25 <- .e23 - .e21
    .e26 <- 2 * (.e24 * .e10/.e5)
    .e30 <- 2 * (.e25 * .e5/.e9) + .e22
    .e31 <- .e7/q
    .e34 <- .e30/.e9 + 2 + .e26
    .e35 <- 2 * (q/.e5)
    .e36 <- .e15 - .e31
    .e38 <- .e34 * .e14 - 2
    .e41 <- .e36 * .e5/(2 * (q * .e9)) + .e15
    .e43 <- 1/.e9 + .e35
    .e48 <- .e19^2
    .e49 <- .e8 + 2 * (.e5/.e17)
    .e52 <- 2 * (.e43/.e9)
    .e53 <- .e22 - 2 * (.e38 * .e5/.e17)
    .e54 <- 2 + 2 * (.e41/.e9)
    .e55 <- q * .e12
    .e57 <- (.e54 + .e26) * .e14 - 2
    .e58 <- .e52 + 4 * (.e55 * .e10/.e5)
    .e68 <- .e53/.e17 + .e23 - .e21
    .e70 <- 1/q
    .e71 <- 2 * ((2 - 2 * (.e2/.e4))/.e5)
    .e72 <- 2 * ((.e15 - 2 * .e31)/.e18)
    .e73 <- 2 * (.e1 * (.e2/.e5 + .e5)/.e48)
    .e74 <- 2 * (b^4/(.e4 * .e5))
    .e75 <- .e35 - .e58 * .e14 * .e5/.e17
    .e78 <- .e15 - .e57 * .e5/.e17
    .e79 <- q * (4 * (.e2/.e48) + 4/.e18)
    c(q = 0.5 * ((((.e57 * .e53 + 2 * ((((.e30 * .e36/.e6 + 2 * 
        (.e41 * .e25 - (.e72 + .e73) * .e5))/.e9 - .e74)/.e9 + 
        .e1 * (2 * .e34 + 2 * (.e54 - .e24/.e4)) * .e10/.e5) * 
        .e14 * .e5 + .e38 * .e78))/.e17 + .e74)/.e17 + .e73 + 
        .e68 * (.e36/.e6 + 2 * (.e78/.e17))/.e49 + .e72)/.e49), 
        b = -(0.5 * (b * ((.e70 - .e79)/.e5 + (.e71 - (.e58 * 
            .e53 * .e14 + 2 * ((((.e30/.e5 + 2 * (.e43 * .e25 + 
            .e70 - .e79))/.e9 + .e71)/.e9 + (2 * (2 * .e12 + 
            .e1 * (.e52 - 2 * (.e55/.e4))) + 4 * (q * .e34)) * 
            .e10/.e5) * .e14 * .e5 + .e38 * .e75))/.e17)/.e17 - 
            .e68 * (1/.e5 + 2 * (.e75/.e17))/.e49)/.e49)))
}

d_f_j2_a_abqff1 <- 
function (a, b, q, f, f1, m0, r0, tij, yij, t0) 
{
    .e1 <- a^2
    .e2 <- b^2
    .e3 <- .e2 * q
    .e5 <- 2 * .e3 + .e1
    .e6 <- sqrt(.e5)
    .e7 <- 2 * q
    .e8 <- a + .e6
    .e9 <- .e8/.e7
    .e10 <- r0 - .e9
    .e11 <- tij - t0
    .e12 <- f - f1
    .e14 <- 2 * (.e6/.e10) + .e7
    .e16 <- exp(2 * (.e6 * .e11))
    .e17 <- a/.e6
    .e18 <- .e14 * .e16
    .e19 <- a * .e12
    .e20 <- f - m0
    .e21 <- .e19/.e6
    .e22 <- .e1 * .e12
    .e23 <- 1 + .e17
    .e27 <- 2 * (.e22/.e6) - 2 * (.e20 * .e6)
    .e28 <- .e21 + f
    .e29 <- q * .e10
    .e31 <- exp(-(t0 * .e6))
    .e32 <- exp(tij * .e6)
    .e33 <- .e1/.e5
    .e34 <- .e7 - .e18
    .e35 <- .e18 - .e7
    .e36 <- .e23 * .e6
    .e37 <- 2 * .e17
    .e41 <- 2 * (.e27 * .e31 * .e32/.e8)
    .e42 <- 2 * (.e21 - f)
    .e47 <- q * (.e41 - .e42) - .e14 * .e28 * .e16
    .e48 <- 2 * (a * .e14 * .e11/.e6)
    .e50 <- .e36/.e29 + .e37
    .e51 <- .e2/.e6
    .e52 <- .e50/.e10
    .e53 <- .e47/.e34
    .e54 <- .e52 + .e48
    .e55 <- 1 - .e33
    .e56 <- 2 * .e29
    .e57 <- .e9 + 2 * (.e6/.e35)
    .e59 <- 4 * .e33
    .e60 <- a * tij
    .e61 <- .e51 - .e8/q
    .e62 <- t0 * .e27
    .e63 <- 8 - .e59
    .e64 <- yij - .e53
    .e65 <- 2 * .e20
    .e69 <- 2 * (0.5 * .e62 + f - m0)
    .e70 <- 2 * (q/.e6)
    .e71 <- 2 - 2 * .e33
    .e73 <- .e63 * .e12/2
    .e76 <- .e36/.e56 + .e17
    .e77 <- .e73 - .e69
    .e78 <- .e53 - .e28
    .e80 <- 1/.e10 + .e70
    .e82 <- 2 + 2 * ((.e61 * .e6/.e56 + .e51)/.e10)
    .e83 <- .e19/.e5
    .e84 <- q * .e14
    .e90 <- .e71 * .e14
    .e92 <- 2 * (a * .e77/.e6 - .e23 * .e27/.e8)
    .e93 <- .e37 - 2 * (.e54 * .e16 * .e6/.e35)
    .e94 <- .e60 * .e27
    .e95 <- .e22/.e5
    .e96 <- q * .e55
    .e97 <- .e23/.e7
    .e99 <- .e90 * .e16/2
    .e100 <- .e92 + 2 * (.e94/.e6)
    .e102 <- 2 * .e95 + .e65
    .e103 <- 2 * .e96
    .e105 <- .e99 + .e103
    .e106 <- 2 * (.e80/.e10)
    .e107 <- .e2 * .e14
    .e108 <- .e97 + .e93/.e35
    .e109 <- a/.e5
    .e112 <- 2 * (.e76/.e10) + .e48
    .e113 <- .e106 + 4 * (.e84 * .e11/.e6)
    .e115 <- .e82 + 2 * (.e107 * .e11/.e6)
    .e119 <- .e54 * .e78 * .e16 + q * .e100 * .e31 * .e32/.e8 - 
        .e105 * .e12/.e6
    .e120 <- .e115 * .e16
    .e121 <- .e55 * .e12
    .e122 <- .e23/.e8
    .e123 <- 2 * .e83
    .e124 <- .e23/.e6
    .e126 <- .e5 * .e6
    .e127 <- .e28 * .e11
    .e128 <- .e29^2
    .e129 <- 2 * ((2 - .e33) * .e12)
    .e131 <- 2 * (.e1/.e6) - 2 * .e6
    .e133 <- .e119/.e34 + 0.5 * (.e108 * .e64/.e57)
    .e134 <- .e55/.e6
    .e135 <- .e124 - .e109
    .e136 <- .e120 - 2
    .e139 <- 2 - .e120
    .e143 <- 2 * tij - (2 * t0 + 2/.e8)
    .e145 <- a * .e2/.e126
    .e147 <- .e60/.e6 - .e122
    .e148 <- q^2
    .e149 <- tij - (1/.e8 + t0)
    .e177 <- (.e41 + .e3 * (2 * ((.e27 * .e149 - .e102) * .e31 * 
        .e32/.e8) + .e123)/.e6 - ((.e82 * .e28 + .e2 * (2 * .e127 - 
        .e83) * .e14/.e6) * .e16 + .e139 * .e47/.e34 + .e42))/.e34
    .e181 <- .e18 + q * (2 - 4 * (a * .e31 * .e32/.e8))
    .e182 <- (q * (2 * ((.e27 * .e147 + a * (.e129 - (.e65 + 
        .e62))/.e6) * .e31 * .e32/.e8) - 2 * (.e121/.e6)) - ((.e121 + 
        2 * (a * .e28 * .e11)) * .e14/.e6 + 2 * (.e76 * .e28/.e10) - 
        .e112 * .e47/.e34) * .e16)/.e34
    .e183 <- (.e148 * (2 * ((.e27 * .e143 - 2 * .e102) * .e31 * 
        .e32/.e8) + 4 * .e83)/.e6 - (2 * (.e80 * .e28/.e10) + 
        .e84 * (4 * .e127 - .e123)/.e6 - .e113 * .e47/.e34) * 
        .e16)/.e34
    .e184 <- 2 * .e134
    .e185 <- .e129 - .e65
    .e188 <- 2 * .e145
    .e189 <- 2 * .e109
    .e190 <- .e70 - .e113 * .e16 * .e6/.e35
    .e191 <- .e17 - .e112 * .e16 * .e6/.e35
    .e192 <- .e51 - .e136 * .e6/.e35
    .e194 <- q * (2 * (.e131 * .e31 * .e32/.e8) - 2 * (.e17 - 
        1)) - .e23 * .e14 * .e16
    .e195 <- (((.e52 + q * .e23 * .e6/.e128) * .e23/2 + (1 + 
        a * .e135)/.e10)/q + .e184)/.e10
    .e196 <- ((.e50 * .e61/2 + .e2 * .e135)/.e29 - (.e23 * (r0 - 
        (.e9 + .e61/2)) * .e6/.e128 + .e188))/.e10
    .e197 <- ((.e52 + q * (.e36/.e128 - 4 * .e109))/.e6 + (2 * 
        .e124 - .e189)/.e10)/.e10
    .e200 <- (.e97 + 2 * (.e191/.e35)) * .e64/.e57 + .e182
    .e201 <- .e57 * .e34
    .e204 <- (.e61/.e7 + 2 * (.e192/.e35)) * .e64/.e57 + .e177
    .e205 <- .e78 * .e11
    .e207 <- .e55 * .e14 + 2 * (a * .e76/.e10)
    .e208 <- .e23 * .e102
    .e211 <- (1/.e6 + 2 * (.e190/.e35)) * .e64/.e57 + .e183
    .e212 <- .e102/.e6
    .e213 <- .e27/.e5
    .e214 <- .e5^2
    .e215 <- .e63/2
    .e216 <- 0.5 * .e63
    .e217 <- 2 * .e122
    .e220 <- a * .e54
    .e221 <- a * (.e106 - 2 * (.e84/.e5))
    .e222 <- a * (.e82 - .e107/.e5)
    .e223 <- a * t0
    .e224 <- .e1 * q
    .e226 <- t0 * .e102/.e6
    c(a = (((((.e195 + 2 * (.e207 * .e11/.e6)) * .e78 + .e119 * 
        .e112/.e34 + .e54 * ((2 * (a * .e78 * .e11) - .e121)/.e6 + 
        .e182)) * .e16 + q * (.e100 * .e147 + (2 * (tij * (.e55 * 
        .e27 + .e1 * .e185/.e6)) - .e223 * .e100)/.e6 + 2 * ((.e73 - 
        (.e69 + .e1 * (((.e215 + 4 * .e55) * .e12 - .e69)/.e5 + 
            t0 * .e185/.e6)))/.e6 - ((.e134 - .e23^2/.e8) * .e27 + 
        a * .e23 * .e185/.e6)/.e8)) * .e31 * .e32/.e8 - (0.5 * 
        ((.e71 * .e112 - 4 * (a * .e55 * .e14/.e5)) * .e16) - 
        a * (.e99 + 6 * .e96)/.e5) * .e12/.e6)/.e34 + 0.5 * (((.e55/(2 * 
        (q * .e6)) + (.e184 - (.e112 * .e93 + 2 * ((.e195 + (2 * 
        .e207 + 2 * .e220) * .e11/.e6) * .e6 + .e54 * .e191)) * 
        .e16/.e35)/.e35) * .e64 - .e200 * .e108)/.e57)) * .e64 - 
        .e133 * .e200)/.e57, b = b * (((((.e197 + 2 * (.e221 * 
        .e11/.e6)) * .e78 + .e119 * .e113/.e34 + .e54 * (.e183 + 
        q * (.e123 + 4 * .e205)/.e6)) * .e16 + (.e148 * (.e100 * 
        .e143 - (2 * (a * ((2 * .e77 - 8 * .e95)/.e5 - 2 * .e226) - 
        ((.e217 + .e189) * .e27 + 2 * .e208)/.e8) + 2 * (.e60 * 
        (2 * .e212 + 2 * .e213)))) * .e31 * .e32/.e8 - (0.5 * 
        ((.e71 * .e113 + 8 * (.e224 * .e14/.e214)) * .e16) - 
        q * (2 * .e105 - 8 * (.e224/.e5))/.e5) * .e12)/.e6)/.e34 - 
        0.5 * (((((.e113 * .e93 + 2 * ((.e197 + (2 * .e221 + 
            4 * (q * .e54)) * .e11/.e6) * .e6 + .e54 * .e190)) * 
            .e16/.e35 + 4 * (a * q/.e126))/.e35 + a/.e126) * 
            .e64 + .e108 * .e211)/.e57)) * .e64 - .e133 * .e211)/.e57, 
        q = (((((.e196 + 2 * (.e222 * .e11/.e6)) * .e78 + .e54 * 
            (.e177 + .e2 * (2 * .e205 + .e83)/.e6)) * .e16 + 
            ((2 * .e94 + .e3 * (.e100 * .e149 - (2 * (a * (((.e215 - 
                .e59) * .e12 - .e69)/.e5 - .e226) - ((.e122 + 
                .e109) * .e27 + .e208)/.e8) + 2 * (.e60 * (.e212 + 
                .e213)))))/.e6 + .e92) * .e31 * .e32/.e8 - (.e119 * 
            .e139/.e34 + (0.5 * ((.e71 * .e115 + 4 * (.e1 * .e2 * 
            .e14/.e214)) * .e16) + 2 * (1 - .e1 * (1 - 2 * (.e3/.e5))/.e5) - 
            .e2 * .e105/.e5) * .e12/.e6))/.e34 - 0.5 * (((((.e136 * 
            .e93 + 2 * (((.e196 + (2 * .e222 + 2 * (.e2 * .e54)) * 
            .e11/.e6) * .e6 + .e54 * .e192) * .e16))/.e35 + .e188)/.e35 + 
            (.e23/q + .e145)/.e7) * .e64 + .e204 * .e108)/.e57)) * 
            .e64 - .e133 * .e204)/.e57, f = ((.e54 * (.e194/.e34 - 
            .e23) * .e16 + q * (2 * (a * (.e216 - 2 * (0.5 * 
            (t0 * .e131) + 1))/.e6 - .e23 * .e131/.e8) + 2 * 
            (.e60 * .e131/.e6)) * .e31 * .e32/.e8 - (.e105/.e6 + 
            0.5 * (.e108 * .e194/.e57))) * .e64 - .e133 * .e194)/.e201, 
        f1 = ((((.e90/2 + .e220 * (.e181/.e34 + 1)) * .e16 + 
            .e103)/.e6 - a * (0.5 * (.e108 * .e181/(.e57 * .e6)) + 
            q * (2 * ((.e216 - a * (.e217 + 2 * (.e223/.e6)))/.e6) + 
                4 * (.e1 * tij/.e5)) * .e31 * .e32/.e8)) * .e64 - 
            a * .e133 * .e181/.e6)/.e201)
}

d_f_j2_b_bqff1 <-
function (a, b, q, f, f1, m0, r0, tij, yij, t0) 
{
    .e1 <- a^2
    .e2 <- b^2
    .e3 <- .e2 * q
    .e5 <- 2 * .e3 + .e1
    .e6 <- sqrt(.e5)
    .e7 <- 2 * q
    .e8 <- a + .e6
    .e9 <- .e8/.e7
    .e10 <- r0 - .e9
    .e11 <- tij - t0
    .e12 <- f - f1
    .e13 <- 2 * (.e6/.e10)
    .e14 <- .e13 + .e7
    .e16 <- exp(2 * (.e6 * .e11))
    .e17 <- a * .e12
    .e18 <- .e14 * .e16
    .e19 <- .e1 * .e12
    .e20 <- .e17/.e6
    .e21 <- f - m0
    .e25 <- 2 * (.e19/.e6) - 2 * (.e21 * .e6)
    .e27 <- exp(-(t0 * .e6))
    .e28 <- exp(tij * .e6)
    .e29 <- q/.e6
    .e30 <- .e20 + f
    .e31 <- .e18 - .e7
    .e32 <- .e7 - .e18
    .e33 <- 4 * .e29
    .e34 <- q * .e14
    .e35 <- 2 * .e6
    .e36 <- 4 * (.e34 * .e11/.e6)
    .e40 <- 2 * (.e25 * .e27 * .e28/.e8)
    .e41 <- 2 * (.e20 - f)
    .e42 <- .e2/.e6
    .e47 <- q * (.e40 - .e41) - .e14 * .e30 * .e16
    .e48 <- .e35^2
    .e50 <- (2/.e10 + .e33)/.e10 + .e36
    .e51 <- .e47/.e32
    .e52 <- .e17/.e5
    .e54 <- .e42 - .e8/q
    .e55 <- .e9 + 2 * (.e6/.e31)
    .e56 <- 2 * .e29
    .e57 <- 2 * (q * .e10)
    .e58 <- q^2
    .e59 <- yij - .e51
    .e62 <- 1/.e10 + .e56
    .e63 <- 2 * ((.e54 * .e6/.e57 + .e42)/.e10)
    .e64 <- .e25/.e8
    .e65 <- .e48 * .e6
    .e66 <- 2 + .e63
    .e67 <- 2 * .e64
    .e68 <- 2 * (.e19/.e5)
    .e69 <- 2 * .e21
    .e70 <- 4 * .e52
    .e74 <- .e51 - .e30
    .e79 <- 1/.e6
    .e83 <- .e68 + .e69
    .e84 <- .e33 - 2 * (.e50 * .e16 * .e6/.e31)
    .e86 <- 4 * (tij * .e25) - 2 * (.e67 + 4 * (0.5 * (t0 * .e25) + 
        4 * (.e19/.e48) + f - m0))
    .e87 <- a * q
    .e89 <- 2 * (.e62/.e10)
    .e90 <- .e87 * .e14
    .e92 <- .e50 * .e74 + 8 * (.e90 * .e12/.e65)
    .e94 <- .e84/.e31 + .e79
    .e98 <- .e86 * .e27 * .e28/.e8 + .e70
    .e99 <- (.e66 + 2 * (.e2 * .e14 * .e11/.e6)) * .e16
    .e100 <- .e89 + .e36
    .e102 <- .e92 * .e16 + .e58 * .e98/.e6
    .e103 <- a/.e6
    .e104 <- .e30 * .e11
    .e105 <- 2 * .e52
    .e107 <- 2 * (.e1/.e6) - .e35
    .e108 <- .e3/.e5
    .e110 <- .e102/.e32 + 0.5 * (.e94 * .e59/.e55)
    .e111 <- .e5 * .e6
    .e112 <- 1 - .e108
    .e113 <- .e99 - 2
    .e114 <- 1 + .e103
    .e117 <- 2 - .e99
    .e118 <- 2 * .e83
    .e122 <- 2 * tij - (2 * t0 + 2/.e8)
    .e123 <- .e33 + 4/.e10
    .e124 <- tij - (1/.e8 + t0)
    .e145 <- (.e40 + .e3 * (2 * ((.e25 * .e124 - .e83) * .e27 * 
        .e28/.e8) + .e105)/.e6 - ((.e66 * .e30 + .e2 * (2 * .e104 - 
        .e52) * .e14/.e6) * .e16 + .e117 * .e47/.e32 + .e41))/.e32
    .e149 <- .e18 + q * (2 - 4 * (a * .e27 * .e28/.e8))
    .e150 <- .e8 * .e6
    .e151 <- (.e58 * (2 * ((.e25 * .e122 - .e118) * .e27 * .e28/.e8) + 
        .e70)/.e6 - (2 * (.e62 * .e30/.e10) + .e34 * (4 * .e104 - 
        .e105)/.e6 - .e100 * .e47/.e32) * .e16)/.e32
    .e154 <- .e56 - .e100 * .e16 * .e6/.e31
    .e155 <- 4 * (.e112/.e6)
    .e156 <- .e42 - .e113 * .e6/.e31
    .e158 <- q * (2 * (.e107 * .e27 * .e28/.e8) - 2 * (.e103 - 
        1)) - .e114 * .e14 * .e16
    .e159 <- .e65^2
    .e160 <- (.e123 * .e54/.e57 + .e155)/.e10
    .e161 <- (.e123/.e10 - 8 * (.e58/.e5))/.e10
    .e162 <- .e55 * .e32
    .e165 <- (.e54/.e7 + 2 * (.e156/.e31)) * .e59/.e55 + .e145
    .e167 <- .e112 * .e14 + q * .e66
    .e170 <- (.e79 + 2 * (.e154/.e31)) * .e59/.e55 + .e151
    .e171 <- .e48/.e6
    .e173 <- .e89 - 2 * (.e34/.e5)
    .e174 <- .e19/.e35^4
    .e176 <- t0 * .e83/.e6
    .e177 <- tij * .e83
    c(b = ((.e110 + .e2 * (((.e102 * .e100/.e32 + (.e161 + 4 * 
        (q * .e173 * .e11)) * .e74/.e6 + .e50 * (.e151 + 2 * 
        (.e87 * .e12/.e111)) + q * (4 * (.e92 * .e11/.e6) + 8 * 
        (a * (2 * (.e62/(.e48 * .e10 * .e6)) - q * (16 * .e6 + 
            2 * .e171) * .e14/.e159) * .e12))) * .e16 + q^3 * 
        (((.e122 * .e86 - 8 * .e177)/.e6 + 2 * (2 * ((.e67 + 
            .e118)/.e150) + 4 * (64 * .e174 + .e176))) * .e27 * 
            .e28/.e8 - (16 * .e52 + 2 * .e98)/.e5)/.e6)/.e32 - 
        0.5 * (((((.e100 * .e84 + 2 * (.e50 * .e154 + .e161 + 
            q * (4 * .e50 + 4 * .e173) * .e11)) * .e16/.e31 + 
            8 * (.e58/.e111))/.e31 + 2 * (q/.e111)) * .e59 + 
            .e170 * .e94)/.e55))) * .e59 - .e2 * .e110 * .e170)/.e55, 
        q = b * (((((.e160 + 4 * (.e167 * .e11/.e6)) * .e74 + 
            (.e145 + a * .e2 * .e12/.e111) * .e50 + 2 * (.e2 * 
            .e92 * .e11/.e6) + 8 * (a * ((.e13 + q * (.e63 + 
            4))/.e65 - .e3 * (.e171 + 8 * .e6) * .e14/.e159) * 
            .e12)) * .e16 + q * (.e98 * (2 - .e108) + .e3 * (((.e86 * 
            .e124 - 4 * .e177)/.e6 + 2 * (2 * ((.e64 + .e68 + 
            .e69)/.e150) + 4 * (0.5 * .e176 + 32 * .e174))) * 
            .e27 * .e28/.e8 - 8 * (.e17/.e5^2)))/.e6 - .e102 * 
            .e117/.e32)/.e32 + 0.5 * ((((.e155 - (.e113 * .e84 + 
            2 * (((.e160 + (2 * (.e2 * .e50) + 4 * .e167) * .e11/.e6) * 
                .e6 + .e50 * .e156) * .e16))/.e31)/.e31 - .e2/.e111) * 
            .e59 - .e165 * .e94)/.e55)) * .e59 - .e110 * .e165)/.e55, 
        f = b * (((.e50 * (.e158/.e32 - .e114) + 8 * (.e90/.e65)) * 
            .e16 + .e58 * ((4 * (tij * .e107) - 2 * (2 * (.e107/.e8) + 
            4 * (0.5 * (t0 * .e107) + 1 + 4 * (.e1/.e48)))) * 
            .e27 * .e28/.e8 + 4 * (a/.e5))/.e6 - 0.5 * (.e94 * 
            .e158/.e55)) * .e59 - .e110 * .e158)/.e162, f1 = a * 
            b * ((((.e149/.e32 + 1) * .e50 - 8 * (.e34/.e48)) * 
            .e16 + .e58 * (a * (2 * (4 * (4/.e48 + t0/.e6) + 
            4/.e150) - 8 * (tij/.e6)) * .e27 * .e28/.e8 - 4/.e5) - 
            0.5 * (.e149 * .e94/.e55)) * .e59 - .e110 * .e149)/(.e162 * 
            .e6))
}

d_f_j2_q_qff1b <-
function (a, b, q, f, f1, m0, r0, tij, yij, t0) 
{
    .e1 <- b^2
    .e2 <- a^2
    .e3 <- .e1 * q
    .e5 <- 2 * .e3 + .e2
    .e6 <- sqrt(.e5)
    .e7 <- 2 * q
    .e8 <- a + .e6
    .e9 <- .e8/.e7
    .e10 <- r0 - .e9
    .e11 <- tij - t0
    .e12 <- f - f1
    .e14 <- 2 * (.e6/.e10) + .e7
    .e16 <- exp(2 * (.e6 * .e11))
    .e17 <- .e1/.e6
    .e18 <- .e2 * .e12
    .e19 <- .e14 * .e16
    .e20 <- a * .e12
    .e21 <- .e7^2
    .e22 <- 2 * (q * .e6)
    .e23 <- f - m0
    .e24 <- .e20/.e6
    .e26 <- 2 * (.e8/.e21)
    .e27 <- .e1/.e22
    .e29 <- 2 * (.e23 * .e6)
    .e31 <- 2 * (.e18/.e6) - .e29
    .e32 <- .e27 - .e26
    .e33 <- 2 * .e17
    .e34 <- .e1 * .e14
    .e36 <- exp(-(t0 * .e6))
    .e37 <- exp(tij * .e6)
    .e38 <- .e19 - .e7
    .e39 <- .e24 + f
    .e40 <- 2 * (.e34 * .e11/.e6)
    .e44 <- 2 * (.e32 * .e6/.e10) + .e33
    .e45 <- .e7 - .e19
    .e47 <- .e44/.e10 + 2
    .e48 <- .e47 + .e40
    .e49 <- 2 * .e6
    .e50 <- .e49^2
    .e54 <- 2 * (.e31 * .e36 * .e37/.e8)
    .e55 <- 2 * (.e24 - f)
    .e56 <- .e8/q
    .e61 <- q * (.e54 - .e55) - .e14 * .e39 * .e16
    .e62 <- .e48 * .e16
    .e63 <- .e17 - .e56
    .e64 <- 2 * (q/.e6)
    .e67 <- .e63 * .e6/(2 * (q * .e10)) + .e17
    .e69 <- 1/.e10 + .e64
    .e70 <- .e9 + 2 * (.e6/.e38)
    .e73 <- 2 + 2 * (.e67/.e10)
    .e74 <- .e3/.e5
    .e76 <- q * .e14
    .e77 <- yij - .e61/.e45
    .e78 <- .e50 * .e6
    .e79 <- .e62 - 2
    .e83 <- 0.5 * (t0 * .e31) + 4 * (.e18/.e50) + f - m0
    .e84 <- 2 - .e62
    .e86 <- 2 * (.e18/.e5) + 2 * .e23
    .e87 <- .e20/.e5
    .e89 <- 2 * (.e69/.e10)
    .e92 <- .e22^2
    .e94 <- .e33 - 2 * (.e79 * .e6/.e38)
    .e95 <- a * .e1
    .e96 <- .e1 * tij
    .e97 <- 1 - .e74
    .e98 <- 2 * (2 * (.e1 * .e83/.e6) + 2 * (q * .e31 * .e32/.e8))
    .e99 <- .e95 * .e14
    .e103 <- .e94/.e38 + .e27 - .e26
    .e104 <- (.e73 + .e40) * .e16
    .e105 <- .e89 + 4 * (.e76 * .e11/.e6)
    .e109 <- 4 * (.e99 * .e12/.e78) - .e48 * .e39
    .e110 <- q * (2 * (.e96 * .e31/.e6) - .e98)
    .e111 <- .e5 * .e6
    .e112 <- a * .e97
    .e118 <- .e109 * .e16 + .e110 * .e36 * .e37/.e8 - (.e84 * 
        .e61/.e45 + 2 * (.e112 * .e12/.e6 - f))
    .e119 <- .e39 * .e11
    .e120 <- 2 * .e87
    .e121 <- b^4
    .e123 <- 1/q
    .e124 <- 2 * ((.e17 - 2 * .e56)/.e21)
    .e126 <- 2 * (.e2/.e6) - .e49
    .e127 <- 4 * (.e3/.e92)
    .e128 <- 4/.e21
    .e129 <- a/.e6
    .e131 <- .e3/.e6 + .e6
    .e135 <- .e118/.e45 + 0.5 * (.e103 * .e77/.e70)
    .e137 <- .e104 - 2
    .e140 <- 2 - .e104
    .e141 <- 2 * ((2 - 2 * .e74)/.e6)
    .e142 <- 2 * .e14
    .e143 <- 2 * (.e1 * .e131/.e92)
    .e144 <- 2 * (.e121/.e111)
    .e148 <- 2 * tij - (2 * t0 + 2/.e8)
    .e150 <- q * (.e127 + .e128)
    .e151 <- tij - (1/.e8 + t0)
    .e152 <- ((.e44 * .e63/.e7 + 2 * (.e67 * .e32 - (.e124 + 
        .e143) * .e6))/.e10 - .e144)/.e10
    .e153 <- ((.e44/.e6 + 2 * (.e69 * .e32 + .e123 - .e150))/.e10 + 
        .e141)/.e10
    .e162 <- (.e73 * .e39 + .e1 * (2 * .e119 - .e87) * .e14/.e6) * 
        .e16
    .e168 <- 1 + .e129
    .e174 <- 2 * (.e69 * .e39/.e10) + .e76 * (4 * .e119 - .e120)/.e6
    .e176 <- .e54 + .e3 * (2 * ((.e31 * .e151 - .e86) * .e36 * 
        .e37/.e8) + .e120)/.e6
    .e177 <- .e142 + .e1 * (.e89 - 2 * (.e76/.e5))
    .e178 <- .e64 - .e105 * .e16 * .e6/.e38
    .e179 <- .e73 - .e34/.e5
    .e180 <- .e17 - .e137 * .e6/.e38
    .e181 <- q * .e48
    .e184 <- q^2 * (2 * ((.e31 * .e148 - 2 * .e86) * .e36 * .e37/.e8) + 
        4 * .e87)/.e6
    .e185 <- (.e152 + .e1 * (2 * .e48 + 2 * .e179) * .e11/.e6) * 
        .e16
    .e187 <- ((.e105 * .e61/.e45 - .e174) * .e16 + .e184)/.e45 + 
        (1/.e6 + 2 * (.e178/.e38)) * .e77/.e70
    .e188 <- .e153 + (2 * .e177 + 4 * .e181) * .e11/.e6
    .e190 <- .e78^2
    .e193 <- .e70 * .e45
    .e196 <- (.e63/.e7 + 2 * (.e180/.e38)) * .e77/.e70 + (.e176 - 
        (.e162 + .e140 * .e61/.e45 + .e55))/.e45
    .e197 <- .e83/.e5
    .e201 <- .e84/.e45 + 0.5 * (.e103/.e70)
    .e202 <- .e86/.e6
    .e203 <- .e31/.e5
    .e207 <- .e19 + q * (2 - 4 * (a * .e36 * .e37/.e8))
    .e208 <- .e50/.e6
    .e212 <- 2 * .e97
    .e213 <- 4/.e50
    .e214 <- .e18/.e49^4
    .e216 <- q * (2 * (.e126 * .e36 * .e37/.e8) - 2 * (.e129 - 
        1)) - .e168 * .e14 * .e16
    .e218 <- t0 * .e86/.e6
    c(q = ((((.e1 * (2 * (.e109 * .e11/.e6) + a * (.e48/.e111 + 
        4 * (.e73/.e78 - .e1 * (.e208 + 8 * .e6) * .e14/.e190)) * 
        .e12) - (.e152 + 2 * (.e1 * .e179 * .e11/.e6)) * .e39) * 
        .e16 + (.e1 * (2 * (tij * .e31) + .e110 * .e151)/.e6 - 
        (.e98 + q * (2 * (2 * ((((2 * .e18 - .e3 * .e86)/.e6 - 
            .e29) * .e32 - q * (.e124 + .e1 * (.e32/(.e8 * .e6) + 
            2 * (.e131/.e92))) * .e31)/.e8) - 2 * (.e121 * (.e197 + 
            0.5 * .e218 + 32 * .e214)/.e6)) + 2 * (.e121 * tij * 
            (.e202 + .e203)/.e6)))) * .e36 * .e37/.e8 + 2 * (.e95 * 
        (2 - 3 * .e74) * .e12/.e111) - (.e118 * .e140 + .e84 * 
        (.e176 - (.e162 + .e55)) - (.e185 + .e84 * .e140/.e45) * 
        .e61)/.e45)/.e45 - 0.5 * (((((.e137 * .e94 + 2 * (.e185 * 
        .e6 + .e79 * .e180))/.e38 + .e144)/.e38 + .e124 + .e143) * 
        .e77 + .e196 * .e103)/.e70)) * .e77 - .e135 * .e196)/.e70, 
        f = (((4 * (.e99/.e78) - .e48 * .e168) * .e16 + q * (2 * 
            (.e96 * .e126/.e6) - 2 * (2 * (.e1 * (0.5 * (t0 * 
            .e126) + 1 + 4 * (.e2/.e50))/.e6) + 2 * (q * .e126 * 
            .e32/.e8))) * .e36 * .e37/.e8 - (.e201 * .e216 + 
            2 * (.e112/.e6 - 1))) * .e77 - .e135 * .e216)/.e193, 
        f1 = a * (((.e212 - (.e201 * .e207 + (.e34 * (.e213 - 
            2 * (.e11/.e6)) - .e47) * .e16))/.e6 + a * q * (2 * 
            ((2 * (.e1 * (.e213 + t0/.e6)) + 4 * (q * .e32/.e8))/.e6) - 
            4 * (.e96/.e5)) * .e36 * .e37/.e8) * .e77 - .e135 * 
            .e207/.e6)/.e193, b = b * ((((4 * (q * .e109 * .e11/.e6) + 
            a * (2 * (.e181/.e111) + 4 * ((.e142 + 2 * (.e1 * 
                .e69/.e10))/.e78 - .e3 * (16 * .e6 + 2 * .e208) * 
                .e14/.e190)) * .e12 - (.e153 + 2 * (.e177 * .e11/.e6)) * 
            .e39) * .e16 + q * ((2 * (tij * (2 * .e31 - .e3 * 
            (2 * .e202 + 2 * .e203))) + .e110 * .e148 - 2 * (2 * 
            (2 * .e83 - .e3 * (2 * .e197 + 64 * .e214 + .e218)) + 
            2 * (q * ((.e123 - q * (2 * (.e32/.e8) + .e127 + 
                .e128)) * .e31 - 2 * (q * .e86 * .e32))/.e8))) * 
            .e36 * .e37/.e8 + 2 * (a * (2 + .e212 - 4 * .e74) * 
            .e12/.e5))/.e6 - (.e84 * (.e184 - .e174 * .e16) - 
            ((.e188 - .e84 * .e105/.e45) * .e61 + .e118 * .e105) * 
                .e16)/.e45)/.e45 + 0.5 * ((((.e123 - .e150)/.e6 + 
            (.e141 - (.e105 * .e94 * .e16 + 2 * (.e188 * .e16 * 
                .e6 + .e79 * .e178))/.e38)/.e38) * .e77 - .e187 * 
            .e103)/.e70)) * .e77 - .e187 * .e135)/.e70)
}

d_f_j2_f_ff1 <- 
function (a, b, q, f, f1, m0, r0, tij, yij, t0) 
{
    .e1 <- a^2
    .e4 <- sqrt(2 * (b^2 * q) + .e1)
    .e5 <- 2 * q
    .e6 <- a + .e4
    .e7 <- .e6/.e5
    .e10 <- 2 * (.e4/(r0 - .e7)) + .e5
    .e11 <- exp(2 * (.e4 * (tij - t0)))
    .e12 <- .e10 * .e11
    .e13 <- a/.e4
    .e15 <- exp(-(t0 * .e4))
    .e16 <- exp(tij * .e4)
    .e17 <- (.e7 + 2 * (.e4/(.e12 - .e5))) * (.e5 - .e12)^2
    .e26 <- q * (2 * ((2 * (.e1/.e4) - 2 * .e4) * .e15 * .e16/.e6) - 
        2 * (.e13 - 1)) - (1 + .e13) * .e10 * .e11
    c(f = -(.e26^2/.e17), f1 = a * .e26 * (q * (4 * (a * .e15 * 
        .e16/.e6) - 2) - .e12)/(.e17 * .e4))
}

d_f_j2_f1_f1 <- 
function (a, b, q, f, f1, m0, r0, tij, yij, t0) 
{
    .e1 <- a^2
    .e3 <- 2 * (b^2 * q) + .e1
    .e4 <- sqrt(.e3)
    .e5 <- 2 * q
    .e6 <- a + .e4
    .e7 <- .e6/.e5
    .e8 <- (2 * (.e4/(r0 - .e7)) + .e5) * exp(2 * (.e4 * (tij - 
        t0)))
    .e10 <- 4 * (a * exp(-(t0 * .e4)) * exp(tij * .e4)/.e6)
    .e1 * (.e8 + q * (2 - .e10)) * (q * (.e10 - 2) - .e8)/((.e7 + 
        2 * (.e4/(.e8 - .e5))) * (.e5 - .e8)^2 * .e3^1)
}

d_f_i1_a_abqff1mt <- 
function (a, b, q, f, f1, mu0, theta, m0, r0, tau, t0) 
{
    .e1 <- a^2
    .e2 <- b^2
    .e3 <- .e2 * q
    .e5 <- 2 * .e3 + .e1
    .e6 <- sqrt(.e5)
    .e7 <- 2 * q
    .e8 <- a + .e6
    .e9 <- .e8/.e7
    .e10 <- r0 - .e9
    .e11 <- tau - t0
    .e13 <- 2 * (.e6/.e10) + .e7
    .e15 <- exp(2 * (.e6 * .e11))
    .e17 <- .e7 - .e13 * .e15
    .e18 <- a/.e6
    .e19 <- f - f1
    .e20 <- 1 + .e18
    .e21 <- f - m0
    .e22 <- .e1 * .e19
    .e24 <- 2 * (.e21 * .e6)
    .e25 <- q * .e10
    .e27 <- 2 * (.e22/.e6) - .e24
    .e28 <- .e20 * .e6
    .e29 <- 2 * (a * .e13 * .e11/.e6)
    .e31 <- .e28/.e25 + 2 * .e18
    .e32 <- .e31/.e10
    .e33 <- .e17 * .e8
    .e34 <- .e32 + .e29
    .e35 <- .e1/.e5
    .e36 <- 1 - 4 * (q/.e17)
    .e38 <- exp(-(t0 * .e6))
    .e39 <- exp(tau * .e6)
    .e40 <- .e2/.e6
    .e41 <- a * .e36
    .e42 <- q * .e27
    .e43 <- .e34 * .e15
    .e45 <- 2 * (.e42 * .e38 * .e39/.e33) + .e41 * .e19/.e6
    .e46 <- t0 * .e27
    .e47 <- 2 * .e25
    .e48 <- .e17^2
    .e49 <- 4 * .e35
    .e51 <- a * tau/.e6
    .e52 <- 8 - .e49
    .e54 <- .e43/.e17 + .e51
    .e58 <- 2 * (0.5 * .e46 + f - m0)
    .e59 <- 2 * .e6
    .e60 <- a * q
    .e62 <- .e52 * .e19/2
    .e63 <- 2 - 2 * .e35
    .e65 <- .e20 * .e27/.e8
    .e66 <- .e62 - .e58
    .e68 <- .e40 - .e8/q
    .e71 <- 2 * (.e54 * .e27) + 2 * (a * .e66/.e6 - .e65)
    .e73 <- .e36 * .e63 - 8 * (.e60 * .e34 * .e15/.e48)
    .e74 <- 2 * (q/.e6)
    .e75 <- 2 * .e21
    .e77 <- (-.e17)^2
    .e80 <- .e28/.e47 + .e18
    .e83 <- 2 * ((1/.e10 + .e74)/.e10)
    .e84 <- 2 + 2 * ((.e68 * .e6/.e47 + .e40)/.e10)
    .e85 <- .e2 * .e13
    .e86 <- exp(tau * theta)
    .e87 <- q * .e13
    .e90 <- .e73 * .e19/.e59 + q * .e71 * .e38 * .e39/.e33
    .e91 <- .e45^2
    .e92 <- 1 - .e35
    .e93 <- 2 * (.e6/.e17)
    .e97 <- 0.5 * .e8 + mu0 * .e86 + q * (.e91 - .e93)
    .e98 <- a/.e5
    .e100 <- .e17 * .e6
    .e102 <- 2 - (.e84 + 2 * (.e85 * .e11/.e6)) * .e15
    .e104 <- 2 * (.e80/.e10) + .e29
    .e105 <- .e83 + 4 * (.e87 * .e11/.e6)
    .e106 <- .e22/.e5
    .e107 <- 2 * .e106
    .e108 <- .e20/.e6
    .e109 <- .e25^2
    .e110 <- .e107 + .e75
    .e114 <- 0.5 * .e20
    .e115 <- 2 * (.e90 * .e45)
    .e116 <- 2 * (.e43 * .e6/.e77)
    .e117 <- .e114 + q * (.e115 - (.e116 + 2 * (a/.e100)))
    .e118 <- .e108 - .e98
    .e119 <- .e5 * .e6
    .e121 <- .e105 * .e15
    .e122 <- 2 * ((2 - .e35) * .e19)
    .e124 <- 2 * (.e1/.e6) - .e59
    .e125 <- a * .e2
    .e126 <- .e92/.e6
    .e127 <- 2 * (q * .e17/.e6)
    .e129 <- .e2 * .e17/.e6
    .e130 <- (((.e32 + q * .e20 * .e6/.e109) * .e20/2 + (1 + 
        a * .e118)/.e10)/q + 2 * .e126)/.e10
    .e131 <- ((.e31 * .e68/2 + .e2 * .e118)/.e25 - (.e20 * (r0 - 
        (.e9 + .e68/2)) * .e6/.e109 + 2 * (.e125/.e119)))/.e10
    .e132 <- ((.e32 + q * (.e28/.e109 - 4 * .e98))/.e6 + (2 * 
        .e108 - 2 * .e98)/.e10)/.e10
    .e133 <- (.e20 * .e17 - .e104 * .e8 * .e15)/.e33
    .e135 <- .e100^2
    .e137 <- .e92 * .e13 + 2 * (a * .e80/.e10)
    .e138 <- .e104 * .e15
    .e142 <- .e59^2
    .e143 <- 1 - q * .e102/.e17
    .e145 <- .e122 - .e75
    .e146 <- 2 * .e110
    .e148 <- 2 * (q * tau/.e6) - (.e127 - .e105 * .e8 * .e15)/.e33
    .e150 <- a * (.e83 - 2 * (.e87/.e5))
    .e151 <- a * (.e84 - .e85/.e5)
    .e154 <- .e2 * tau/.e6 - (.e102 * .e8 + .e129)/.e33
    .e155 <- .e131 + (2 * .e151 + 2 * (.e2 * .e34)) * .e11/.e6
    .e158 <- (.e36 * .e92 - 4 * (.e60 * .e104 * .e15/.e48)) * 
        .e19/.e6 + 2 * (q * (.e27 * (.e51 - .e133) + a * (.e122 - 
        (.e75 + .e46))/.e6) * .e38 * .e39/.e33)
    .e165 <- .e97^2
    .e168 <- .e102 * .e6
    .e169 <- .e138 * .e6
    .e171 <- (2 * .e137 + 2 * (a * .e34)) * .e11/.e6
    .e172 <- .e121 * .e6
    .e175 <- (2 * .e150 + 4 * (q * .e34)) * .e11/.e6
    .e176 <- .e27/.e8
    .e177 <- .e5^2
    .e178 <- .e52/2
    .e179 <- 0.5 * .e52
    .e180 <- 1 + q * (4 * (a * .e38 * .e39/.e8) - 4)/.e17
    .e182 <- 2 * (((2 * .e22 - .e3 * (.e110 + .e46))/.e6 + .e42 * 
        .e154 - .e24) * .e38 * .e39/.e33) - a * (4 * (.e143/.e17) + 
        .e2 * .e36/.e5) * .e19/.e6
    .e184 <- 2 * ((.e27 * .e148 - q * (.e146 + 2 * .e46)/.e6) * 
        .e38 * .e39/.e33) - a * (2 * (.e36/.e5) + 4 * (.e121/.e48)) * 
        .e19/.e6
    .e186 <- 2 * (q * .e124 * .e38 * .e39/.e33) + .e41/.e6
    .e187 <- a * .e54
    .e189 <- a * .e27/.e5
    .e191 <- a * .e11/.e6
    .e192 <- t0 * .e71
    .e194 <- t0 * .e110/.e6
    c(a = (0.5 * .e126 + q * (2 * (.e158 * .e90 + .e45 * (q * 
        (.e71 * (.e191 - .e133) + 2 * (((.e130 + .e34 * .e104 * 
            .e15/.e17 + .e171) * .e15/.e17 + tau * .e92/.e6) * 
            .e27 + .e187 * .e145/.e6) + 2 * ((.e62 - (.e58 + 
            .e1 * (((.e178 + 4 * .e92) * .e19 - .e58)/.e5 + t0 * 
                .e145/.e6)))/.e6 - (.e92 * .e27/.e6 + .e20 * 
            (a * .e145/.e6 - .e65))/.e8)) * .e38 * .e39/.e33 - 
        ((4 * (.e41 * .e92/.e5) + q * (4 * (.e63 * .e104) + 8 * 
            (.e34 * (1 + a * (2 * (.e138/.e17) + 2 * .e191)) + 
                a * (.e130 + 2 * (.e137 * .e11/.e6)))) * .e15/.e48)/2 + 
            2 * (a * .e73/.e142)) * .e19/.e6)) - (2 * (((.e130 + 
        .e171) * .e6 + .e34 * (2 * (.e104 * .e17 * .e15 * .e6/.e77) + 
        .e18)) * .e15/.e77) + 2 * (1/.e100 - a * (a * .e17/.e6 - 
        .e169)/.e135))) - (.e114 + q * (2 * (.e158 * .e45) - 
        2 * ((.e169/.e17 + .e18)/.e17))) * .e117/.e97)/.e97, 
        b = b * q * (2 * (q * (.e90 * .e184 + ((.e71 * .e148 + 
            2 * (((.e132 + .e34 * .e105 * .e15/.e17 + .e175) * 
                .e15/.e17 - 2 * (.e60 * tau/.e119)) * .e27 - 
                2 * (q * .e54 * .e110/.e6)) - q * (2 * (a * ((2 * 
            .e66 - 8 * .e106)/.e5 - 2 * .e194) - (.e20 * (2 * 
            .e176 + .e146) + 2 * .e189)/.e8) + 2 * .e192)/.e6) * 
            .e38 * .e39/.e33 - ((4 * (.e63 * .e105 * .e15/.e48) + 
            a * (8 * ((.e132 + .e34 * (2 * (.e121/.e17) + 4 * 
                (q * .e11/.e6)) + 2 * (.e150 * .e11/.e6)) * .e15/.e48) - 
                8 * (.e41/.e177)))/2 + 4 * (.e73/.e142)) * .e19/.e6) * 
            .e45)) + a * (2 * ((.e127 - .e172)/.e135) - 1/.e119) - 
            (.e117 * (1/.e6 + 2 * (q * .e184 * .e45) - 2 * ((.e172/.e17 + 
                .e74)/.e17))/.e97 + 2 * (((.e132 + .e175) * .e6 + 
                .e34 * (2 * (.e105 * .e17 * .e15 * .e6/.e77) + 
                  .e74)) * .e15/.e77)))/.e97, q = (.e115 + q * 
            (2 * (.e90 * .e182 + ((.e71 + q * (.e71 * .e154 + 
                2 * (((.e155 - .e34 * .e102/.e17) * .e15/.e17 - 
                  .e125 * tau/.e119) * .e27 - .e2 * .e54 * .e110/.e6) - 
                .e2 * (2 * (a * (((.e178 - .e49) * .e19 - .e58)/.e5 - 
                  .e194) - ((.e176 + .e107 + .e75) * .e20 + .e189)/.e8) + 
                  .e192)/.e6)) * .e38 * .e39/.e33 - ((4 * (.e143 * 
                .e63/.e17) + a * (8 * ((.e34 * (1 + q * (2 * 
                (.e2 * .e11/.e6) - 2 * (.e102/.e17))) + q * (.e131 + 
                2 * (.e151 * .e11/.e6))) * .e15/.e48) - 4 * (.e125 * 
                .e36/.e177)))/2 + 2 * (.e2 * .e73/.e142)) * .e19/.e6) * 
                .e45) + 2 * (a * (.e168 + .e129)/.e135) - 2 * 
                ((.e155 * .e6 + .e34 * (.e40 - 2 * (.e102 * .e17 * 
                  .e6/.e77))) * .e15/.e77)) - ((.e91 + 0.5 * 
            .e40 + q * (2 * (.e182 * .e45) - 2 * ((.e40 - .e168/.e17)/.e17)) - 
            .e93) * .e117/.e97 + .e116 + a * (0.5 * (.e2/.e5) + 
            2/.e17)/.e6))/.e97, f = q * (2 * (.e90 * .e186 + 
            (.e73/.e59 + q * (2 * (.e54 * .e124) + 2 * (a * (.e179 - 
                2 * (0.5 * (t0 * .e124) + 1))/.e6 - .e20 * .e124/.e8)) * 
                .e38 * .e39/.e33) * .e45) - 2 * (.e117 * .e45 * 
            .e186/.e97))/.e97, f1 = q * (2 * (a * .e117 * .e180 * 
            .e45/.e97) - 2 * ((.e73/2 + .e60 * (2 * (.e179 - 
            a * (2 * (.e20/.e8) + 2 * (a * t0/.e6))) + 4 * .e187) * 
            .e38 * .e39/.e33) * .e45 + a * .e90 * .e180))/(.e97 * 
            .e6), mu0 = -(.e117 * .e86/.e165), theta = -(mu0 * 
            tau * .e117 * .e86/.e165))
}

d_f_i1_b_bqff1mt <- 
function (a, b, q, f, f1, mu0, theta, m0, r0, tau, t0) 
{
    .e1 <- a^2
    .e2 <- b^2
    .e3 <- .e2 * q
    .e5 <- 2 * .e3 + .e1
    .e6 <- sqrt(.e5)
    .e7 <- 2 * q
    .e8 <- a + .e6
    .e10 <- r0 - .e8/.e7
    .e11 <- tau - t0
    .e13 <- 2 * (.e6/.e10) + .e7
    .e15 <- exp(2 * (.e6 * .e11))
    .e17 <- .e7 - .e13 * .e15
    .e18 <- f - f1
    .e19 <- .e1 * .e18
    .e20 <- f - m0
    .e22 <- 2 * (.e20 * .e6)
    .e24 <- 2 * (.e19/.e6) - .e22
    .e25 <- q/.e6
    .e26 <- q * .e13
    .e27 <- 4 * (.e26 * .e11/.e6)
    .e28 <- 4 * .e25
    .e30 <- (2/.e10 + .e28)/.e10 + .e27
    .e31 <- .e17 * .e8
    .e33 <- 1 - 4 * (q/.e17)
    .e34 <- exp(-(t0 * .e6))
    .e35 <- exp(tau * .e6)
    .e36 <- .e30 * .e15
    .e37 <- 2 * .e6
    .e38 <- .e2/.e6
    .e39 <- a * .e33
    .e40 <- q * .e24
    .e42 <- 2 * (.e40 * .e34 * .e35/.e31) + .e39 * .e18/.e6
    .e43 <- 2 * (q * tau/.e6)
    .e44 <- t0 * .e24
    .e45 <- .e24/.e8
    .e46 <- .e17^2
    .e47 <- .e37^2
    .e49 <- .e36/.e17 + .e43
    .e50 <- 2 * .e45
    .e51 <- .e33/.e5
    .e56 <- .e50 + 4 * (0.5 * .e44 + 4 * (.e19/.e47) + f - m0)
    .e58 <- 2 * (q * .e10)
    .e59 <- 4 * .e51
    .e60 <- .e38 - .e8/q
    .e64 <- 2 * (.e49 * .e24) - 2 * (q * .e56/.e6)
    .e65 <- 2 * .e25
    .e66 <- .e59 + 8 * (.e36/.e46)
    .e70 <- 2 * ((1/.e10 + .e65)/.e10)
    .e71 <- 2 + 2 * ((.e60 * .e6/.e58 + .e38)/.e10)
    .e72 <- a * .e66
    .e74 <- (-.e17)^2
    .e78 <- .e64 * .e34 * .e35/.e31 - .e72 * .e18/.e37
    .e79 <- exp(tau * theta)
    .e80 <- .e42^2
    .e82 <- 2 - (.e71 + 2 * (.e2 * .e13 * .e11/.e6)) * .e15
    .e83 <- .e70 + .e27
    .e84 <- 2 * (.e6/.e17)
    .e88 <- 0.5 * .e8 + mu0 * .e79 + q * (.e80 - .e84)
    .e89 <- 2 * (.e19/.e5)
    .e90 <- 2 * .e20
    .e91 <- .e17 * .e6
    .e92 <- 1/.e6
    .e93 <- .e89 + .e90
    .e94 <- .e78 * .e42
    .e97 <- 2 * (.e36 * .e6/.e74)
    .e98 <- 1 - .e3/.e5
    .e101 <- q * (2 * .e94 - 4/.e91)
    .e103 <- .e92 + .e101 - .e97
    .e104 <- .e28 + 4/.e10
    .e105 <- q^2
    .e106 <- .e83 * .e15
    .e108 <- 2 * (.e1/.e6) - .e37
    .e109 <- 2 * (q * .e17/.e6)
    .e111 <- .e2 * .e17/.e6
    .e114 <- (.e104 * .e60/.e58 + 4 * (.e98/.e6))/.e10 + (2 * 
        (.e2 * .e30) + 4 * (.e98 * .e13 + q * .e71)) * .e11/.e6
    .e121 <- (8 * (.e105/.e5) - .e104/.e10)/.e10
    .e123 <- 2 * .e93
    .e124 <- .e43 - (.e109 - .e83 * .e8 * .e15)/.e31
    .e125 <- 4 * ((1 - q * .e82/.e17)/.e17)
    .e126 <- 4 * (.e106/.e46)
    .e130 <- .e2 * .e33/.e5
    .e133 <- .e2 * tau/.e6 - (.e82 * .e8 + .e111)/.e31
    .e135 <- q * (4 * .e30 + 4 * (.e70 - 2 * (.e26/.e5))) * .e11
    .e142 <- .e91^2
    .e144 <- .e30 * .e82/.e17
    .e147 <- .e30 * .e83 * .e15/.e17
    .e148 <- .e88^2
    .e149 <- .e82 * .e6
    .e150 <- .e106 * .e6
    .e151 <- .e56/.e5
    .e152 <- .e5 * .e6
    .e154 <- (.e135 - .e121)/.e6
    .e155 <- 1 + q * (4 * (a * .e34 * .e35/.e8) - 4)/.e17
    .e157 <- 2 * (((2 * .e19 - .e3 * (.e93 + .e44))/.e6 + .e40 * 
        .e133 - .e22) * .e34 * .e35/.e31) - a * (.e125 + .e130) * 
        .e18/.e6
    .e159 <- 2 * ((.e24 * .e124 - q * (.e123 + 2 * .e44)/.e6) * 
        .e34 * .e35/.e31) - a * (2 * .e51 + .e126) * .e18/.e6
    .e161 <- 2 * (q * .e108 * .e34 * .e35/.e31) + .e39/.e6
    .e162 <- .e19/.e37^3
    .e163 <- t0 * .e93
    c(b = q * (.e92 + .e2 * (q * (2 * (((.e64 * .e124 + 2 * (((.e147 + 
        .e154) * .e15/.e17 - 4 * (.e105 * tau/.e152)) * .e24 - 
        2 * (q * .e49 * .e93/.e6)) + q * (2 * (q * ((2 * ((.e50 + 
        .e123)/.e8) + 4 * (32 * .e162 + .e163))/.e6 + 2 * .e151)) - 
        2 * (t0 * .e64))/.e6) * .e34 * .e35/.e31 - a * (8 * ((.e154 + 
        2 * .e147) * .e15/.e46) - q * (2 * .e66 + 4 * (.e59 + 
        .e126))/.e5) * .e18/.e37) * .e42 + q * .e78 * .e159) + 
        4 * ((.e109 - .e150)/.e142) - ((.e92 + 2 * (q * .e159 * 
        .e42) - 2 * ((.e150/.e17 + .e65)/.e17)) * .e103/.e88 + 
        2/.e152)) - 2 * ((.e30 * (2 * (.e83 * .e17 * .e15 * .e6/.e74) + 
        .e65) + .e135 - .e121) * .e15/.e74)) + .e101 - .e97)/.e88, 
        q = b * (.e92 + q * (4 * .e94 + q * (2 * (((.e64 * .e133 + 
            2 * (((.e114 - .e144) * .e15/.e17 + 2 * (tau * .e98/.e6)) * 
                .e24 - .e2 * .e49 * .e93/.e6) - (2 * (.e56 - 
            .e3 * ((2 * ((.e45 + .e89 + .e90)/.e8) + 4 * (0.5 * 
                .e163 + 16 * .e162))/.e6 + .e151)) + .e2 * t0 * 
            .e64)/.e6) * .e34 * .e35/.e31 - a * (8 * ((.e114 - 
            2 * .e144) * .e15/.e46) - (4 * (2 * .e130 + .e125) + 
            .e2 * .e66)/.e5) * .e18/.e37) * .e42 + .e78 * .e157) + 
            4 * ((.e149 + .e111)/.e142)) - ((.e80 + 0.5 * .e38 + 
            q * (2 * (.e157 * .e42) - 2 * ((.e38 - .e149/.e17)/.e17)) - 
            .e84) * .e103/.e88 + (8/.e17 + .e2/.e5)/.e6 + 2 * 
            ((.e114 * .e6 + .e30 * (.e38 - 2 * (.e82 * .e17 * 
                .e6/.e74))) * .e15/.e74))) - .e97)/.e88, f = b * 
            .e105 * (2 * (.e78 * .e161 + ((2 * (.e49 * .e108) - 
            2 * (q * (2 * (.e108/.e8) + 4 * (0.5 * (t0 * .e108) + 
                1 + 4 * (.e1/.e47)))/.e6)) * .e34 * .e35/.e31 - 
            .e72/.e37) * .e42) - 2 * (.e103 * .e42 * .e161/.e88))/.e88, 
        f1 = a * b * .e105 * (2 * ((.e66/2 + a * (2 * (q * (4 * 
            (4/.e47 + t0/.e6) + 4/(.e8 * .e6))) - 4 * .e49) * 
            .e34 * .e35/.e31) * .e42 - .e78 * .e155) + 2 * (.e155 * 
            .e103 * .e42/.e88))/(.e88 * .e6), mu0 = -(b * q * 
            .e103 * .e79/.e148), theta = -(b * mu0 * q * tau * 
            .e103 * .e79/.e148))
}

d_f_i1_q_qff1mtb <-
function (a, b, q, f, f1, mu0, theta, m0, r0, tau, t0) 
{
    .e1 <- b^2
    .e2 <- a^2
    .e3 <- .e1 * q
    .e5 <- 2 * .e3 + .e2
    .e6 <- sqrt(.e5)
    .e7 <- 2 * q
    .e8 <- a + .e6
    .e10 <- r0 - .e8/.e7
    .e11 <- tau - t0
    .e13 <- 2 * (.e6/.e10) + .e7
    .e15 <- exp(2 * (.e6 * .e11))
    .e17 <- .e7 - .e13 * .e15
    .e18 <- f - f1
    .e19 <- .e2 * .e18
    .e20 <- .e1/.e6
    .e21 <- f - m0
    .e23 <- 2 * (.e21 * .e6)
    .e25 <- 2 * (.e19/.e6) - .e23
    .e26 <- .e7^2
    .e27 <- 2 * (q * .e6)
    .e31 <- .e1/.e27 - 2 * (.e8/.e26)
    .e32 <- .e1 * .e13
    .e33 <- 2 * (.e32 * .e11/.e6)
    .e34 <- .e17 * .e8
    .e38 <- 2 * (.e31 * .e6/.e10) + 2 * .e20
    .e40 <- 1 - 4 * (q/.e17)
    .e41 <- exp(-(t0 * .e6))
    .e42 <- exp(tau * .e6)
    .e45 <- .e38/.e10 + 2 + .e33
    .e46 <- 2 * .e6
    .e48 <- 2 - .e45 * .e15
    .e49 <- q * .e25
    .e50 <- a * .e40
    .e52 <- .e50 * .e18/.e6
    .e53 <- .e8/q
    .e55 <- 2 * (.e49 * .e41 * .e42/.e34) + .e52
    .e56 <- q * .e48
    .e57 <- t0 * .e25
    .e58 <- .e20 - .e53
    .e59 <- 2 * (q/.e6)
    .e61 <- .e1 * tau/.e6
    .e62 <- .e46^2
    .e65 <- .e58 * .e6/(2 * (q * .e10)) + .e20
    .e67 <- 1/.e10 + .e59
    .e70 <- .e1 * .e40/.e5
    .e71 <- .e61 - .e48/.e17
    .e75 <- 0.5 * .e57 + 4 * (.e19/.e62) + f - m0
    .e79 <- 2 * (.e67/.e10)
    .e80 <- 2 + 2 * (.e65/.e10)
    .e81 <- 4 - 4 * (.e56/.e17)
    .e82 <- q * .e13
    .e83 <- 2 * .e70
    .e86 <- 2 * (.e25 * .e71)
    .e87 <- 2 * (.e81/.e17)
    .e88 <- 2 * (2 * (.e1 * .e75/.e6) + 2 * (.e49 * .e31/.e8))
    .e90 <- 2 - (.e80 + .e33) * .e15
    .e91 <- .e79 + 4 * (.e82 * .e11/.e6)
    .e92 <- .e86 - .e88
    .e93 <- .e87 + .e83
    .e94 <- 2 * (.e19/.e5)
    .e95 <- 2 * .e21
    .e96 <- a * .e93
    .e97 <- .e3/.e6
    .e98 <- exp(tau * theta)
    .e102 <- .e55^2
    .e104 <- 2 * (.e25 * .e41 * .e42/.e34) + 2 * (q * .e92 * 
        .e41 * .e42/.e34 - .e96 * .e18/.e46)
    .e105 <- .e94 + .e95
    .e106 <- 2 * (.e6/.e17)
    .e108 <- (-.e17)^2
    .e112 <- 0.5 * .e8 + mu0 * .e98 + q * (.e102 - .e106)
    .e113 <- .e27^2
    .e115 <- 2 * .e97 + .e46
    .e116 <- .e52 + q * .e104
    .e117 <- 0.5 * .e20
    .e118 <- .e3/.e5
    .e123 <- .e55 * .e116 + .e117 + 2 * (.e56 * .e6/.e108) - 
        .e115/.e17
    .e124 <- .e17^2
    .e125 <- 2 - 2 * .e118
    .e126 <- b^4
    .e127 <- .e91 * .e15
    .e128 <- .e5 * .e6
    .e130 <- 2 * (.e2/.e6) - .e46
    .e131 <- (.e90 * .e8 + .e1 * .e17/.e6)/.e34
    .e132 <- .e40/.e5
    .e134 <- .e125/.e6
    .e140 <- 1/q
    .e142 <- 2 * ((.e20 - 2 * .e53)/.e26) + 2 * (.e1 * (.e97 + 
        .e6)/.e113)
    .e143 <- 2 * .e105
    .e146 <- 2 * (q * (2 * (.e3/.e113) + 2/.e26))
    .e148 <- 2 * (q * tau/.e6) - (2 * (q * .e17/.e6) - .e91 * 
        .e8 * .e15)/.e34
    .e149 <- 4 * ((1 - q * .e90/.e17)/.e17)
    .e150 <- 4 * (.e127/.e124)
    .e151 <- .e126/.e128
    .e153 <- ((.e38 * .e58/.e7 + 2 * (.e65 * .e31 - .e142 * .e6))/.e10 - 
        2 * .e151)/.e10 + .e1 * (2 * .e45 + 2 * (.e80 - .e32/.e5)) * 
        .e11/.e6
    .e155 <- ((.e38/.e6 + 2 * (.e67 * .e31 + .e140 - .e146))/.e10 + 
        2 * .e134)/.e10 + (2 * (2 * .e13 + .e1 * (.e79 - 2 * 
        (.e82/.e5))) + 4 * (q * .e45)) * .e11/.e6
    .e159 <- 2 * ((.e25 * .e148 - q * (.e143 + 2 * .e57)/.e6) * 
        .e41 * .e42/.e34)
    .e162 <- 2 * .e19
    .e163 <- .e105 + .e57
    .e167 <- a * (2 * .e132 + .e150) * .e18/.e6
    .e170 <- a * (.e149 + .e70) * .e18/.e6
    .e171 <- .e61 - .e131
    .e172 <- (.e45 + q * .e153) * .e15
    .e178 <- .e112^2
    .e179 <- .e75/.e5
    .e182 <- .e48 * .e91/.e17 - .e155
    .e183 <- .e25/.e8
    .e186 <- 2 * (((.e162 - .e3 * .e163)/.e6 + .e49 * .e171 - 
        .e23) * .e41 * .e42/.e34) - .e170
    .e187 <- .e159 - .e167
    .e190 <- 4 * (a * .e41 * .e42/.e8)
    .e191 <- .e52 + q * (.e104 - 2 * (.e123 * .e55/.e112))
    .e192 <- .e50/.e6
    .e193 <- .e19/.e46^3
    .e194 <- q * .e130
    .e195 <- t0 * .e105
    c(q = (.e186 * .e116 + (.e104 + q * (2 * ((.e25 * .e171 - 
        .e1 * .e163/.e6) * .e41 * .e42/.e34) + 2 * ((.e86 + q * 
        (.e92 * (.e1 * .e11/.e6 - .e131) - (2 * (.e25 * (.e126 * 
            tau/.e128 - (.e153 * .e15 + .e48 * .e90/.e17)/.e17) + 
            .e1 * .e105 * .e71/.e6) + 2 * (2 * ((((.e162 - .e3 * 
            (.e183 + .e94 + .e95))/.e6 - .e23) * .e31 - q * .e142 * 
            .e25)/.e8) - 2 * (.e126 * ((0.5 * .e195 + 16 * .e193)/.e6 + 
            .e179)/.e6)))) - .e88) * .e41 * .e42/.e34 + a * (2 * 
        ((.e90 * .e81 + 4 * (2 - (.e172 + .e56 * .e90/.e17)))/.e124) + 
        .e1 * (.e87 + 2 * (.e83 + .e149) + .e83)/.e5) * .e18/.e46)) - 
        .e170) * .e55 + 2 * (((2 - .e172) * .e6 + .e56 * (.e20 - 
        2 * (.e90 * .e17 * .e6/.e108)))/.e108) - (.e123 * (.e102 + 
        .e117 + q * (2 * (.e186 * .e55) - 2 * ((.e20 - .e90 * 
        .e6/.e17)/.e17)) - .e106)/.e112 + (.e1 * (2 + 2 * (1 - 
        .e118))/.e6 - .e90 * .e115/.e17)/.e17 + 0.5 * .e151))/.e112, 
        f = (.e55 * (.e192 + q * (2 * (.e130 * .e41 * .e42/.e34) + 
            2 * (q * (2 * (.e130 * .e71) - 2 * (2 * (.e1 * (0.5 * 
                (t0 * .e130) + 1 + 4 * (.e2/.e62))/.e6) + 2 * 
                (.e194 * .e31/.e8))) * .e41 * .e42/.e34 - .e96/.e46))) + 
            (2 * (.e194 * .e41 * .e42/.e34) + .e192) * .e191)/.e112, 
        f1 = a * (.e55 * (q * ((4 - .e190)/.e17 + 2 * (.e93/2 + 
            a * q * (2 * (2 * (.e1 * (4/.e62 + t0/.e6)) + 4 * 
                (q * .e31/.e8)) - 4 * .e71) * .e41 * .e42/.e34)) - 
            1) - (1 + q * (.e190 - 4)/.e17) * .e191)/(.e112 * 
            .e6), mu0 = -(.e123 * .e98/.e178), theta = -(mu0 * 
            tau * .e123 * .e98/.e178), b = b * (0.5 * .e134 + 
            q * (.e187 * .e116 + (.e159 + 2 * (q * (.e92 * .e148 + 
                2 * (.e25 * (tau * .e125/.e6 - .e182 * .e15/.e17) - 
                  2 * (q * .e105 * .e71/.e6)) - (2 * (2 * (2 * 
                .e75 - .e3 * ((32 * .e193 + .e195)/.e6 + 2 * 
                .e179)) + 2 * (q * ((.e140 - .e146) * .e25 - 
                q * (2 * .e183 + .e143) * .e31)/.e8)) + 2 * (q * 
                t0 * .e92))/.e6) * .e41 * .e42/.e34 - a * ((2 * 
                (2 * .e40 - .e3 * (4 * .e132 + .e150)) - 2 * 
                (q * .e93))/.e5 - 2 * ((4 * (q * .e182) - .e91 * 
                .e81) * .e15/.e124)) * .e18/.e46) - .e167) * 
                .e55 + 2 * ((.e48 * (2 * (.e91 * .e17 * .e15 * 
                .e6/.e108) + .e59) - .e155 * .e15 * .e6)/.e108) - 
                .e123 * (1/.e6 + 2 * (q * .e187 * .e55) - 2 * 
                  ((.e127 * .e6/.e17 + .e59)/.e17))/.e112) - 
            (.e91 * .e115 * .e15/.e17 + q * (2 * .e125 + 4)/.e6)/.e17)/.e112)
}

d_f_i1_f_ff1mt <- 
function (a, b, q, f, f1, mu0, theta, m0, r0, tau, t0) 
{
    .e1 <- a^2
    .e4 <- sqrt(2 * (b^2 * q) + .e1)
    .e5 <- 2 * q
    .e6 <- a + .e4
    .e8 <- .e5 - (2 * (.e4/(r0 - .e6/.e5)) + .e5) * exp(2 * (.e4 * 
        (tau - t0)))
    .e9 <- f - f1
    .e11 <- exp(-(t0 * .e4))
    .e12 <- exp(tau * .e4)
    .e13 <- .e8 * .e6
    .e15 <- a * (1 - 4 * (q/.e8))
    .e21 <- 2 * (q * (2 * (.e1 * .e9/.e4) - 2 * ((f - m0) * .e4)) * 
        .e11 * .e12/.e13) + .e15 * .e9/.e4
    .e22 <- .e21^2
    .e23 <- exp(tau * theta)
    .e27 <- 0.5 * .e6 + mu0 * .e23 + q * (.e22 - 2 * (.e4/.e8))
    .e31 <- 2 * (q * (2 * (.e1/.e4) - 2 * .e4) * .e11 * .e12/.e13) + 
        .e15/.e4
    .e32 <- .e27^2
    .e33 <- 1 - 2 * (q * .e22/.e27)
    c(f = 2 * (q * .e33 * .e31^2/.e27), f1 = -(2 * (a * q * .e33 * 
        (1 + q * (4 * (a * .e11 * .e12/.e6) - 4)/.e8) * .e31/(.e27 * 
        .e4))), mu0 = -(2 * (q * .e21 * .e31 * .e23/.e32)), theta = -(2 * 
        (mu0 * q * tau * .e21 * .e31 * .e23/.e32)))
}

d_f_i1_f1_f1mt <-
function (a, b, q, f, f1, mu0, theta, m0, r0, tau, t0) 
{
    .e1 <- a^2
    .e4 <- sqrt(2 * (b^2 * q) + .e1)
    .e5 <- 2 * q
    .e6 <- a + .e4
    .e8 <- .e5 - (2 * (.e4/(r0 - .e6/.e5)) + .e5) * exp(2 * (.e4 * 
        (tau - t0)))
    .e9 <- f - f1
    .e11 <- exp(-(t0 * .e4))
    .e12 <- exp(tau * .e4)
    .e20 <- 2 * (q * (2 * (.e1 * .e9/.e4) - 2 * ((f - m0) * .e4)) * 
        .e11 * .e12/(.e8 * .e6)) + a * (1 - 4 * (q/.e8)) * .e9/.e4
    .e21 <- exp(tau * theta)
    .e22 <- .e20^2
    .e23 <- (0.5 * .e6 + mu0 * .e21 + q * (.e22 - 2 * (.e4/.e8))) * 
        .e4
    .e24 <- .e23^2
    .e25 <- 1 + q * (4 * (a * .e11 * .e12/.e6) - 4)/.e8
    c(f1 = 2 * (.e1 * q * .e25^2 * (1/.e23 - 2 * (q * .e22 * 
        .e4/.e24))/.e4), mu0 = 2 * (a * q * .e25 * .e20 * .e21 * 
        .e4/.e24), theta = 2 * (a * mu0 * q * tau * .e25 * .e20 * 
        .e21 * .e4/.e24))
}

d_f_i1_m_mt <-
function (a, b, q, f, f1, mu0, theta, m0, r0, tau, t0) 
{
    .e1 <- a^2
    .e4 <- sqrt(2 * (b^2 * q) + .e1)
    .e5 <- 2 * q
    .e6 <- a + .e4
    .e8 <- .e5 - (2 * (.e4/(r0 - .e6/.e5)) + .e5) * exp(2 * (.e4 * 
        (tau - t0)))
    .e9 <- exp(tau * theta)
    .e11 <- mu0 * .e9
    .e17 <- 0.5 * .e6 + .e11 + q * ((2 * (q * (2 * (.e1 * (f - 
        f1)/.e4) - 2 * ((f - m0) * .e4)) * exp(-(t0 * .e4)) * 
        exp(tau * .e4)/(.e8 * .e6)) + a * (1 - 4 * (q/.e8)) * 
        (f - f1)/.e4)^2 - 2 * (.e4/.e8))
    c(mu0 = -(.e9^2/.e17^2), theta = tau * (1 - .e11/.e17) * 
        .e9/.e17)
}

d_f_i1_t_t <- 
function (a, b, q, f, f1, mu0, theta, m0, r0, tau, t0) 
{
    .e1 <- a^2
    .e4 <- sqrt(2 * (b^2 * q) + .e1)
    .e5 <- 2 * q
    .e6 <- a + .e4
    .e8 <- .e5 - (2 * (.e4/(r0 - .e6/.e5)) + .e5) * exp(2 * (.e4 * 
        (tau - t0)))
    .e9 <- exp(tau * theta)
    .e11 <- mu0 * .e9
    .e17 <- 0.5 * .e6 + .e11 + q * ((2 * (q * (2 * (.e1 * (f - 
        f1)/.e4) - 2 * ((f - m0) * .e4)) * exp(-(t0 * .e4)) * 
        exp(tau * .e4)/(.e8 * .e6)) + a * (1 - 4 * (q/.e8)) * 
        (f - f1)/.e4)^2 - 2 * (.e4/.e8))
    mu0 * tau^2 * (1 - .e11/.e17) * .e9/.e17
}

deriv_mu_int_a_abqff1 <-
function (a, b, q, f, f1, mu0, theta, tij, r0, m0, t0) 
{
    .e1 <- a^2
    .e2 <- b^2
    .e3 <- .e2 * q
    .e5 <- 2 * .e3 + .e1
    .e6 <- sqrt(.e5)
    .e7 <- 2 * q
    .e8 <- a + .e6
    .e9 <- .e8/.e7
    .e10 <- r0 - .e9
    .e11 <- a/.e6
    .e12 <- 2 * (.e6/.e10)
    .e13 <- .e12 + .e7
    .e14 <- f - f1
    .e15 <- tij - t0
    .e16 <- q * .e10
    .e17 <- 1 + .e11
    .e18 <- f - m0
    .e19 <- .e1 * .e14
    .e21 <- exp(2 * (.e6 * .e15))
    .e22 <- .e17 * .e6
    .e24 <- 2 * (.e18 * .e6)
    .e26 <- 2 * (.e19/.e6) - .e24
    .e27 <- 2 * .e6
    .e29 <- .e22/.e16 + 2 * .e11
    .e31 <- .e7 - .e13 * .e21
    .e32 <- t0 * .e6
    .e33 <- .e1/.e5
    .e34 <- .e29/.e10
    .e35 <- a * t0
    .e36 <- .e27^2
    .e37 <- a * .e13
    .e38 <- .e2/.e6
    .e40 <- exp(-.e32)
    .e41 <- 2 * .e16
    .e42 <- 2 * (.e37 * .e15/.e6)
    .e43 <- 2 * (.e35 * .e13/.e6)
    .e44 <- .e34 - .e43
    .e45 <- 4 * .e33
    .e46 <- .e34 + .e42
    .e47 <- 8 - .e45
    .e48 <- t0 * .e26
    .e50 <- .e38 - .e8/q
    .e52 <- exp(-(2 * .e32))
    .e56 <- 0.5 * .e48 + f - m0
    .e57 <- exp(-(tij * .e6))
    .e58 <- 1 - .e33
    .e59 <- 2 * .e56
    .e60 <- 0.5 + .e16/.e27
    .e62 <- q/.e31 - 0.5
    .e63 <- .e47 * .e14
    .e65 <- .e17 * .e26/.e8
    .e66 <- .e63/2
    .e67 <- .e66 - .e59
    .e68 <- 2 * .e18
    .e69 <- 2 * (q/.e6)
    .e72 <- a * .e67/.e6 - .e65
    .e73 <- .e22/.e41
    .e75 <- 1/.e10 + .e69
    .e76 <- .e13 * .e36
    .e77 <- .e31^2
    .e79 <- (-.e12)^2
    .e80 <- .e79 * .e10
    .e81 <- .e73 + .e11
    .e82 <- .e19/.e5
    .e85 <- .e50 * .e6/.e41 + .e38
    .e86 <- a * tij
    .e87 <- q * .e46
    .e90 <- .e13 * .e8^2 * .e52
    .e92 <- 2 * .e82
    .e93 <- 2 + 2 * (.e85/.e10)
    .e94 <- a * q
    .e95 <- q * .e29
    .e96 <- .e5 * .e6
    .e97 <- .e35 * .e60
    .e102 <- 2 * (.e44 * .e6)
    .e104 <- 4 * .e72 - 2 * (.e44 * .e26/.e13)
    .e105 <- a * .e2
    .e107 <- .e97/.e6 + .e95/.e80
    .e110 <- .e86 * .e62/.e6 - .e87 * .e21/.e77
    .e111 <- .e14^2
    .e112 <- .e102 + 4 * (.e37/.e6)
    .e113 <- .e92 + .e68
    .e114 <- .e2 * .e13
    .e115 <- .e40^2
    .e116 <- q * .e26
    .e118 <- (-(4 * (.e5/.e10)))^2
    .e121 <- .e107 * .e40 + .e110 * .e57
    .e122 <- 2 * (.e75/.e10)
    .e123 <- q * .e13
    .e124 <- .e118 * .e10
    .e125 <- .e46 * .e21
    .e126 <- (2 * (.e31 * .e6))^2
    .e127 <- 32 * (a * .e72)
    .e128 <- a * .e112
    .e130 <- .e60 * .e40 + .e57 * .e62
    .e131 <- 32 - 64 * (.e128 * .e6/.e76)
    .e132 <- a * .e31
    .e134 <- .e9 + .e50/2
    .e135 <- 2 * ((2 - .e33) * .e14)
    .e136 <- a * .e58
    .e137 <- .e132/.e6
    .e141 <- .e58/.e6
    .e143 <- .e26 * .e131 + .e127
    .e145 <- 2 * (.e81/.e10)
    .e147 <- 2 * (.e29 * .e6) + 4 * a
    .e148 <- .e135 - .e68
    .e150 <- 2 * .e137 - 2 * (.e125 * .e6)
    .e152 <- 2 * (.e1/.e6) - .e27
    .e153 <- .e105/.e96
    .e155 <- t0 * .e36/.e6
    .e157 <- .e17 * .e75 - 2 * (.e94/.e5)
    .e158 <- .e17 * (.e38 - (r0 - .e134) * .e6/.e16)
    .e159 <- (.e93 + 2 * (.e114 * .e15/.e6)) * .e21
    .e160 <- .e145 + .e42
    .e161 <- 2 * .e141
    .e162 <- .e122 + 4 * (.e123 * .e15/.e6)
    .e163 <- 2 * .e153
    .e164 <- 4 * (.e94/.e96)
    .e165 <- 64 * (.e136 * .e111/.e36)
    .e166 <- .e105/.e5
    .e167 <- (2 * (.e116 * .e40/.e8))^2
    .e168 <- .e13 * .e52
    .e170 <- 2 * (.e116 * .e104 * .e115/.e90) + .e165
    .e171 <- a * .e121
    .e172 <- .e130 * .e143
    .e174 <- .e147/.e124 + .e150/.e126
    .e175 <- .e162 * .e21
    .e177 <- .e76 * .e8 * .e52
    .e179 <- .e10/.e27 + 1/.e31
    .e180 <- 2 - .e159
    .e181 <- .e122 - 2 * (.e123/.e5)
    .e183 <- .e93 - .e114/.e5
    .e184 <- 8 - 2 * .e155
    .e185 <- a * .e81
    .e186 <- ((.e29 * .e50/2 + .e158 - .e166)/.e16 - .e163)/.e10
    .e188 <- ((.e29/2 + .e73 + .e11) * .e17 + 1 - .e33)/.e16 + 
        .e161
    .e189 <- (.e157/q + .e29/.e6)/.e10
    .e190 <- (a * .e14/.e27)^2
    .e191 <- 32 * (.e171 * .e26)
    .e192 <- a * .e148
    .e193 <- .e188/.e10
    .e194 <- (.e189 - .e164)/.e10
    .e195 <- .e172 - .e191
    .e196 <- .e58/.e36
    .e197 <- .e17/.e8
    .e198 <- .e160 * .e21
    .e201 <- (2 * .e185 + .e27)/.e10 + .e7 - .e1 * .e13/.e5
    .e202 <- .e26/.e8
    .e205 <- .e167/.e168 + 32 * (q * .e190)
    .e206 <- .e47/2
    .e207 <- 0.5 * .e47
    .e208 <- 2 * .e113
    .e209 <- a * .e181
    .e210 <- .e192/.e6
    .e212 <- a * .e26/.e5
    .e213 <- a * .e183
    .e214 <- .e35/.e6
    .e215 <- .e1/.e5^2
    .e217 <- t0 * .e113/.e6
    .e218 <- .e80^2
    .e219 <- .e124^2
    .e221 <- (.e81 * .e17 + 1 - .e33)/.e16 + .e161
    .e222 <- .e125 + .e29 * .e31/.e27
    .e224 <- .e157/.e16 - .e164
    .e226 <- (.e158 - .e166)/.e16 - .e163
    .e229 <- .e90^2
    .e230 <- .e168^2
    .e234 <- .e36 * .e93 + .e114 * .e184
    .e236 <- 1/.e6 + 2 * (.e16/.e5)
    .e239 <- 2 * (.e81 * .e36/.e10) + .e37 * .e184
    .e241 <- 2 * (.e75 * .e36/.e10) + q * (16 - 4 * .e155) * 
        .e13
    .e243 <- 32 * .e26 + .e127
    .e244 <- a * .e44
    .e245 <- a * .e46
    .e246 <- .e2 * .e46
    .e247 <- .e2 * .e31
    .e248 <- q * .e31
    .e250 <- t0 * .e107 * .e40
    .e252 <- tij * .e110 * .e57
    .e253 <- .e186 + (2 * .e213 + 2 * .e246) * .e15/.e6
    .e259 <- (.e58 * .e26/.e6 + .e17 * (.e210 - .e65))/.e8
    .e262 <- (1 - .e1 * (.e58 * (2/.e5 + 8/.e36) + 1/.e5)) * 
        .e111/.e36
    .e265 <- .e58 * .e14
    .e268 <- .e17/.e7
    .e269 <- .e197 + .e214
    .e271 <- .e17/2 + .e94 * .e10/.e5
    .e272 <- .e236/.e27
    .e273 <- .e112 * .e26
    .e274 <- .e175 + 2 * (.e248/.e5)
    .e275 <- .e175/.e77
    .e277 <- (2 * .e201 + 2 * .e245) * .e15/.e6
    .e281 <- (2 * .e209 + 4 * .e87) * .e15/.e6
    .e282 <- .e170/.e5
    .e283 <- .e90 * .e6
    .e284 <- .e27^3
    .e288 <- .e207 - a * (2 * .e197 + 2 * .e214)
    .e289 <- 1 - q * .e180/.e31
    .e291 <- 1/.e8 + t0
    .e293 <- 16 * .e196 - 4 * .e215
    .e294 <- 2 - (.e159 + .e247/.e5)
    .e295 <- 2 * (.e35 * .e181/.e6)
    .e296 <- 2 * (.e35 * .e183/.e6)
    .e297 <- 2 * .e19
    .e299 <- 2 * (t0 * (.e58 * .e13 + 2 * (.e185/.e10))/.e6)
    .e300 <- 2 * .e48
    .e302 <- 2 * t0 + 2/.e8
    .e304 <- 8 * .e196 - 2 * .e215
    .e306 <- a * (((.e206 - .e45) * .e14 - .e59)/.e5 - .e217) - 
        ((.e202 + .e92 + .e68) * .e17 + .e212)/.e8
    .e308 <- a * ((2 * .e67 - 8 * .e82)/.e5 - 2 * .e217) - (.e17 * 
        (2 * .e202 + .e208) + 2 * .e212)/.e8
    .e311 <- a * (.e207 - 2 * (0.5 * (t0 * .e152) + 1))/.e6 - 
        .e17 * .e152/.e8
    .e312 <- .e136 * .e14
    .e313 <- .e1 * (((.e206 + 4 * .e58) * .e14 - .e59)/.e5 + 
        t0 * .e148/.e6)
    .e314 <- .e2 * .e44
    .e315 <- .e2 * t0
    .e316 <- q * .e44
    .e317 <- q * .e113
    .e318 <- r0 - (.e134 + .e3 * .e10/.e5)
    .e319 <- t0 * .e104
    .e320 <- .e250 + .e252
    .e321 <- t0 * .e8
    c(a = (q * (.e58/(2 * (q * .e6)) + 8 * .e262) - .e141) * 
        .e15 + q * (q * (((.e198/.e77 - (.e268 + a * .e10/.e5)/.e27) * 
        .e170 + .e179 * (2 * (q * ((.e26 * (4 * ((.e66 - (.e59 + 
        .e313))/.e6 - .e259) - (2 * ((((.e188 - 2 * (.e44 * .e81/.e13))/.e10 - 
        .e299) * .e26 + .e244 * .e148/.e6)/.e13) + 2 * (.e35 * 
        .e104/.e6))) + .e192 * .e104/.e6)/.e90 - ((2 * .e17 - 
        2 * (.e35 * .e8/.e6)) * .e13 + 2 * (.e81 * .e8/.e10)) * 
        .e26 * .e104 * .e8 * .e52/.e229) * .e115) + 64 * .e262 - 
        a * .e170/.e5))/.e27 - (.e130 * (32 * (a * ((.e63 - (4 * 
        .e56 + .e313))/.e6 - .e259) - .e65) + 32 * .e210 - (.e239 * 
        .e243 + 64 * (((.e102 + a * ((4 * .e201 + 4 * .e13)/.e6 + 
        2 * ((.e193 - .e299) * .e6 + .e244/.e6))) * .e26 + .e1 * 
        .e112 * (.e135 - (.e68 + .e300))/.e6) * .e6 + .e128 * 
        .e26 * (.e11 - 2 * (.e239 * .e6/.e76))))/.e76) + .e143 * 
        (q * .e160 * .e57 * .e21/.e77 - ((.e271/2 + .e97) * .e40 + 
            .e86 * .e57 * .e62)/.e6) - (.e195 * .e269 + 32 * 
        ((.e121 + a * (.e40 * (q * (.e221/.e80 - .e29 * (8 * 
            (.e81 * .e6/.e10) - .e79 * .e17/.e7)/.e218) + t0 * 
            (.e60 - a * (.e271/.e27 + a * .e60/.e5))/.e6) + .e57 * 
            (tij * (.e58 * .e62 + .e94 * .e160 * .e21/.e77)/.e6 - 
                q * (.e193 + .e46 * (2 * (.e198/.e31) + 2 * (a * 
                  .e15/.e6)) + 2 * (.e201 * .e15/.e6)) * .e21/.e77) - 
            (.e121 * .e239/.e76 + a * .e320/.e6))) * .e26 + .e1 * 
            .e121 * .e148/.e6))) * .e40 * .e14/.e177) - (((2 * 
        (.e221 * .e6 + a * .e29/.e6) + 4)/.e124 + (2 * ((.e58 * 
        .e31 - a * .e160 * .e21)/.e6) - (2 * (((.e193 + .e277) * 
        .e6 + .e245/.e6) * .e21) + 8 * (.e150 * .e31 * (.e137 - 
        .e198 * .e6) * .e6/.e126)))/.e126 - .e147 * (32 * ((.e17 * 
        .e5/.e41 + 2 * a) * .e5/.e10) - .e118 * .e17/.e7)/.e219) * 
        .e205 + .e174 * (q * (.e165 + 8 * (.e116 * (.e210 - .e269 * 
        .e26) * .e115/.e90)) - (.e145 - .e43) * .e167 * .e52/.e230))) - 
        0.5 * (((.e193 + .e222 * .e160/.e31 + .e277) * .e21 + 
            (.e221 * .e31 - .e29 * (.e198 + .e132/.e5))/.e27)/.e31), 
        b = b * (q * (.e174 * ((.e122 - 4 * (q * t0 * .e13/.e6)) * 
            .e167 * .e52/.e230 + q^2 * (256 * (.e1 * .e111/.e284) + 
            8 * (q * (.e26 * .e302 + .e208) * .e26 * .e115/.e90))/.e6) + 
            a * (1/.e96 - 8 * (q * .e293 * .e111/.e36)) * .e15 + 
            q * (((.e275 - .e272) * .e170 - q * .e179 * (2 * 
                ((((2 * ((((.e189 - (2 * (.e44 * .e75/.e13) + 
                  .e164))/.e10 - .e295) * .e26 - 2 * (.e316 * 
                  .e113/.e6))/.e13) + q * (4 * .e308 + 4 * .e319)/.e6) * 
                  .e26 + 2 * (.e317 * .e104/.e6))/.e90 + (2 * 
                  (.e75 * .e8/.e10) + .e123 * (4 - 4 * .e321)/.e6) * 
                  .e26 * .e104 * .e8 * .e52/.e229) * .e115) + 
                2 * .e282 + 64 * (a * .e293 * .e111/.e36)))/.e27 - 
                .e40 * .e14 * (q * ((.e162 * .e57 * .e21/.e77 - 
                  ((.e236/2 + 2 * (t0 * .e60)) * .e40 + 2 * (tij * 
                    .e57 * .e62))/.e6) * .e143 - .e195 * .e302/.e6) - 
                  (.e130 * (.e241 * .e243/.e76 + 64 * (.e317/.e6) + 
                    a * (32 * (q * .e308/.e6) + 64 * ((((2 * 
                      ((.e194 - .e295) * .e6 + 2 * (.e316/.e6)) + 
                      4 * (.e209/.e6)) * .e26 - q * .e112 * (.e208 + 
                      4 * .e48)/.e6) * .e6 + .e273 * (.e69 - 
                      2 * (.e241 * .e6/.e76)))/.e76))) + 32 * 
                    (a * (.e26 * (q * ((.e224/.e80 - (.e29 * 
                      (8 * (.e75 * .e6/.e10) - .e79/.e6)/.e218 + 
                      .e35 * (.e272 + 2 * (.e60/.e5))/.e6)) * 
                      .e40 + (.e86 * (.e275 - 2 * (.e62/.e5))/.e6 - 
                      (.e194 + .e46 * (2 * (.e175/.e31) + 4 * 
                        (q * .e15/.e6)) + 2 * (.e209 * .e15/.e6)) * 
                        .e21/.e77) * .e57 - (2 * .e250 + 2 * 
                      .e252)/.e6) - .e121 * .e241/.e76) - 2 * 
                      (q * .e121 * .e113/.e6)))))/.e177) - .e205 * 
            (2 * ((.e224 * .e6 + 2 * (.e95/.e6))/.e124) - ((2 * 
                (((.e194 + .e281) * .e6 + 2 * (.e87/.e6)) * .e21) + 
                2 * (a * .e274/.e6) + 8 * (.e150 * (2 * (.e248/.e6) - 
                .e175 * .e6) * .e31 * .e6/.e126))/.e126 + .e147 * 
                (32 * ((.e5/(.e10 * .e6) + 4 * q) * .e5/.e10) - 
                  .e118/.e6)/.e219))) - 0.5 * (((.e194 + .e222 * 
            .e162/.e31 + .e281) * .e21 + (.e224 * .e31 - .e29 * 
            .e274)/.e27)/.e31)), q = (.e268 + a * (8 * (.e58 * 
            .e111/.e36) + .e2/.e96) - q * ((.e17/q + .e153)/.e7 + 
            8 * (.e105 * .e304 * .e111/.e36))) * .e15 + q * (.e179 * 
            .e170/.e6 + q * ((.e179 * (2 * (((((.e297 - .e3 * 
            .e113)/.e6 - .e24) * .e104 - q * (2 * (((.e186 - 
            (.e44 * .e93/.e13 + .e296)) * .e26 - .e314 * .e113/.e6)/.e13) + 
            .e2 * (2 * .e319 + 4 * .e306)/.e6) * .e26)/.e90 - 
            q * (.e93 * .e8 + .e2 * (2 - 2 * .e321) * .e13/.e6) * 
                .e26 * .e104 * .e8 * .e52/.e229) * .e115) - .e2 * 
            (.e282 + 64 * (a * .e304 * .e111/.e36))) - ((.e50/.e7 + 
            .e2 * .e10/.e5)/.e27 + .e180/.e77) * .e170)/.e27 - 
            ((((.e318/2 - .e315 * .e60) * .e40 - .e2 * tij * 
                .e57 * .e62)/.e6 + .e289 * .e57/.e31) * .e143 - 
                ((.e234 * .e243/.e76 + 32 * (.e2 * .e113/.e6) + 
                  a * (32 * (.e2 * .e306/.e6) + 64 * ((((2 * 
                    ((.e186 - .e296) * .e6 + .e314/.e6) + 4 * 
                    (.e213/.e6)) * .e26 - .e2 * .e112 * (.e113 + 
                    .e300)/.e6) * .e6 + .e273 * (.e38 - 2 * (.e234 * 
                    .e6/.e76)))/.e76))) * .e130 + 32 * (a * ((((.e29 + 
                  q * .e226)/.e80 + .e35 * (.e318/.e27 - .e2 * 
                  .e60/.e5)/.e6 - .e95 * (8 * (.e85 * .e6/.e10) - 
                  .e79 * .e50/.e7)/.e218) * .e40 + (.e86 * (.e289/.e31 - 
                  .e2 * .e62/.e5)/.e6 - (.e46 * (1 + q * (2 * 
                  (.e2 * .e15/.e6) - 2 * (.e180/.e31))) + q * 
                  (.e186 + 2 * (.e213 * .e15/.e6))) * .e21/.e77) * 
                  .e57 - (.e234 * .e121/.e76 + .e2 * .e320/.e6)) * 
                  .e26 - .e2 * .e121 * .e113/.e6)) + .e2 * .e195 * 
                  .e291/.e6)) * .e40 * .e14/.e177) - (.e174 * 
            (32 * (.e190 - 4 * (.e1 * .e2 * q * .e111/(.e284 * 
                .e6))) + 8 * (q * ((.e297 - .e3 * (.e291 * .e26 + 
                .e92 + .e68))/.e6 - .e24) * .e26 * .e115/.e90) - 
                .e167 * (.e93 - 2 * (.e315 * .e13/.e6)) * .e52/.e230) + 
            ((2 * (a * .e294/.e6) - (2 * ((.e253 * .e6 + .e246/.e6) * 
                .e21) + 8 * ((.e180 * .e6 + .e247/.e6) * .e150 * 
                .e31 * .e6/.e126)))/.e126 + 2 * ((.e226 * .e6 + 
                .e2 * .e29/.e6)/.e124) - .e147 * (32 * ((.e5 * 
                .e50/.e41 + 2 * .e2) * .e5/.e10) - .e118 * .e50/.e7)/.e219) * 
                .e205 + 2 * (.e195 * .e40 * .e14/.e177))) - (.e174 * 
            .e205 + 0.5 * ((.e253 * .e21 + (.e226 * .e31 + .e29 * 
            .e294)/.e27 - .e222 * .e180/.e31)/.e31)), f = q * 
            (16 * (.e312 * .e15/.e36) + q * (.e179 * (128 * (.e312/.e36) + 
                2 * (q * (.e26 * (4 * .e311 - 2 * (.e44 * .e152/.e13)) + 
                  .e152 * .e104) * .e115/.e90))/.e27 - (((.e130 * 
                (.e152 * .e131 + 32 * (a * .e311)) - 32 * (.e171 * 
                .e152)) * .e14 + .e172 - .e191) * .e40/.e177 + 
                .e174 * (64 * (.e19/.e36) + 8 * (.e116 * .e152 * 
                  .e115/.e90))))), f1 = q * (a * (.e94 * .e174 * 
            (16 * (.e116 * .e115/.e283) + 64 * (.e14/.e36)) - 
            16 * (.e265 * .e15/.e36)) + q * (a * .e179 * (2 * 
            (q * (.e26 * (4 * (.e244/.e13) - 4 * .e288) - 2 * 
                (a * .e104)) * .e115/.e283) - 128 * (.e265/.e36))/.e27 - 
            (a * (32 * (.e121 * .e26) + a * (64 * .e171 - .e130 * 
                (2 * .e131 + 32 * .e288)) * .e14/.e6) - .e172) * 
                .e40/.e177)))
}

deriv_mu_int_b_bqff1 <-
function (a, b, q, f, f1, mu0, theta, tij, r0, m0, t0) 
{
    .e1 <- a^2
    .e2 <- b^2
    .e3 <- .e2 * q
    .e5 <- 2 * .e3 + .e1
    .e6 <- sqrt(.e5)
    .e7 <- 2 * q
    .e8 <- a + .e6
    .e10 <- r0 - .e8/.e7
    .e11 <- 2 * (.e6/.e10)
    .e12 <- .e11 + .e7
    .e13 <- tij - t0
    .e14 <- f - f1
    .e15 <- .e1 * .e14
    .e16 <- 2 * .e6
    .e18 <- exp(2 * (.e6 * .e13))
    .e19 <- f - m0
    .e20 <- q/.e6
    .e22 <- 2 * (.e19 * .e6)
    .e24 <- 2 * (.e15/.e6) - .e22
    .e25 <- 4 * .e20
    .e27 <- 2/.e10 + .e25
    .e28 <- t0 * .e6
    .e30 <- .e7 - .e12 * .e18
    .e31 <- .e16^2
    .e32 <- .e27/.e10
    .e33 <- q * .e12
    .e34 <- q * .e10
    .e35 <- .e2/.e6
    .e37 <- exp(-.e28)
    .e38 <- 4 * (.e33 * .e13/.e6)
    .e40 <- exp(-(2 * .e28))
    .e41 <- q * t0
    .e42 <- .e32 + .e38
    .e44 <- 4 * (.e41 * .e12/.e6)
    .e45 <- .e35 - .e8/q
    .e46 <- .e32 - .e44
    .e48 <- exp(-(tij * .e6))
    .e49 <- .e24/.e8
    .e50 <- t0 * .e24
    .e51 <- 0.5 + .e34/.e16
    .e53 <- q/.e30 - 0.5
    .e54 <- 2 * .e49
    .e55 <- .e15/.e31
    .e56 <- .e42 * .e18
    .e57 <- .e12 * .e31
    .e62 <- 1/.e10
    .e63 <- .e54 + 4 * (0.5 * .e50 + 4 * .e55 + f - m0)
    .e64 <- 2 * .e34
    .e65 <- 2 * .e20
    .e67 <- (-.e11)^2
    .e68 <- .e30^2
    .e71 <- .e45 * .e6/.e64 + .e35
    .e72 <- .e62 + .e65
    .e74 <- 2 * (.e71/.e10)
    .e76 <- q * .e63/.e6
    .e77 <- .e67 * .e10
    .e78 <- .e16^3
    .e79 <- 2 * (.e15/.e5)
    .e80 <- 2 * .e19
    .e82 <- .e12 * .e8^2 * .e40
    .e83 <- .e14^2
    .e84 <- 2 + .e74
    .e85 <- .e2 * .e12
    .e86 <- t0 * .e51
    .e90 <- .e27/.e77 + 2 * (.e86/.e6)
    .e91 <- 2 * (.e72/.e10)
    .e92 <- .e79 + .e80
    .e94 <- 2 * (tij * .e53/.e6) - .e56/.e68
    .e97 <- 2 * (.e46 * .e6) + 8 * (.e33/.e6)
    .e98 <- .e37^2
    .e100 <- .e90 * .e37 + .e94 * .e48
    .e101 <- 1 - .e3/.e5
    .e103 <- (-(4 * (.e5/.e10)))^2
    .e107 <- 2 * (.e46 * .e24/.e12) + 4 * .e76
    .e108 <- .e78 * .e6
    .e109 <- q^2
    .e110 <- .e103 * .e10
    .e112 <- .e51 * .e37 + .e48 * .e53
    .e113 <- .e97 * .e24
    .e114 <- (2 * (.e30 * .e6))^2
    .e115 <- q * .e30
    .e117 <- 2 * (.e1/.e6) - .e16
    .e118 <- q * .e100
    .e119 <- .e115/.e6
    .e124 <- .e57 * .e40
    .e127 <- 2 - (.e84 + 2 * (.e85 * .e13/.e6)) * .e18
    .e129 <- .e91 + .e38
    .e131 <- 2 * (.e27 * .e6) + 8 * q
    .e133 <- 32 * .e76 + 64 * (.e113 * .e6/.e57)
    .e134 <- 4 * (.e101/.e6)
    .e136 <- 4 * .e119 - 2 * (.e56 * .e6)
    .e137 <- q * .e24
    .e138 <- 8 * (.e109/.e5)
    .e139 <- .e1 * .e83
    .e140 <- .e112 * .e133
    .e143 <- .e107 * .e24 * .e98/.e82
    .e145 <- .e131/.e110 + .e136/.e114
    .e146 <- (2 * (.e137 * .e37/.e8))^2
    .e147 <- .e12 * .e40
    .e148 <- .e8 * .e6
    .e150 <- .e10/.e16 + 1/.e30
    .e151 <- .e10^2
    .e152 <- .e91 - 2 * (.e33/.e5)
    .e153 <- 32 * (.e118 * .e24)
    .e154 <- .e139/.e108
    .e156 <- t0 * .e31/.e6
    .e157 <- ((.e27/2 + .e62) * .e45/.e34 + .e134)/.e10
    .e158 <- .e140 + .e153
    .e159 <- ((.e25 + 4/.e10)/.e10 - .e138)/.e10
    .e160 <- .e16^4
    .e161 <- (a * .e14/.e16)^2
    .e163 <- 2 * .e143 + 256 * .e154
    .e164 <- 2 * .e92
    .e166 <- .e1 * q * .e83
    .e167 <- .e129 * .e18
    .e169 <- .e146/.e147 + 32 * (q * .e161)
    .e171 <- .e57 * .e8 * .e40
    .e172 <- .e124 * .e6
    .e173 <- 1 + 32 * (.e166/.e78)
    .e176 <- .e11 + q * (.e74 + 4 - .e85/.e5)
    .e177 <- .e15/.e160
    .e178 <- .e2 * .e42
    .e180 <- t0 * .e92/.e6
    .e181 <- .e157 + (2 * .e178 + 4 * .e176) * .e13/.e6
    .e182 <- .e56 + .e30 * .e27/.e16
    .e186 <- .e31 * .e84 + .e85 * (8 - 2 * .e156)
    .e188 <- .e45/(q * .e151) + .e134
    .e190 <- 1/.e6 + 2 * (.e34/.e5)
    .e193 <- 2 * (.e72 * .e31/.e10) + q * (16 - 4 * .e156) * 
        .e12
    .e194 <- 2/.e151
    .e196 <- 4 * .e42 + 4 * .e152
    .e197 <- q * .e150
    .e198 <- q * .e127
    .e199 <- .e77^2
    .e200 <- .e110^2
    .e202 <- .e145 * .e169 + .e173 * .e13/.e6
    .e204 <- .e172^2
    .e205 <- .e124^2
    .e206 <- .e82^2
    .e207 <- .e147^2
    .e208 <- .e186 * .e6
    .e210 <- .e159 + q * .e196 * .e13
    .e214 <- .e101 * .e10 - .e45/2
    .e215 <- .e190/.e16
    .e216 <- .e193 * .e6
    .e217 <- .e167/.e68
    .e218 <- .e163/.e5
    .e220 <- .e63/.e5
    .e227 <- 1 - .e198/.e30
    .e229 <- 1/.e8 + t0
    .e230 <- 2 * ((.e49 + .e79 + .e80)/.e148)
    .e231 <- 2 * ((.e54 + .e164)/.e148)
    .e234 <- .e164 + 4 * .e50
    .e235 <- .e92 + 2 * .e50
    .e237 <- 2 * t0 + 2/.e8
    .e238 <- 4 * (0.5 * .e180 + 32 * .e177)
    .e241 <- 4 * (64 * .e177 + .e180)
    .e242 <- 4 * (t0 * (.e101 * .e12 + q * .e84)/.e6)
    .e243 <- .e138 - .e194
    .e247 <- a * .e158 * .e37 * .e14/.e171
    .e250 <- .e1 * .e31 * .e83/.e108^2
    .e251 <- .e2 * .e46
    .e252 <- .e2 * .e27
    .e253 <- .e2 * t0
    .e255 <- q * (2 * (.e117/.e8) + 4 * (0.5 * (t0 * .e117) + 
        1 + 4 * (.e1/.e31)))/.e6
    .e256 <- q * (4 * (4/.e31 + t0/.e6) + 4/.e148)
    .e258 <- t0 * .e90 * .e37
    .e259 <- t0 * .e8
    .e261 <- tij * .e94 * .e48
    c(b = .e2 * (q * (((.e91 - .e44) * .e146 * .e40/.e207 + .e109 * 
        (256 * (.e139/.e78) + 8 * (q * (.e24 * .e237 + .e164) * 
            .e24 * .e98/.e82))/.e6) * .e145 + q * (((2 * (.e173/.e5) + 
        384 * (.e166/(.e160 * .e6))) * .e13 - q * ((.e217 - .e215) * 
        .e163 + .e150 * (2 * ((((2 * ((((.e159 - 4 * (.e41 * 
        .e152))/.e6 - 2 * (.e46 * .e72/(.e12 * .e10))) * .e24 - 
        2 * (q * .e46 * .e92/.e6))/.e12) - 4 * (.e109 * (.e231 + 
        2 * .e220 + .e241)/.e6)) * .e24 - q * .e107 * .e234/.e6)/.e82 - 
        .e107 * (2 * (.e72 * .e8/.e10) + .e33 * (4 - 4 * .e259)/.e6) * 
            .e24 * .e8 * .e40/.e206) * .e98) - q * (2 * .e218 + 
        4096 * .e250)))/2)/.e6 + a * (.e112 * (64 * ((((2 * (.e159 + 
        q * (2 * (.e46/.e6) - 4 * (t0 * .e152))) + 8 * (q * .e152/.e6)) * 
        .e24 - q * .e97 * .e234/.e6) * .e6 + .e113 * (.e65 - 
        2 * (.e216/.e57))) * .e40/.e205) - 32 * (q * ((.e216 + 
        2 * (.e33 * .e31/.e6)) * .e63 * .e40/.e204 + q * (.e231 + 
        .e241)/.e172))) + q * ((.e129 * .e48 * .e18/.e68 - ((.e190/2 + 
        2 * .e86) * .e37 + 2 * (tij * .e48 * .e53))/.e6) * .e133 + 
        32 * (((2 * (q * tij * (.e217 - 2 * (.e53/.e5))/.e6) - 
            (.e210/.e6 + 2 * (.e42 * .e129 * .e18/.e30)) * .e18/.e68) * 
            .e48 - (.e100 * .e193/.e57 + ((.e243/.e77 + 2 * (.e41 * 
            (.e215 + 2 * (.e51/.e5))))/.e6 + .e27 * (8 * (.e72 * 
            .e6/.e10) - .e67/.e6)/.e199) * .e37 + q * (2 * .e258 + 
            2 * .e261)/.e6)) * .e24 - 2 * (.e118 * .e92/.e6)) - 
        .e158 * .e237/.e6)/.e124) * .e37 * .e14/.e8) - .e169 * 
        (2 * ((.e194 + q * (2 * (.e27/.e6) - 8 * (q/.e5)))/.e110) - 
            ((2 * ((.e159 + q * (.e196 * .e13 + 2 * (.e42/.e6))) * 
                .e18) + 4 * (q * (.e167 + 2 * (.e115/.e5))/.e6) + 
                8 * ((2 * .e119 - .e167 * .e6) * .e30 * .e136 * 
                  .e6/.e114))/.e114 + .e131 * (32 * ((.e5/(.e10 * 
                .e6) + 4 * q) * .e5/.e10) - .e103/.e6)/.e200))) - 
        0.5 * (((.e210 * .e18 - ((.e243/.e6 + 2 * (q * .e27/.e5)) * 
            .e30 + .e129 * .e27 * .e18)/2)/.e6 + .e182 * .e129 * 
            .e18/.e30)/.e30)) + q * (q * (.e247 - .e197 * .e163/.e16) - 
        .e202) - 0.5 * (.e182/.e30), q = b * (q * (2 * .e247 + 
        q * (a * (((((.e214/2 - .e253 * .e51) * .e37 - .e2 * 
            tij * .e48 * .e53)/.e6 + .e227 * .e48/.e30) * .e133 + 
            32 * ((.e100 + q * ((.e188/.e77 + 2 * (t0 * (.e214/.e16 - 
                .e2 * .e51/.e5)/.e6) - .e27 * (8 * (.e71 * .e6/.e10) - 
                .e67 * .e45/.e7)/.e199) * .e37 + (2 * (tij * 
                (.e227/.e30 - .e2 * .e53/.e5)/.e6) - (.e181 - 
                2 * (.e42 * .e127/.e30)) * .e18/.e68) * .e48 - 
                (.e100 * .e186/.e57 + .e2 * (.e258 + .e261)/.e6))) * 
                .e24 - .e3 * .e100 * .e92/.e6) - .e2 * .e158 * 
            .e229/.e6)/.e124 + .e112 * (32 * ((.e63 - .e3 * (.e230 + 
            .e238))/.e172 - q * (.e208 + .e85 * .e31/.e6) * .e63 * 
            .e40/.e204) + 64 * ((((2 * ((.e157 - .e242) * .e6 + 
            .e251/.e6) + 8 * (.e176/.e6)) * .e24 - .e2 * .e97 * 
            .e235/.e6) * .e6 + .e113 * (.e35 - 2 * (.e208/.e57))) * 
            .e40/.e205))) * .e37 * .e14/.e8 - ((.e150 - q * ((.e45/.e7 + 
            .e2 * .e10/.e5)/.e16 + .e127/.e68)) * .e163 + .e150 * 
            (4 * .e143 + 512 * .e154 + q * (2 * ((((2 * (((.e157 - 
                (.e46 * .e84/.e12 + .e242)) * .e24 - .e251 * 
                .e92/.e6)/.e12) + 4 * ((.e63 - .e3 * (.e220 + 
                .e230 + .e238))/.e6)) * .e24 - .e2 * .e107 * 
                .e235/.e6)/.e82 - (.e84 * .e8 + .e2 * (2 - 2 * 
                .e259) * .e12/.e6) * .e107 * .e24 * .e8 * .e40/.e206) * 
                .e98) - .e2 * (.e218 + 2048 * .e250))))/.e16) - 
        (((2 * (.e188 * .e6 + .e252/.e6) + 8)/.e110 + (4 * ((.e101 * 
            .e30 + .e198)/.e6) - (2 * ((.e181 * .e6 + .e178/.e6) * 
            .e18) + 8 * ((.e127 * .e6 + .e2 * .e30/.e6) * .e30 * 
            .e136 * .e6/.e114)))/.e114 - .e131 * (32 * ((.e5 * 
            .e45/.e64 + 2 * .e2) * .e5/.e10) - .e103 * .e45/.e7)/.e200) * 
            .e169 + .e145 * (32 * (.e161 - 4 * (.e1 * .e2 * q * 
            .e83/.e108)) + 8 * (q * ((2 * .e15 - .e3 * (.e229 * 
            .e24 + .e79 + .e80))/.e6 - .e22) * .e24 * .e98/.e82) - 
            .e146 * (.e84 - 2 * (.e253 * .e12/.e6)) * .e40/.e207) + 
            (32 * (.e1 * (1 - 6 * (.e3/.e6)) * .e83/.e78) - .e2 * 
                .e173/.e5) * .e13/.e6)) - (.e202 + 0.5 * ((.e181 * 
        .e18 + ((.e188 - .e252/.e5) * .e30 + .e127 * .e27)/.e16 - 
        .e182 * .e127/.e30)/.e30))), f = b * .e109 * (a * ((.e112 * 
        (32 * .e255 + 64 * (.e97 * .e117 * .e6/.e57)) + 32 * 
        (.e118 * .e117)) * .e14 + .e140 + .e153) * .e37/.e171 - 
        (.e145 * (64 * .e55 + 8 * (.e137 * .e117 * .e98/.e82)) + 
            (64 * (.e15 * .e13/.e78) + .e197 * (2 * ((.e107 * 
                .e117 + (2 * (.e46 * .e117/.e12) + 4 * .e255) * 
                .e24) * .e98/.e82) + 512 * (.e15/.e108))/2)/.e6)), 
        f1 = a * b * .e109 * (a * (.e145 * (16 * (.e137 * .e98/(.e82 * 
            .e6)) + 64 * (.e14/.e31)) + 64 * (.e14 * .e13/.e108) + 
            .e197 * (2 * ((.e24 * (4 * (.e46/.e12) + 4 * .e256) + 
                2 * .e107) * .e98/.e82) + 512 * (.e14/.e78))/(2 * 
                .e5)) - (.e158 + .e1 * (.e112 * (128 * (.e97/.e57) + 
            32 * (.e256/.e6)) + 64 * (.e118/.e6)) * .e14) * .e37/.e171))
}

deriv_mu_int_q_qff1b <-
function (a, b, q, f, f1, mu0, theta, tij, r0, m0, t0) 
{
    .e1 <- b^2
    .e2 <- a^2
    .e3 <- .e1 * q
    .e5 <- 2 * .e3 + .e2
    .e6 <- sqrt(.e5)
    .e7 <- 2 * q
    .e8 <- a + .e6
    .e10 <- r0 - .e8/.e7
    .e12 <- 2 * (.e6/.e10) + .e7
    .e13 <- tij - t0
    .e14 <- f - f1
    .e15 <- 2 * .e6
    .e16 <- .e1/.e6
    .e17 <- .e2 * .e14
    .e18 <- .e7^2
    .e19 <- 2 * (q * .e6)
    .e21 <- exp(2 * (.e6 * .e13))
    .e22 <- f - m0
    .e24 <- 2 * (.e8/.e18)
    .e26 <- .e1/.e19 - .e24
    .e28 <- 2 * (.e22 * .e6)
    .e30 <- 2 * (.e17/.e6) - .e28
    .e32 <- .e7 - .e12 * .e21
    .e35 <- 2 * (.e26 * .e6/.e10)
    .e36 <- 2 * .e16
    .e37 <- .e35 + .e36
    .e38 <- t0 * .e6
    .e39 <- .e15^2
    .e40 <- q * .e10
    .e43 <- .e37/.e10 + 2
    .e44 <- .e1 * .e12
    .e45 <- exp(-.e38)
    .e46 <- .e8/q
    .e47 <- .e1 * t0
    .e48 <- .e16 - .e46
    .e50 <- .e44 * .e13/.e6
    .e51 <- 2 * .e50
    .e53 <- exp(-(tij * .e6))
    .e55 <- q/.e32 - 0.5
    .e56 <- 0.5 + .e40/.e15
    .e58 <- exp(-(2 * .e38))
    .e59 <- 2 * (.e47 * .e12/.e6)
    .e60 <- q * .e30
    .e61 <- .e43 - .e59
    .e62 <- .e43 + .e51
    .e63 <- 2 * .e40
    .e64 <- 2 * (q/.e6)
    .e67 <- .e48 * .e6/.e63 + .e16
    .e69 <- 1/.e10 + .e64
    .e70 <- t0 * .e30
    .e71 <- .e17/.e39
    .e75 <- 0.5 * .e70 + 4 * .e71 + f - m0
    .e76 <- .e62 * .e21
    .e77 <- 2 - .e76
    .e78 <- .e12 * .e39
    .e81 <- 2 + 2 * (.e67/.e10)
    .e83 <- 2 * (.e1 * .e75/.e6) + 2 * (.e60 * .e26/.e8)
    .e84 <- 2 * (.e17/.e5)
    .e85 <- 2 * .e22
    .e87 <- .e56 * .e45 + .e53 * .e55
    .e88 <- .e15^3
    .e89 <- .e19^2
    .e90 <- .e3/.e5
    .e92 <- .e12 * .e8^2 * .e58
    .e93 <- .e14^2
    .e94 <- .e84 + .e85
    .e95 <- q * .e37
    .e96 <- .e47 * .e56
    .e97 <- .e1 * tij
    .e98 <- .e45^2
    .e99 <- q * .e77
    .e100 <- 1 - .e99/.e32
    .e101 <- 1 - .e95/.e15
    .e105 <- 2 - 2 * .e90
    .e107 <- 2 * (.e61 * .e6) + 4 * (.e44/.e6)
    .e108 <- .e96 - .e101 * .e10/2
    .e112 <- .e100/.e32 - .e97 * .e55/.e6
    .e114 <- .e88 * .e6
    .e116 <- 2 * (.e61 * .e30/.e12) + 4 * .e83
    .e117 <- 2 * (.e69/.e10)
    .e119 <- .e112 * .e53 - .e108 * .e45/.e6
    .e120 <- (a * .e14/.e15)^2
    .e121 <- q * .e12
    .e123 <- (-(4 * (.e5/.e10)))^2
    .e125 <- .e117 + 4 * (.e121 * .e13/.e6)
    .e126 <- 2 * ((.e16 - 2 * .e46)/.e18)
    .e128 <- 2 * (.e2/.e6) - .e15
    .e129 <- 4/.e18
    .e130 <- .e107 * .e30
    .e131 <- (.e81 + .e51) * .e21
    .e132 <- 1/q
    .e133 <- .e126 + 2 * (.e1 * (.e3/.e6 + .e6)/.e89)
    .e136 <- .e2 * .e93
    .e137 <- b^4
    .e138 <- q * (4 * (.e3/.e89) + .e129)
    .e139 <- .e123 * .e10
    .e140 <- (2 * (.e32 * .e6))^2
    .e141 <- (2 * (.e60 * .e45/.e8))^2
    .e142 <- .e12 * .e58
    .e143 <- .e32^2
    .e145 <- .e10/.e15 + 1/.e32
    .e146 <- 2 - .e131
    .e147 <- .e1 * .e32
    .e149 <- .e67 * .e26 - .e133 * .e6
    .e152 <- .e69 * .e26 + .e132 - .e138
    .e156 <- 2 * (.e105/.e6)
    .e158 <- 32 * .e83 + 64 * (.e130 * .e6/.e78)
    .e159 <- .e2 * .e1
    .e160 <- .e147/.e6
    .e162 <- t0 * .e39/.e6
    .e167 <- 2 * (.e77 * .e6) + 2 * .e160
    .e169 <- 2 * (.e37 * .e6) + 4 * .e1
    .e170 <- 2 * (.e137/(.e5 * .e6))
    .e171 <- .e136/.e88
    .e173 <- .e87 * .e158
    .e175 <- .e105 * .e12 + 2 * (.e1 * .e69/.e10)
    .e176 <- .e15^4
    .e177 <- 2 * .e94
    .e178 <- .e81 - .e44/.e5
    .e179 <- 32 * (.e119 * .e30)
    .e180 <- q * .e116
    .e181 <- ((.e37 * .e48/.e7 + 2 * .e149)/.e10 - .e170)/.e10
    .e184 <- (.e37/.e6 + 2 * .e152)/.e10 + .e156
    .e185 <- .e125 * .e21
    .e187 <- .e167/.e140 + .e169/.e139
    .e189 <- .e141/.e142 + 32 * (q * .e120)
    .e191 <- .e78 * .e8 * .e58
    .e193 <- 1/.e6 + 2 * (.e40/.e5)
    .e194 <- 128 * (.e159 * .e93/.e114)
    .e196 <- 32 * (.e87 * .e30)
    .e197 <- 32 * .e120
    .e198 <- q * (.e179 - .e173)
    .e199 <- .e184/.e10
    .e200 <- .e142^2
    .e201 <- .e75/.e5
    .e204 <- .e30/.e8
    .e206 <- .e39 * .e81 + .e44 * (8 - 2 * .e162)
    .e207 <- 1 - .e90
    .e208 <- 1/.e7
    .e212 <- 2 * (.e69 * .e39/.e10) + q * (16 - 4 * .e162) * 
        .e12
    .e213 <- 2 * .e17
    .e214 <- .e196 + .e198
    .e215 <- .e197 - q * (.e194 + 2 * (.e180 * .e30 * .e98/.e92))
    .e216 <- .e17/.e176
    .e218 <- t0 * .e94/.e6
    .e219 <- t0/.e6
    .e220 <- .e181 + .e1 * (2 * .e62 + 2 * .e178) * .e13/.e6
    .e221 <- .e199 + (2 * .e175 + 4 * (q * .e62)) * .e13/.e6
    .e225 <- .e207 * .e10 - .e48/2
    .e226 <- .e185/.e143
    .e227 <- .e48/.e7
    .e229 <- 1 - q * .e146/.e32
    .e230 <- .e208 - 16 * .e171
    .e232 <- 1/.e8 + t0
    .e233 <- 2 * (.e149/.e10)
    .e235 <- 2 * (.e152/.e10) + .e156
    .e237 <- 2 * t0 + 2/.e8
    .e238 <- 64 * (.e14/.e39)
    .e239 <- 64 * .e71
    .e240 <- q * .e145
    .e241 <- .e139^2
    .e243 <- ((.e225/2 - .e96) * .e45 - .e97 * .e53 * .e55)/.e6 + 
        .e229 * .e53/.e32
    .e244 <- .e220 * .e21
    .e248 <- .e92^2
    .e249 <- .e114^2
    .e251 <- (.e227 + .e1 * .e10/.e5)/.e15 + .e146/.e143
    .e254 <- .e230/.e5
    .e260 <- .e193/.e15
    .e264 <- (.e117 - 4 * (q * t0 * .e12/.e6)) * .e141 * .e58/.e200 + 
        q^2 * (256 * .e171 + 8 * (q * (.e30 * .e237 + .e177) * 
            .e30 * .e98/.e92))/.e6
    .e269 <- (2 * (2 * .e75 - .e3 * (2 * .e201 + 64 * .e216 + 
        .e218)) + 2 * (q * ((.e132 - .e138) * .e30 - q * (2 * 
        .e204 + .e177) * .e26)/.e8))/.e6
    .e271 <- (.e213 - .e3 * (.e232 * .e30 + .e84 + .e85))/.e6 - 
        .e28
    .e274 <- .e141 * (.e81 - .e59) * .e58/.e200
    .e277 <- .e215/.e5
    .e282 <- 1/.e5
    .e283 <- 16 * .e90
    .e285 <- 16 * (.e60 * .e98/(.e92 * .e6)) + .e238
    .e286 <- 2 - (.e76 + .e37 * .e32/.e15)
    .e287 <- 2 * ((((.e213 - .e3 * (.e204 + .e84 + .e85))/.e6 - 
        .e28) * .e26 - q * .e133 * .e30)/.e8)
    .e288 <- .e233 - .e170
    .e289 <- .e235 - 2 * (.e95/.e5)
    .e290 <- .e177 + 4 * .e70
    .e291 <- .e94 + 2 * .e70
    .e293 <- 2 * (.e1 * (0.5 * (t0 * .e128) + 1 + 4 * (.e2/.e39))/.e6) + 
        2 * (q * .e128 * .e26/.e8)
    .e295 <- 2 * (.e1 * (4/.e39 + .e219)) + 4 * (q * .e26/.e8)
    .e296 <- 2 * (.e47 * .e178/.e6)
    .e297 <- 2 * (.e137 * (.e201 + 0.5 * .e218 + 32 * .e216)/.e6)
    .e298 <- 2 * (t0 * .e175/.e6)
    .e299 <- 32 * (.e120 - 4 * (.e159 * q * .e93/.e114))
    .e300 <- 32 * .e171
    .e301 <- .e239 + 8 * (.e60 * .e128 * .e98/.e92)
    .e302 <- .e136/(.e176 * .e6)
    .e303 <- .e1 * .e61
    .e304 <- .e1/.e5
    .e305 <- q * (.e125 * .e53 * .e21/.e143 - ((.e193/2 + 2 * 
        (t0 * .e56)) * .e45 + 2 * (tij * .e53 * .e55))/.e6)
    .e306 <- q * .e187
    .e307 <- q * .e61
    .e308 <- q * .e32
    .e309 <- t0 * .e8
    c(q = (.e145 * (.e299 + .e197 + q * (.e30 * (8 * .e271 - 
        2 * .e180) * .e98/.e92 - .e194) - .e274) - (.e251 + .e1 * 
        .e145/.e5) * .e189)/.e15 + (.e227 + .e1 * (.e208 + .e304 - 
        .e300)/.e6 + q * (.e1 * (.e1 * (96 * .e302 - .e254) - 
        2/.e18)/.e6 - .e126) - .e24) * .e13 - (.e187 * .e189 + 
        0.5 * ((.e244 + (.e146 * .e37 + (.e233 - .e1 * (.e35 + 
            4 * .e16)/.e5) * .e32)/.e15 + .e286 * .e146/.e32)/.e32) + 
        a * .e214 * .e45 * .e14/.e191 + q * ((.e251 * .e215 + 
        .e145 * (.e1 * (.e277 + 256 * (.e136/.e114)) + q * ((2 * 
            (((.e116 + q * (2 * (((.e181 - (.e61 * .e81/.e12 + 
                .e296)) * .e30 - .e303 * .e94/.e6)/.e12) + 4 * 
                (.e287 - .e297))) * .e30 - .e3 * .e116 * .e291/.e6)/.e92 - 
                q * (.e81 * .e8 + .e1 * (2 - 2 * .e309) * .e12/.e6) * 
                  .e116 * .e30 * .e8 * .e58/.e248) + 2 * (.e116 * 
            .e30/.e92)) * .e98 - 1024 * (.e2 * .e137 * .e39 * 
            .e93/.e249))))/.e15 + .e187 * (.e299 + 8 * (q * .e271 * 
        .e30 * .e98/.e92) - .e274) + ((2 * (.e1 * .e77/.e6 - 
        .e244 * .e6) + 2 * (.e1 * (2 - (.e131 + .e147/.e5))/.e6) - 
        8 * ((.e146 * .e6 + .e160) * .e167 * .e32 * .e6/.e140))/.e140 + 
        2 * ((.e288 * .e6 + .e1 * .e37/.e6)/.e139) - .e169 * 
        (32 * ((.e5 * .e48/.e63 + 2 * .e1) * .e5/.e10) - .e123 * 
            .e48/.e7)/.e241) * .e189 + a * (32 * ((.e243 - .e87 * 
        .e206/.e78) * .e30 - .e1 * .e87 * .e94/.e6) + .e179 - 
        (.e173 + .e1 * .e232 * .e214/.e6 + q * (.e243 * .e158 + 
            .e87 * (32 * (.e287 - (.e206 * .e83/.e78 + .e297)) + 
                64 * ((((2 * ((.e181 - .e296) * .e6 + .e303/.e6) + 
                  4 * (.e1 * .e178/.e6)) * .e30 - .e1 * .e107 * 
                  .e291/.e6) * .e6 + .e130 * (.e16 - 2 * (.e206 * 
                  .e6/.e78)))/.e78)) + 32 * ((((.e100 * .e146 + 
            .e229 * .e77 - q * .e220 * .e21)/.e143 + .e97 * ((2 - 
            q * (4 - ((.e35 + 2 * .e67 + .e36)/.e10 + 4 + 4 * 
                .e50) * .e21)/.e32)/.e32 - .e1 * (.e282 + tij/.e6) * 
            .e55)/.e6) * .e53 + .e119 * .e206/.e78 + (0.5 * ((.e207 * 
            .e37 + q * .e288) * .e10/.e15 + .e101 * .e48/.e7) + 
            .e1 * (t0 * .e225/.e15 - (.e282 + .e219) * .e108)) * 
            .e45/.e6) * .e30 + .e1 * .e119 * .e94/.e6)))) * .e45 * 
        .e14/.e191)), f = .e2 * (8 - .e283) * .e14 * .e13/.e39 + 
        q * (((.e239 - q * (2 * (q * (.e116 * .e128 + (2 * (.e61 * 
            .e128/.e12) + 4 * .e293) * .e30) * .e98/.e92) + 256 * 
            (.e159 * .e14/.e114)))/2 + .e301/2) * .e145/.e6 - 
            (a * ((32 * (.e87 * .e128) + q * (32 * (.e119 * .e128) - 
                .e87 * (32 * .e293 + 64 * (.e107 * .e128 * .e6/.e78)))) * 
                .e14 + .e196 + .e198) * .e45/.e191 + .e306 * 
                .e301)), f1 = a * (a * ((.e283 - 8) * .e14 * 
        .e13/.e39 - .e240 * .e285/.e15) + q * (a * (.e145 * (q * 
        (2 * (q * (.e30 * (4 * (.e61/.e12) + 4 * .e295) + 2 * 
            .e116) * .e98/.e92) + 256 * (.e1 * .e14/.e88))/.e6 - 
        .e238)/.e15 + .e306 * .e285) - (.e17 * (q * (.e87 * (128 * 
        (.e107/.e78) + 32 * (.e295/.e6)) - 64 * (.e119/.e6)) - 
        64 * (.e87/.e6)) - .e214) * .e45/.e191)), b = b * ((((.e226 - 
        (.e260 + 2 * (.e240/.e5))) * .e189 - .e264 * .e145)/2 + 
        (q * (2 * .e230 + 2 * .e304 + q * (.e1 * (192 * .e302 - 
            2 * .e254) - .e129) - .e300) - 1) * .e13)/.e6 + q * 
        (((.e226 - .e260) * .e215 - .e240 * (2 * .e277 + 2 * 
            (q * (((2 * ((((.e184 - 2 * (.e61 * .e69/.e12))/.e10 - 
                .e298) * .e30 - 2 * (.e307 * .e94/.e6))/.e12) + 
                4 * .e269) * .e30 - .e180 * .e290/.e6)/.e92 - 
                .e116 * (2 * (.e69 * .e8/.e10) + .e121 * (4 - 
                  4 * .e309)/.e6) * .e30 * .e8 * .e58/.e248) * 
                .e98) + .e2 * (128 * (2/.e114 - 16 * (.e3 * .e39/.e249)) + 
            256/.e114) * .e93))/.e15 + .e264 * .e187 - (((2 * 
            (.e235 * .e6 + 2 * (.e95/.e6)) + 8)/.e139 + (2 * 
            ((2 * .e32 - .e1 * (.e185 + 2 * (.e308/.e5)))/.e6) + 
            2 * (2 * (.e99/.e6) - .e221 * .e21 * .e6) - 8 * (.e167 * 
            (2 * (.e308/.e6) - .e185 * .e6) * .e32 * .e6/.e140))/.e140 - 
            .e169 * (32 * ((.e5/(.e10 * .e6) + 4 * q) * .e5/.e10) - 
                .e123/.e6)/.e241) * .e189 + a * (32 * (.e30 * 
            (.e305 - .e87 * .e212/.e78) - 2 * (q * .e87 * .e94/.e6)) - 
            q * (.e87 * (32 * (.e269 - .e212 * .e83/.e78) + 64 * 
                ((((2 * ((.e199 - .e298) * .e6 + 2 * (.e307/.e6)) + 
                  4 * (.e175/.e6)) * .e30 - q * .e107 * .e290/.e6) * 
                  .e6 + .e130 * (.e64 - 2 * (.e212 * .e6/.e78)))/.e78)) + 
                .e237 * .e214/.e6 + 32 * ((.e119 * .e212/.e78 + 
                (0.5 * ((1 + q * (.e289 * .e10/2 - .e37/.e15))/.e6) + 
                  t0 * (2 * .e56 - .e3 * .e193/.e15) - q * (2 * 
                  .e219 + 2/.e5) * .e108) * .e45/.e6 + .e53 * 
                (.e21 * (q * (.e77 * .e125/.e32 - .e221) - .e100 * 
                  .e125)/.e143 + tij * (2 * .e55 + q * (2 * .e112 + 
                  .e1 * (.e226 - 2 * (.e55/.e5))))/.e6)) * .e30 + 
                2 * (q * .e119 * .e94/.e6)) + .e305 * .e158)) * 
            .e45 * .e14/.e191)) - 0.5 * (((.e221 - .e286 * .e125/.e32) * 
        .e21 + (.e289 * .e32 - .e125 * .e37 * .e21)/.e15)/.e32)))
}

deriv_mu_int_f_ff1 <-
function (a, b, q, f, f1, mu0, theta, tij, r0, m0, t0) 
{
    .e1 <- a^2
    .e4 <- sqrt(2 * (b^2 * q) + .e1)
    .e5 <- 2 * q
    .e6 <- 2 * .e4
    .e7 <- a + .e4
    .e9 <- r0 - .e7/.e5
    .e10 <- t0 * .e4
    .e12 <- 2 * (.e4/.e9) + .e5
    .e14 <- .e6^2
    .e15 <- exp(-.e10)
    .e16 <- tij - t0
    .e17 <- .e1/.e4
    .e21 <- 2 * .e17 - .e6
    .e22 <- .e5 - .e12 * exp(2 * (.e4 * .e16))
    .e23 <- exp(-(2 * .e10))
    .e26 <- (0.5 + q * .e9/.e6) * .e15 + exp(-(tij * .e4)) * 
        (q/.e22 - 0.5)
    .e29 <- .e12 * .e14 * .e7 * .e23
    .e31 <- .e12 * .e7^2 * .e23
    .e33 <- .e9/.e6 + 1/.e22
    .e34 <- .e15^2
    c(f = q * (8 * (.e1 * .e16/.e14) + q * (.e33 * (64 * (.e1/.e14) + 
        8 * (q * .e21^2 * .e34/.e31))/.e6 - 64 * (a * .e26 * 
        .e21 * .e15/.e29))), f1 = a * q * (q * (.e26 * (32 * 
        .e21 + 64 * .e17) * .e15/.e29 - a * .e33 * (16 * (q * 
        .e21 * .e34/(.e31 * .e4)) + 64/.e14)/.e6) - 8 * (a * 
        .e16/.e14)))
}

deriv_mu_int_f1_f1 <-
function (a, b, q, f, f1, mu0, theta, tij, r0, m0, t0) 
{
    .e1 <- a^2
    .e3 <- 2 * (b^2 * q) + .e1
    .e4 <- sqrt(.e3)
    .e5 <- 2 * q
    .e6 <- a + .e4
    .e8 <- r0 - .e6/.e5
    .e9 <- 2 * .e4
    .e10 <- t0 * .e4
    .e12 <- 2 * (.e4/.e8) + .e5
    .e14 <- .e9^2
    .e15 <- exp(-.e10)
    .e16 <- tij - t0
    .e19 <- .e5 - .e12 * exp(2 * (.e4 * .e16))
    .e20 <- .e1 * q
    .e21 <- exp(-(2 * .e10))
    .e20 * (8 * (.e16/.e14) + q * ((.e8/.e9 + 1/.e19) * (32 * 
        (.e20 * .e15^2/(.e3 * .e12 * .e6^2 * .e21)) + 64/.e14)/2 - 
        128 * (a * ((0.5 + q * .e8/.e9) * .e15 + exp(-(tij * 
            .e4)) * (q/.e19 - 0.5)) * .e15/(.e12 * .e14 * .e6 * 
            .e21)))/.e4)
}

deriv_mu_int_m_t <-
function (a, b, q, f, f1, mu0, theta, tij, r0, m0, t0) 
{
    .e1 <- exp(t0 * theta)
    .e2 <- exp(theta * tij)
    (tij * .e2 - ((.e2 - .e1)/theta + t0 * .e1))/theta
}

deriv_mu_int_t_t <-
function (a, b, q, f, f1, mu0, theta, tij, r0, m0, t0) 
{
    .e1 <- exp(t0 * theta)
    .e2 <- exp(theta * tij)
    mu0 * (tij^2 * .e2 - ((2 * (tij * .e2) - (2 * ((.e2 - .e1)/theta) + 
        2 * (t0 * .e1)))/theta + t0^2 * .e1))/theta
}

hes_loglik <- function(param,m0,r0,tau,yij,delta,tij, n_j,t0)
{
	
	deriv_a_a <- deriv_a_b <- deriv_a_q <- deriv_a_f <- deriv_a_f1 <- deriv_a_mu0 <- deriv_a_theta <- 0
	deriv_b_b <- deriv_b_q <- deriv_b_f <- deriv_b_f1 <- deriv_b_mu0 <- deriv_b_theta <- 0
	deriv_q_q <- deriv_q_f <- deriv_q_f1 <- deriv_q_mu0 <- deriv_q_theta <- 0
	deriv_f_f <- deriv_f_f1 <- deriv_f_mu0 <- deriv_f_theta <- 0
	deriv_f1_f1 <- deriv_f1_mu0 <- deriv_f1_theta <- 0
	deriv_mu0_mu0 <- deriv_mu0_theta <- 0
	deriv_theta_theta <- 0
	
	a <- param[1]
	b <- param[2]
	q <- param[3]
	f <- param[4]
	f1 <- param[5]
	mu0 <- param[6]
	theta <- param[7]
	
	num_j <- length(yij)
	index <- 1:length(yij)
	
		re_1_a <- d_f_j1_a_abq(a, b, q, r0[index], tij[index], t0[index])
		re_1_b <- d_f_j1_b_bq(a, b, q, r0[index], tij[index], t0[index])
		re_1_q <- d_f_j1_q_qb(a, b, q, r0[index], tij[index], t0[index])
		re_2_a <- d_f_j2_a_abqff1(a,b,q,f,f1,m0[index],r0[index],tij[index],yij[index], t0[index])
		re_2_b <- d_f_j2_b_bqff1(a,b,q,f,f1,m0[index],r0[index],tij[index],yij[index], t0[index])
		re_2_q <- d_f_j2_q_qff1b(a,b,q,f,f1,m0[index],r0[index],tij[index],yij[index], t0[index])
		re_2_f <- d_f_j2_f_ff1(a,b,q,f,f1,m0[index],r0[index],tij[index],yij[index], t0[index])
		re_2_f1 <- d_f_j2_f1_f1(a,b,q,f,f1,m0[index],r0[index],tij[index],yij[index], t0[index])
		re_4_a <- deriv_mu_int_a_abqff1(a, b, q, f, f1, mu0, theta, tij[index],r0[index],m0[index],t0[index])
		re_4_b <- deriv_mu_int_b_bqff1(a, b, q, f, f1, mu0, theta, tij[index],r0[index],m0[index],t0[index])
		re_4_q <- deriv_mu_int_q_qff1b(a, b, q, f, f1, mu0, theta, tij[index],r0[index],m0[index],t0[index])
		re_4_f <- deriv_mu_int_f_ff1(a, b, q, f, f1, mu0, theta, tij[index],r0[index],m0[index],t0[index])
		re_4_f1 <- deriv_mu_int_f1_f1(a, b, q, f, f1, mu0, theta, tij[index],r0[index],m0[index],t0[index])
		re_4_mu0 <- deriv_mu_int_m_t(a, b, q, f, f1, mu0, theta, tij[index],r0[index],m0[index],t0[index])
		re_4_theta <- deriv_mu_int_t_t(a, b, q, f, f1, mu0, theta, tij[index],r0[index],m0[index],t0[index])
	
		deriv_a_a <- deriv_a_a + sum(re_1_a[1:num_j]) + sum(re_2_a[1:num_j]) - sum(re_4_a[1:num_j])
		deriv_a_b <- deriv_a_b + sum(re_1_a[(num_j+1):(2*num_j)]) + sum(re_2_a[(num_j+1):(2*num_j)]) - sum(re_4_a[(num_j+1):(2*num_j)])
		deriv_a_q <- deriv_a_q + sum(re_1_a[(2*num_j+1):(3*num_j)]) + sum(re_2_a[(2*num_j+1):(3*num_j)]) - sum(re_4_a[(2*num_j+1):(3*num_j)])
		deriv_a_f <- deriv_a_f + sum(re_2_a[(3*num_j+1):(4*num_j)]) - sum(re_4_a[(3*num_j+1):(4*num_j)])
		deriv_a_f1 <- deriv_a_f1 + sum(re_2_a[(4*num_j+1):(5*num_j)]) - sum(re_4_a[(4*num_j+1):(5*num_j)])
		#deriv_a_mu0 <- deriv_a_mu0 - sum(re_4_a[(5*num_j+1):(6*num_j)])
		#deriv_a_theta <- deriv_a_theta - sum(re_4_a[(6*num_j+1):(7*num_j)])
		
		deriv_b_b <- deriv_b_b + sum(re_1_b[1:num_j]) + sum(re_2_b[1:num_j]) - sum(re_4_b[1:num_j])
		deriv_b_q <- deriv_b_q + sum(re_1_q[(num_j+1):(2*num_j)]) + sum(re_2_q[(3*num_j+1):(4*num_j)]) - sum(re_4_q[(3*num_j+1):(4*num_j)])
		# deriv_b_q <- deriv_b_q + sum(re_1_b[(num_j+1):(2*num_j)]) + sum(re_2_b[(num_j+1):(2*num_j)]) - sum(re_4_b[(num_j+1):(2*num_j)])
		deriv_b_f <- deriv_b_f + sum(re_2_b[(2*num_j+1):(3*num_j)]) - sum(re_4_b[(2*num_j+1):(3*num_j)])
		deriv_b_f1 <- deriv_b_f1 + sum(re_2_b[(3*num_j+1):(4*num_j)]) - sum(re_4_b[(3*num_j+1):(4*num_j)])
		#deriv_b_mu0 <- deriv_b_mu0 - sum(re_4_b[(4*num_j+1):(5*num_j)])
		#deriv_b_theta <- deriv_b_theta - sum(re_4_b[(5*num_j+1):(6*num_j)])
		
		deriv_q_q <- deriv_q_q + sum(re_1_q[1:num_j]) + sum(re_2_q[1:num_j]) - sum(re_4_q[1:num_j])
		deriv_q_f <- deriv_q_f + sum(re_2_q[(num_j+1):(2*num_j)]) - sum(re_4_q[(num_j+1):(2*num_j)])
		deriv_q_f1 <- deriv_q_f1 + sum(re_2_q[(2*num_j+1):(3*num_j)]) - sum(re_4_q[(2*num_j+1):(3*num_j)])
		#deriv_q_mu0 <- deriv_q_mu0 - sum(re_4_q[(3*num_j+1):(4*num_j)])
		#deriv_q_theta <- deriv_q_theta - sum(re_4_q[(4*num_j+1):(5*num_j)])
		
		deriv_f_f <- deriv_f_f + sum(re_2_f[1:num_j]) - sum(re_4_f[1:num_j])
		deriv_f_f1 <- deriv_f_f1 + sum(re_2_f[(num_j+1):(2*num_j)]) - sum(re_4_f[(num_j+1):(2*num_j)])
		#deriv_f_mu0 <- deriv_f_mu0 - sum(re_4_f[(2*num_j+1):(3*num_j)])
		#deriv_f_theta <- deriv_f_theta - sum(re_4_f[(3*num_j+1):(4*num_j)])
		
		deriv_f1_f1 <- deriv_f1_f1 + sum(re_2_f1[1:num_j]) - sum(re_4_f1[1:num_j])
		#deriv_f1_mu0 <- deriv_f1_mu0 - sum(re_4_f1[(num_j+1):(2*num_j)])
		#deriv_f1_theta <- deriv_f1_theta - sum(re_4_f1[(2*num_j+1):(3*num_j)])
		
		#deriv_mu0_mu0 <- deriv_mu0_mu0 - sum(re_4_mu0[1:num_j])
		deriv_mu0_theta <- deriv_mu0_theta - sum(re_4_mu0[1:num_j])
		
		deriv_theta_theta <- deriv_theta_theta - sum(re_4_theta[1:num_j])
		
	num_i <- length(tau)
	for(i in 1:num_i)
	{
		if(i==1)
		{
			num_j <- n_j[1]
			index <- 1:num_j
		}else{
			num_j <- n_j[i]
			index <- (sum(n_j[1:(i-1)])+1):sum(n_j[1:i])
		}
			
		# temp2 <- df3(a,b,q,f,f1,mu0,m0,r0,tau[i],delta[i]) - (df4(a,b,q,f,f1,mu0,tau[i]) + df5(a,b,q,f,f1,r0,tau[i]) + df6(a,b,q,f,f1,m0,r0,tau[i]) + df7(a,b,q,f,f1,m0,r0) + df8(a,b,q,f,f1,m0,r0,tau[i]))
		if(delta[i]>0)
		{
			sum_n_j <- sum(n_j[1:i])
			re_3_a <- d_f_i1_a_abqff1mt(a,b,q,f,f1,mu0,theta,m0[sum_n_j],r0[sum_n_j],tau[i], t0[sum_n_j])
			re_3_b <- d_f_i1_b_bqff1mt(a,b,q,f,f1,mu0,theta,m0[sum_n_j],r0[sum_n_j],tau[i], t0[sum_n_j])
			re_3_q <- d_f_i1_q_qff1mtb(a,b,q,f,f1,mu0,theta,m0[sum_n_j],r0[sum_n_j],tau[i], t0[sum_n_j])
			re_3_f <- d_f_i1_f_ff1mt(a,b,q,f,f1,mu0,theta,m0[sum_n_j],r0[sum_n_j],tau[i], t0[sum_n_j])
			re_3_f1 <- d_f_i1_f1_f1mt(a,b,q,f,f1,mu0,theta,m0[sum_n_j],r0[sum_n_j],tau[i], t0[sum_n_j])
			re_3_mu0 <- d_f_i1_m_mt(a,b,q,f,f1,mu0,theta,m0[sum_n_j],r0[sum_n_j],tau[i], t0[sum_n_j])
			re_3_theta <- d_f_i1_t_t(a,b,q,f,f1,mu0,theta,m0[sum_n_j],r0[sum_n_j],tau[i], t0[sum_n_j])
			
			deriv_a_a <- deriv_a_a + re_3_a[1]
			deriv_a_b <- deriv_a_b + re_3_a[2]
			deriv_a_q <- deriv_a_q + re_3_a[3]
			deriv_a_f <- deriv_a_f + re_3_a[4]
			deriv_a_f1 <- deriv_a_f1 + re_3_a[5]
			deriv_a_mu0 <- deriv_a_mu0 + re_3_a[6]
			deriv_a_theta <- deriv_a_theta + re_3_a[7]
			
			deriv_b_b <- deriv_b_b + re_3_b[1]
			deriv_b_q <- deriv_b_q + re_3_q[6]
			# deriv_b_q <- deriv_b_q + re_3_b[2]
			deriv_b_f <- deriv_b_f + re_3_b[3]
			deriv_b_f1 <- deriv_b_f1 + re_3_b[4]
			deriv_b_mu0 <- deriv_b_mu0 + re_3_b[5]
			deriv_b_theta <- deriv_b_theta + re_3_b[6]
			
			deriv_q_q <- deriv_q_q + re_3_q[1]
			deriv_q_f <- deriv_q_f + re_3_q[2]
			deriv_q_f1 <- deriv_q_f1 + re_3_q[3]
			deriv_q_mu0 <- deriv_q_mu0 + re_3_q[4]
			deriv_q_theta <- deriv_q_theta + re_3_q[5]
			
			deriv_f_f <- deriv_f_f + re_3_f[1]
			deriv_f_f1 <- deriv_f_f1 + re_3_f[2]
			deriv_f_mu0 <- deriv_f_mu0 + re_3_f[3]
			deriv_f_theta <- deriv_f_theta + re_3_f[4]
			
			deriv_f1_f1 <- deriv_f1_f1 + re_3_f1[1]
			deriv_f1_mu0 <- deriv_f1_mu0 + re_3_f1[2]
			deriv_f1_theta <- deriv_f1_theta + re_3_f1[3]
			
			deriv_mu0_mu0 <- deriv_mu0_mu0 + re_3_mu0[1]
			deriv_mu0_theta <- deriv_mu0_theta + re_3_mu0[2]
			
			deriv_theta_theta <- deriv_theta_theta + re_3_theta[1]
			
		}else{ re_3 <- rep(0,7)}
		
		
		# print(deriv_q)
	}
	
	hes <- matrix(0, 7, 7)
	hes[1,] <- c(deriv_a_a, deriv_a_b, deriv_a_q, deriv_a_f, deriv_a_f1, deriv_a_mu0, deriv_a_theta)
	hes[2,2:7] <- c(deriv_b_b, deriv_b_q, deriv_b_f, deriv_b_f1, deriv_b_mu0, deriv_b_theta)
	hes[3,3:7] <- c(deriv_q_q, deriv_q_f, deriv_q_f1, deriv_q_mu0, deriv_q_theta)
	hes[4,4:7] <- c(deriv_f_f, deriv_f_f1, deriv_f_mu0, deriv_f_theta)
	hes[5,5:7] <- c(deriv_f1_f1, deriv_f1_mu0, deriv_f1_theta)
	hes[6,6:7] <- c(deriv_mu0_mu0, deriv_mu0_theta)
	hes[7,7] <- c(deriv_theta_theta)
	dia <- diag(hes)
	hes <- hes + t(hes)
	diag(hes) <- dia
	(-1)*hes
}
