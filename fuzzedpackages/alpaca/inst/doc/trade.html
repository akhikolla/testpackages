<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />



<title>Estimating the intensive and extensive margin of trade</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>
<style type="text/css">
a.anchor-section {margin-left: 10px; visibility: hidden; color: inherit;}
a.anchor-section::before {content: '#';}
.hasAnchor:hover a.anchor-section {visibility: visible;}
</style>
<script>// Anchor sections v1.0 written by Atsushi Yasumoto on Oct 3rd, 2020.
document.addEventListener('DOMContentLoaded', function() {
  // Do nothing if AnchorJS is used
  if (typeof window.anchors === 'object' && anchors.hasOwnProperty('hasAnchorJSLink')) {
    return;
  }

  const h = document.querySelectorAll('h1, h2, h3, h4, h5, h6');

  // Do nothing if sections are already anchored
  if (Array.from(h).some(x => x.classList.contains('hasAnchor'))) {
    return null;
  }

  // Use section id when pandoc runs with --section-divs
  const section_id = function(x) {
    return ((x.classList.contains('section') || (x.tagName === 'SECTION'))
            ? x.id : '');
  };

  // Add anchors
  h.forEach(function(x) {
    const id = x.id || section_id(x.parentElement);
    if (id === '') {
      return null;
    }
    let anchor = document.createElement('a');
    anchor.href = '#' + id;
    anchor.classList = ['anchor-section'];
    x.classList.add('hasAnchor');
    x.appendChild(anchor);
  });
});
</script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Estimating the intensive and extensive margin of trade</h1>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>In econometrics, fixed effects models are popular to control for unobserved heterogeneity in data sets with a panel structure. In non-linear models this is usually done by including a dummy variable for each level of a fixed effects category. This approach can quickly become infeasible if the number of levels and/or fixed effects categories increases (either due to memory or time limitations).</p>
<p>Two examples of this limitation can be found in the literature on international trade. Firstly, when it comes to estimating the determinants of trade volumes (intensive margin) or secondly, when it comes to the export decisions (extensive margin). In order to demonstrate the functionality and capablilities of <code>alpaca</code>, we replicate parts of <span class="citation">Larch et al. (2019)</span> as an example for the intensive margin and extend it to the extensive margin. Our example is based on the panel data set of 2,973,168 bilateral trade flows used by <span class="citation">Glick and Rose (2016)</span>. For our estimations we specify a three-way error component with 56,608 levels.</p>
</div>
<div id="data-preparation" class="section level2">
<h2>Data preparation</h2>
<p>The data set is available either from <a href="http://faculty.haas.berkeley.edu/arose/RecRes.htm">Andrew Rose’s website</a> or from <a href="https://www.sciencedirect.com/science/article/pii/S0014292116300630#ec0005">sciencedirect</a>. We use the same variable names as <span class="citation">Glick and Rose (2016)</span> such that we are able to compare our summary statistics with the ones provided in their <em>Stata</em> log-files.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Import the data set</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">library</span>(haven)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw">library</span>(data.table)</span>
<span id="cb1-4"><a href="#cb1-4"></a>cudata &lt;-<span class="st"> </span><span class="kw">read_dta</span>(<span class="st">&quot;dataaxj1.dta&quot;</span>)</span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="kw">setDT</span>(cudata)</span>
<span id="cb1-6"><a href="#cb1-6"></a></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co"># Subsetting relevant variables</span></span>
<span id="cb1-8"><a href="#cb1-8"></a>var.nms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;exp1to2&quot;</span>, <span class="st">&quot;custrict11&quot;</span>, <span class="st">&quot;ldist&quot;</span>, <span class="st">&quot;comlang&quot;</span>, <span class="st">&quot;border&quot;</span>, <span class="st">&quot;regional&quot;</span>,</span>
<span id="cb1-9"><a href="#cb1-9"></a>             <span class="st">&quot;comcol&quot;</span>, <span class="st">&quot;curcol&quot;</span>, <span class="st">&quot;colony&quot;</span>, <span class="st">&quot;comctry&quot;</span>, <span class="st">&quot;cuwoemu&quot;</span>, <span class="st">&quot;emu&quot;</span>, <span class="st">&quot;cuc&quot;</span>,</span>
<span id="cb1-10"><a href="#cb1-10"></a>             <span class="st">&quot;cty1&quot;</span>, <span class="st">&quot;cty2&quot;</span>, <span class="st">&quot;year&quot;</span>, <span class="st">&quot;pairid&quot;</span>)</span>
<span id="cb1-11"><a href="#cb1-11"></a>cudata &lt;-<span class="st"> </span>cudata[, var.nms, with =<span class="st"> </span><span class="ot">FALSE</span>]</span>
<span id="cb1-12"><a href="#cb1-12"></a></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co"># Generate identifiers required for structural gravity</span></span>
<span id="cb1-14"><a href="#cb1-14"></a>cudata[, pairid <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">factor</span>(pairid)]</span>
<span id="cb1-15"><a href="#cb1-15"></a>cudata[, exp.time <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">interaction</span>(cty1, year)]</span>
<span id="cb1-16"><a href="#cb1-16"></a>cudata[, imp.time <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">interaction</span>(cty2, year)]</span>
<span id="cb1-17"><a href="#cb1-17"></a></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co"># Generate dummies for disaggregated currency unions</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>cudata[, cuau <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;au&quot;</span>)]</span>
<span id="cb1-20"><a href="#cb1-20"></a>cudata[, cube <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;be&quot;</span>)]</span>
<span id="cb1-21"><a href="#cb1-21"></a>cudata[, cuca <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;ca&quot;</span>)]</span>
<span id="cb1-22"><a href="#cb1-22"></a>cudata[, cucf <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;cf&quot;</span>)]</span>
<span id="cb1-23"><a href="#cb1-23"></a>cudata[, cucp <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;cp&quot;</span>)]</span>
<span id="cb1-24"><a href="#cb1-24"></a>cudata[, cudk <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;dk&quot;</span>)]</span>
<span id="cb1-25"><a href="#cb1-25"></a>cudata[, cuea <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;ea&quot;</span>)]</span>
<span id="cb1-26"><a href="#cb1-26"></a>cudata[, cuec <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;ec&quot;</span>)]</span>
<span id="cb1-27"><a href="#cb1-27"></a>cudata[, cuem <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;em&quot;</span>)]</span>
<span id="cb1-28"><a href="#cb1-28"></a>cudata[, cufr <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;fr&quot;</span>)]</span>
<span id="cb1-29"><a href="#cb1-29"></a>cudata[, cugb <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;gb&quot;</span>)]</span>
<span id="cb1-30"><a href="#cb1-30"></a>cudata[, cuin <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;in&quot;</span>)]</span>
<span id="cb1-31"><a href="#cb1-31"></a>cudata[, cuma <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;ma&quot;</span>)]</span>
<span id="cb1-32"><a href="#cb1-32"></a>cudata[, cuml <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;ml&quot;</span>)]</span>
<span id="cb1-33"><a href="#cb1-33"></a>cudata[, cunc <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;nc&quot;</span>)]</span>
<span id="cb1-34"><a href="#cb1-34"></a>cudata[, cunz <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;nz&quot;</span>)]</span>
<span id="cb1-35"><a href="#cb1-35"></a>cudata[, cupk <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;pk&quot;</span>)]</span>
<span id="cb1-36"><a href="#cb1-36"></a>cudata[, cupt <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;pt&quot;</span>)]</span>
<span id="cb1-37"><a href="#cb1-37"></a>cudata[, cusa <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;sa&quot;</span>)]</span>
<span id="cb1-38"><a href="#cb1-38"></a>cudata[, cusp <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;sp&quot;</span>)]</span>
<span id="cb1-39"><a href="#cb1-39"></a>cudata[, cuua <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;ua&quot;</span>)]</span>
<span id="cb1-40"><a href="#cb1-40"></a>cudata[, cuus <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;us&quot;</span>)]</span>
<span id="cb1-41"><a href="#cb1-41"></a>cudata[, cuwa <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(cuc <span class="op">==</span><span class="st"> &quot;wa&quot;</span>)]</span>
<span id="cb1-42"><a href="#cb1-42"></a>cudata[, cuwoo <span class="op">:</span><span class="er">=</span><span class="st"> </span>custrict11]</span>
<span id="cb1-43"><a href="#cb1-43"></a>cudata[cuc <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;em&quot;</span>, <span class="st">&quot;au&quot;</span>, <span class="st">&quot;cf&quot;</span>, <span class="st">&quot;ec&quot;</span>, <span class="st">&quot;fr&quot;</span>, <span class="st">&quot;gb&quot;</span>, <span class="st">&quot;in&quot;</span>, <span class="st">&quot;us&quot;</span>), cuwoo <span class="op">:</span><span class="er">=</span><span class="st"> </span>0L]</span>
<span id="cb1-44"><a href="#cb1-44"></a></span>
<span id="cb1-45"><a href="#cb1-45"></a><span class="co"># Set missing trade flows to zero</span></span>
<span id="cb1-46"><a href="#cb1-46"></a>cudata[<span class="kw">is.na</span>(exp1to2), exp1to2 <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="fl">0.0</span>]</span>
<span id="cb1-47"><a href="#cb1-47"></a></span>
<span id="cb1-48"><a href="#cb1-48"></a><span class="co"># Construct binary and lagged dependent variable for the extensive margin</span></span>
<span id="cb1-49"><a href="#cb1-49"></a>cudata[, trade <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">as.numeric</span>(exp1to2 <span class="op">&gt;</span><span class="st"> </span><span class="fl">0.0</span>)]</span>
<span id="cb1-50"><a href="#cb1-50"></a>cudata[, ltrade <span class="op">:</span><span class="er">=</span><span class="st"> </span><span class="kw">shift</span>(trade), by =<span class="st"> </span>pairid]</span></code></pre></div>
</div>
<div id="estimating-the-intensive-margin-of-trade" class="section level2">
<h2>Estimating the intensive margin of trade</h2>
<p>After preparing the data, we show how to replicate column 3 of table 2 in <span class="citation">Larch et al. (2019)</span>. In addition to coefficients and robust standard errors, the authors also report standard errors clustered by exporter, importer, and time.</p>
<p>If we want <code>feglm()</code> to report standard errors that are clustered by variables, which are not already part of the model itself, we have to additionally provide them using the third part of the <code>formula</code> interface. In this example, we have to additionally add identifiers for exporters (<code>cty1</code>), importers (<code>cty2</code>), and time (<code>year</code>).</p>
<p>First we report robust standard errors indicated by the option <code>&quot;sandwich&quot;</code> in <code>summary()</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>mod &lt;-<span class="st"> </span><span class="kw">feglm</span>(exp1to2 <span class="op">~</span><span class="st"> </span>emu <span class="op">+</span><span class="st"> </span>cuwoo <span class="op">+</span><span class="st"> </span>cuau <span class="op">+</span><span class="st"> </span>cucf <span class="op">+</span><span class="st"> </span>cuec <span class="op">+</span><span class="st"> </span>cufr <span class="op">+</span><span class="st"> </span>cugb <span class="op">+</span><span class="st"> </span>cuin <span class="op">+</span><span class="st"> </span>cuus <span class="op">+</span></span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="st">               </span>regional <span class="op">+</span><span class="st"> </span>curcol <span class="op">|</span><span class="st"> </span>exp.time <span class="op">+</span><span class="st"> </span>imp.time <span class="op">+</span><span class="st"> </span>pairid <span class="op">|</span><span class="st"> </span>cty1 <span class="op">+</span><span class="st"> </span>cty2 <span class="op">+</span><span class="st"> </span>year, cudata,</span>
<span id="cb2-3"><a href="#cb2-3"></a>             <span class="dt">family =</span> <span class="kw">poisson</span>())</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="kw">summary</span>(mod, <span class="st">&quot;sandwich&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co">## poisson - log link</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">## </span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">## exp1to2 ~ emu + cuwoo + cuau + cucf + cuec + cufr + cugb + cuin + </span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">##     cuus + regional + curcol | exp.time + imp.time + pairid | </span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">##     cty1 + cty2 + year</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">## </span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">## Estimates:</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">##           Estimate Std. error z value Pr(&gt; |z|)    </span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">## emu       0.048895   0.010277   4.758  1.96e-06 ***</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">## cuwoo     0.765988   0.053272  14.379   &lt; 2e-16 ***</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">## cuau      0.384469   0.118832   3.235   0.00121 ** </span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">## cucf     -0.125608   0.099674  -1.260   0.20760    </span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">## cuec     -0.877318   0.083451 -10.513   &lt; 2e-16 ***</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">## cufr      2.095726   0.062952  33.291   &lt; 2e-16 ***</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">## cugb      1.059957   0.034680  30.564   &lt; 2e-16 ***</span></span>
<span id="cb3-16"><a href="#cb3-16"></a><span class="co">## cuin      0.169745   0.147029   1.154   0.24830    </span></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="co">## cuus      0.018323   0.021530   0.851   0.39473    </span></span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">## regional  0.159181   0.008714  18.267   &lt; 2e-16 ***</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">## curcol    0.386882   0.046827   8.262   &lt; 2e-16 ***</span></span>
<span id="cb3-20"><a href="#cb3-20"></a><span class="co">## ---</span></span>
<span id="cb3-21"><a href="#cb3-21"></a><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="co">## </span></span>
<span id="cb3-23"><a href="#cb3-23"></a><span class="co">## residual deviance= 35830778.98,</span></span>
<span id="cb3-24"><a href="#cb3-24"></a><span class="co">## null deviance= 2245707302.17,</span></span>
<span id="cb3-25"><a href="#cb3-25"></a><span class="co">## n= 1610165, l= [11227, 11277, 34104]</span></span>
<span id="cb3-26"><a href="#cb3-26"></a><span class="co">## </span></span>
<span id="cb3-27"><a href="#cb3-27"></a><span class="co">## ( 1363003 observation(s) deleted due to perfect classification )</span></span>
<span id="cb3-28"><a href="#cb3-28"></a><span class="co">## </span></span>
<span id="cb3-29"><a href="#cb3-29"></a><span class="co">## Number of Fisher Scoring Iterations: 13 </span></span></code></pre></div>
<p>We observe that roughly 1,4 million observations do not contribute to the identification of the structural parameters and we end up with roughly 1,6 million observations and 57,000 fixed effects.</p>
<p>Replicating the clustered standard errors is straightforward. We simply have to change the option to <code>&quot;clustered&quot;</code> and provide <code>summary</code> with the requested cluster dimensions.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="kw">summary</span>(mod, <span class="st">&quot;clustered&quot;</span>, <span class="dt">cluster =</span> <span class="op">~</span><span class="st"> </span>cty1 <span class="op">+</span><span class="st"> </span>cty2 <span class="op">+</span><span class="st"> </span>year)</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co">## poisson - log link</span></span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">## </span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">## exp1to2 ~ emu + cuwoo + cuau + cucf + cuec + cufr + cugb + cuin + </span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">##     cuus + regional + curcol | exp.time + imp.time + pairid | </span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">##     cty1 + cty2 + year</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">## </span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">## Estimates:</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">##          Estimate Std. error z value Pr(&gt; |z|)    </span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">## emu       0.04890    0.09455   0.517   0.60507    </span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">## cuwoo     0.76599    0.24933   3.072   0.00213 ** </span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">## cuau      0.38447    0.22356   1.720   0.08547 .  </span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">## cucf     -0.12561    0.35221  -0.357   0.72137    </span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">## cuec     -0.87732    0.29493  -2.975   0.00293 ** </span></span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co">## cufr      2.09573    0.30625   6.843  7.75e-12 ***</span></span>
<span id="cb5-15"><a href="#cb5-15"></a><span class="co">## cugb      1.05996    0.23766   4.460  8.19e-06 ***</span></span>
<span id="cb5-16"><a href="#cb5-16"></a><span class="co">## cuin      0.16974    0.30090   0.564   0.57267    </span></span>
<span id="cb5-17"><a href="#cb5-17"></a><span class="co">## cuus      0.01832    0.05092   0.360   0.71898    </span></span>
<span id="cb5-18"><a href="#cb5-18"></a><span class="co">## regional  0.15918    0.07588   2.098   0.03593 *  </span></span>
<span id="cb5-19"><a href="#cb5-19"></a><span class="co">## curcol    0.38688    0.15509   2.495   0.01261 *  </span></span>
<span id="cb5-20"><a href="#cb5-20"></a><span class="co">## ---</span></span>
<span id="cb5-21"><a href="#cb5-21"></a><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="co">## </span></span>
<span id="cb5-23"><a href="#cb5-23"></a><span class="co">## residual deviance= 35830778.98,</span></span>
<span id="cb5-24"><a href="#cb5-24"></a><span class="co">## null deviance= 2245707302.17,</span></span>
<span id="cb5-25"><a href="#cb5-25"></a><span class="co">## n= 1610165, l= [11227, 11277, 34104]</span></span>
<span id="cb5-26"><a href="#cb5-26"></a><span class="co">## </span></span>
<span id="cb5-27"><a href="#cb5-27"></a><span class="co">## ( 1363003 observation(s) deleted due to perfect classification )</span></span>
<span id="cb5-28"><a href="#cb5-28"></a><span class="co">## </span></span>
<span id="cb5-29"><a href="#cb5-29"></a><span class="co">## Number of Fisher Scoring Iterations: 13 </span></span></code></pre></div>
</div>
<div id="testing-linear-restrictions" class="section level2">
<h2>Testing linear restrictions</h2>
<p>Our package is also compatible with <code>linearHypothesis()</code> of the <code>car</code> package. In the next example we show how to test if all currency union effects except being in the EMU are jointly different from zero using a Wald test based on a clustered covariance matrix.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">library</span>(car)</span>
<span id="cb6-2"><a href="#cb6-2"></a>cus &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;cuwoo&quot;</span>, <span class="st">&quot;cuau&quot;</span>, <span class="st">&quot;cucf&quot;</span>, <span class="st">&quot;cuec&quot;</span>, <span class="st">&quot;cufr&quot;</span>, <span class="st">&quot;cugb&quot;</span>, <span class="st">&quot;cuin&quot;</span>, <span class="st">&quot;cuus&quot;</span>)</span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="kw">linearHypothesis</span>(mod, cus, <span class="dt">vcov. =</span> <span class="kw">vcov</span>(mod, <span class="st">&quot;clustered&quot;</span>, <span class="dt">cluster =</span> <span class="op">~</span><span class="st"> </span>cty1 <span class="op">+</span><span class="st"> </span>cty2 <span class="op">+</span><span class="st"> </span>year))</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">## Linear hypothesis test</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">## </span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">## Hypothesis:</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">## cuwoo = 0</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">## cuau = 0</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">## cucf = 0</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">## cuec = 0</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">## cufr = 0</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">## cugb = 0</span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">## cuin = 0</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">## cuus = 0</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">## </span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">## Model 1: restricted model</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">## Model 2: exp1to2 ~ emu + cuwoo + cuau + cucf + cuec + cufr + cugb + cuin + </span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">##     cuus + regional + curcol | exp.time + imp.time + pairid | </span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">##     cty1 + cty2 + year</span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co">## </span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">## Note: Coefficient covariance matrix supplied.</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">## </span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">##   Df  Chisq Pr(&gt;Chisq)    </span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">## 1                         </span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">## 2  8 96.771  &lt; 2.2e-16 ***</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">## ---</span></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></code></pre></div>
</div>
<div id="estimating-the-extensive-margin-of-trade" class="section level2">
<h2>Estimating the extensive margin of trade</h2>
<p>Now we turn to the estimation of the extensive margin. First we estimate a static probit model.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a>mods &lt;-<span class="st"> </span><span class="kw">feglm</span>(trade <span class="op">~</span><span class="st"> </span>emu <span class="op">+</span><span class="st"> </span>cuwoo <span class="op">+</span><span class="st"> </span>cuau <span class="op">+</span><span class="st"> </span>cucf <span class="op">+</span><span class="st"> </span>cuec <span class="op">+</span><span class="st"> </span>cufr <span class="op">+</span><span class="st"> </span>cugb <span class="op">+</span><span class="st"> </span>cuin <span class="op">+</span><span class="st"> </span>cuus <span class="op">+</span></span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="st">                </span>regional <span class="op">+</span><span class="st"> </span>curcol <span class="op">|</span><span class="st"> </span>exp.time <span class="op">+</span><span class="st"> </span>imp.time <span class="op">+</span><span class="st"> </span>pairid, cudata,</span>
<span id="cb8-3"><a href="#cb8-3"></a>              <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="st">&quot;probit&quot;</span>))</span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="kw">summary</span>(mods)</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">## binomial - probit link</span></span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">## </span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">## trade ~ emu + cuwoo + cuau + cucf + cuec + cufr + cugb + cuin + </span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">##     cuus + regional + curcol | exp.time + imp.time + pairid</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">## </span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">## Estimates:</span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">##          Estimate Std. error z value Pr(&gt; |z|)    </span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">## emu       0.28677    0.12842   2.233  0.025546 *  </span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">## cuwoo     0.57036    0.07675   7.432  1.07e-13 ***</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">## cuau      1.09776    0.28863   3.803  0.000143 ***</span></span>
<span id="cb9-11"><a href="#cb9-11"></a><span class="co">## cucf      0.14035    0.05250   2.673  0.007507 ** </span></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co">## cuec      0.02973    0.63120   0.047  0.962432    </span></span>
<span id="cb9-13"><a href="#cb9-13"></a><span class="co">## cufr      2.31013    0.24334   9.493   &lt; 2e-16 ***</span></span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">## cugb      0.18260    0.04252   4.294  1.75e-05 ***</span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">## cuin      0.25333    0.15696   1.614  0.106519    </span></span>
<span id="cb9-16"><a href="#cb9-16"></a><span class="co">## cuus     -0.36223    0.07908  -4.580  4.64e-06 ***</span></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co">## regional  0.06259    0.01782   3.513  0.000444 ***</span></span>
<span id="cb9-18"><a href="#cb9-18"></a><span class="co">## curcol   -0.93748    0.23913  -3.920  8.84e-05 ***</span></span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">## ---</span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb9-21"><a href="#cb9-21"></a><span class="co">## </span></span>
<span id="cb9-22"><a href="#cb9-22"></a><span class="co">## residual deviance= 681026.48,</span></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co">## null deviance= 1947737.97,</span></span>
<span id="cb9-24"><a href="#cb9-24"></a><span class="co">## n= 1406505, l= [11227, 11273, 29630]</span></span>
<span id="cb9-25"><a href="#cb9-25"></a><span class="co">## </span></span>
<span id="cb9-26"><a href="#cb9-26"></a><span class="co">## ( 1566663 observation(s) deleted due to perfect classification )</span></span>
<span id="cb9-27"><a href="#cb9-27"></a><span class="co">## </span></span>
<span id="cb9-28"><a href="#cb9-28"></a><span class="co">## Number of Fisher Scoring Iterations: 8 </span></span></code></pre></div>
<p>To mitigate the incidental parameters problem (see <span class="citation">Neyman and Scott (1948)</span>) we apply the bias correction suggested by <span class="citation">Hinz, Stammann, and Wanner (2020)</span>. Note that the argument <code>panel.structure = &quot;network&quot;</code> is necessary to apply the appropriate bias correction.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>modsbc &lt;-<span class="st"> </span><span class="kw">biasCorr</span>(mods, <span class="dt">panel.structure =</span> <span class="st">&quot;network&quot;</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw">summary</span>(modsbc)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">## binomial - probit link</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">## </span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">## trade ~ emu + cuwoo + cuau + cucf + cuec + cufr + cugb + cuin + </span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">##     cuus + regional + curcol | exp.time + imp.time + pairid</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">## </span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">## Estimates:</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">##          Estimate Std. error z value Pr(&gt; |z|)    </span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">## emu       0.26936    0.12842   2.097  0.035952 *  </span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">## cuwoo     0.50427    0.07675   6.571  5.01e-11 ***</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">## cuau      0.99328    0.28863   3.441  0.000579 ***</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">## cucf      0.12976    0.05250   2.472  0.013448 *  </span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">## cuec     -0.02330    0.63120  -0.037  0.970558    </span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">## cufr      2.07974    0.24334   8.547   &lt; 2e-16 ***</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">## cugb      0.16612    0.04252   3.907  9.35e-05 ***</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">## cuin      0.20516    0.15696   1.307  0.191182    </span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">## cuus     -0.33674    0.07908  -4.258  2.06e-05 ***</span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">## regional  0.06273    0.01782   3.520  0.000431 ***</span></span>
<span id="cb11-18"><a href="#cb11-18"></a><span class="co">## curcol   -0.72433    0.23913  -3.029  0.002453 ** </span></span>
<span id="cb11-19"><a href="#cb11-19"></a><span class="co">## ---</span></span>
<span id="cb11-20"><a href="#cb11-20"></a><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb11-21"><a href="#cb11-21"></a><span class="co">## </span></span>
<span id="cb11-22"><a href="#cb11-22"></a><span class="co">## residual deviance= 681026.48,</span></span>
<span id="cb11-23"><a href="#cb11-23"></a><span class="co">## null deviance= 1947737.97,</span></span>
<span id="cb11-24"><a href="#cb11-24"></a><span class="co">## n= 1406505, l= [11227, 11273, 29630]</span></span>
<span id="cb11-25"><a href="#cb11-25"></a><span class="co">## </span></span>
<span id="cb11-26"><a href="#cb11-26"></a><span class="co">## ( 1566663 observation(s) deleted due to perfect classification )</span></span>
<span id="cb11-27"><a href="#cb11-27"></a><span class="co">## </span></span>
<span id="cb11-28"><a href="#cb11-28"></a><span class="co">## Number of Fisher Scoring Iterations: 8 </span></span></code></pre></div>
<p>Because coefficients itself are not very meaningful, researchers are usually interested in so called partial effects (also known as marginal or ceteris paribus effects). A commonly used statistic is the average partial effect. <code>alpaca</code> offers a post-estimation routine to estimate average partial effects and their corresponding standard errors. In the following the bias-corrected average partial effects are computed.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>apesbc &lt;-<span class="st"> </span><span class="kw">getAPEs</span>(modsbc, <span class="dt">n.pop =</span> <span class="kw">nrow</span>(cudata))</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="kw">summary</span>(apesbc)</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="co">## Estimates:</span></span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">##           Estimate Std. error z value Pr(&gt; |z|)    </span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">## emu       0.018890   0.008526   2.216  0.026713 *  </span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">## cuwoo     0.035655   0.005908   6.035  1.59e-09 ***</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">## cuau      0.070750   0.014709   4.810  1.51e-06 ***</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">## cucf      0.009045   0.003783   2.391  0.016796 *  </span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">## cuec     -0.001612   0.038730  -0.042  0.966810    </span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">## cufr      0.154181   0.023722   6.500  8.05e-11 ***</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">## cugb      0.011596   0.002997   3.869  0.000109 ***</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">## cuin      0.014349   0.011038   1.300  0.193634    </span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">## cuus     -0.022868   0.005267  -4.342  1.41e-05 ***</span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">## regional  0.004360   0.001238   3.521  0.000430 ***</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co">## curcol   -0.047850   0.018521  -2.584  0.009778 ** </span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">## ---</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></code></pre></div>
<p><span class="citation">Hinz, Stammann, and Wanner (2020)</span> propose to estimate the extensive margin using a dynamic specification, where the lagged dependent variable is added to the list of explanatory variables. Again, a bias correction is necessary. Contrary to the one for static models with strictly exogenous covariates, we need to additionally provide a bandwidth parameter (<code>L</code>) that is required for the estimation of spectral densities (see <span class="citation">Hahn and Kuersteiner (2011)</span>). <span class="citation">Fernández-Val and Weidner (2016)</span> suggest to do a sensitivity analysis and try different values for <code>L</code> but not larger than four. Note that in this case the order of factors to be concentrated out, specified in the second part of the formula, is important (importer-/exporter-time identifiers first and pair identifier last).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>modd &lt;-<span class="st"> </span><span class="kw">feglm</span>(trade <span class="op">~</span><span class="st"> </span>ltrade <span class="op">+</span><span class="st"> </span>emu <span class="op">+</span><span class="st"> </span>cuwoo <span class="op">+</span><span class="st"> </span>cuau <span class="op">+</span><span class="st"> </span>cucf <span class="op">+</span><span class="st"> </span>cuec <span class="op">+</span><span class="st"> </span>cufr <span class="op">+</span><span class="st"> </span>cugb <span class="op">+</span><span class="st"> </span>cuin <span class="op">+</span><span class="st"> </span>cuus <span class="op">+</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="st">                </span>regional <span class="op">+</span><span class="st"> </span>curcol <span class="op">|</span><span class="st"> </span>exp.time <span class="op">+</span><span class="st"> </span>imp.time <span class="op">+</span><span class="st"> </span>pairid, cudata,</span>
<span id="cb14-3"><a href="#cb14-3"></a>              <span class="dt">family =</span> <span class="kw">binomial</span>(<span class="st">&quot;probit&quot;</span>))</span>
<span id="cb14-4"><a href="#cb14-4"></a>moddbc &lt;-<span class="st"> </span><span class="kw">biasCorr</span>(modd, <span class="dt">L =</span> 2L, <span class="dt">panel.structure =</span> <span class="st">&quot;network&quot;</span>)</span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="kw">summary</span>(moddbc)</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co">## binomial - probit link</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">## </span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">## trade ~ ltrade + emu + cuwoo + cuau + cucf + cuec + cufr + cugb + </span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">##     cuin + cuus + regional + curcol | exp.time + imp.time + pairid</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">## </span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">## Estimates:</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">##          Estimate Std. error z value Pr(&gt; |z|)    </span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">## ltrade    1.24347    0.00443 280.716   &lt; 2e-16 ***</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">## emu       0.18254    0.13543   1.348   0.17772    </span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">## cuwoo     0.41716    0.08064   5.173  2.30e-07 ***</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">## cuau      0.79027    0.30405   2.599   0.00935 ** </span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">## cucf      0.10150    0.05446   1.864   0.06238 .  </span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co">## cuec      0.17233    0.68493   0.252   0.80135    </span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">## cufr      1.46437    0.24241   6.041  1.53e-09 ***</span></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co">## cugb      0.10085    0.04452   2.265   0.02348 *  </span></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co">## cuin      0.17074    0.16391   1.042   0.29757    </span></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co">## cuus     -0.25676    0.08216  -3.125   0.00178 ** </span></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co">## regional  0.04644    0.01867   2.488   0.01284 *  </span></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="co">## curcol   -0.43458    0.25141  -1.729   0.08388 .  </span></span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="co">## ---</span></span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span>
<span id="cb15-22"><a href="#cb15-22"></a><span class="co">## </span></span>
<span id="cb15-23"><a href="#cb15-23"></a><span class="co">## residual deviance= 603824.81,</span></span>
<span id="cb15-24"><a href="#cb15-24"></a><span class="co">## null deviance= 1930471.73,</span></span>
<span id="cb15-25"><a href="#cb15-25"></a><span class="co">## n= 1394201, l= [11133, 11178, 29538]</span></span>
<span id="cb15-26"><a href="#cb15-26"></a><span class="co">## </span></span>
<span id="cb15-27"><a href="#cb15-27"></a><span class="co">## ( 45048 observation(s) deleted due to missingness )</span></span>
<span id="cb15-28"><a href="#cb15-28"></a><span class="co">## ( 1533919 observation(s) deleted due to perfect classification )</span></span>
<span id="cb15-29"><a href="#cb15-29"></a><span class="co">## </span></span>
<span id="cb15-30"><a href="#cb15-30"></a><span class="co">## Number of Fisher Scoring Iterations: 22 </span></span></code></pre></div>
<p>Again we compute bias-corrected average partial effects to get interpretable quantities.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>apedbc &lt;-<span class="st"> </span><span class="kw">getAPEs</span>(moddbc, <span class="dt">n.pop =</span> <span class="kw">nrow</span>(cudata[<span class="op">!</span><span class="kw">is.na</span>(ltrade)]))</span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="kw">summary</span>(apedbc)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="co">## Estimates:</span></span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">##            Estimate Std. error z value Pr(&gt; |z|)    </span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">## ltrade    0.1148321  0.0005004 229.459   &lt; 2e-16 ***</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">## emu       0.0114102  0.0077264   1.477  0.139737    </span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co">## cuwoo     0.0265827  0.0047666   5.577  2.45e-08 ***</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co">## cuau      0.0520368  0.0151715   3.430  0.000604 ***</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co">## cucf      0.0063053  0.0031961   1.973  0.048516 *  </span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">## cuec      0.0107638  0.0369895   0.291  0.771055    </span></span>
<span id="cb17-9"><a href="#cb17-9"></a><span class="co">## cufr      0.1019601  0.0246482   4.137  3.52e-05 ***</span></span>
<span id="cb17-10"><a href="#cb17-10"></a><span class="co">## cugb      0.0062640  0.0024262   2.582  0.009827 ** </span></span>
<span id="cb17-11"><a href="#cb17-11"></a><span class="co">## cuin      0.0106628  0.0094163   1.132  0.257478    </span></span>
<span id="cb17-12"><a href="#cb17-12"></a><span class="co">## cuus     -0.0155832  0.0043727  -3.564  0.000366 ***</span></span>
<span id="cb17-13"><a href="#cb17-13"></a><span class="co">## regional  0.0028744  0.0010406   2.762  0.005739 ** </span></span>
<span id="cb17-14"><a href="#cb17-14"></a><span class="co">## curcol   -0.0261449  0.0154963  -1.687  0.091571 .  </span></span>
<span id="cb17-15"><a href="#cb17-15"></a><span class="co">## ---</span></span>
<span id="cb17-16"><a href="#cb17-16"></a><span class="co">## Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1</span></span></code></pre></div>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-fw16">
<p>Fernández-Val, Iván, and Martin Weidner. 2016. “Individual and Time Effects in Nonlinear Panel Models with Large N, T.” <em>Journal of Econometrics</em> 192 (1): 291–312.</p>
</div>
<div id="ref-gr16">
<p>Glick, Reuven, and Andrew K. Rose. 2016. “Currency Unions and Trade: A Post-Emu Reassessment.” <em>European Economic Review</em> 87: 78–91.</p>
</div>
<div id="ref-hk11">
<p>Hahn, Jinyong, and Guido Kuersteiner. 2011. “Bias Reduction for Dynamic Nonlinear Panel Models with Fixed Effects.” <em>Econometric Theory</em> 27 (6): 1152–91.</p>
</div>
<div id="ref-hsw20">
<p>Hinz, Julian, Amrei Stammann, and Joschka Wanner. 2020. “State Dependence and Unobserved Heterogeneity in the Extensive Margin of Trade.” <em>ArXiv E-Prints</em>.</p>
</div>
<div id="ref-lwyz19">
<p>Larch, Mario, Joschka Wanner, Yoto V. Yotov, and Thomas Zylkin. 2019. “Currency Unions and Trade: A Ppml Re-Assessment with High-Dimensional Fixed Effects.” <em>Oxford Bulletin of Economics and Statistics</em> 81 (3): 487–510.</p>
</div>
<div id="ref-ns48">
<p>Neyman, Jerzy, and Elizabeth L. Scott. 1948. “Consistent Estimates Based on Partially Consistent Observations.” <em>Econometrica</em> 16 (1): 1–32.</p>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
