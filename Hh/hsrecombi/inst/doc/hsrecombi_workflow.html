<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="D. Wittenburg" />


<title>Description of the workflow for constructing a genetic map using hsrecombi</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">Description of the workflow for constructing a genetic map using <em>hsrecombi</em></h1>
<h4 class="author">D. Wittenburg</h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p><em>hsrecombi</em> can approximate the genetic-map positions of genetic markers from SNP genotypes in half-sib families. It is referred to <a href="https://www.frontiersin.org/articles/10.3389/fgene.2018.00186">Hampel et al. (2018, Fron Gen)</a> and Qanbari &amp; Wittenburg (2020, submitted) for more information on the methodology. The workflow relies on paternal half-sib families but it can be adapted to maternal half-sib families with minor modifications.</p>
<p>In <strong>Part I</strong>, genotypic data from progeny and their common parents are simulated with the R package <a href="https://CRAN.R-project.org/package=AlphaSimR"><em>AlphaSimR</em></a> and reshaped into the PLINK format. If genotypic data are already available in the required PLINK format, the workflow starts directly at <strong>Part II</strong>.</p>
<p>Required input files:</p>
<ul>
<li>map files for each chromosome <code>map&lt;chr&gt;.map</code></li>
<li>data files for each chromosome <code>hsphase_input&lt;chr&gt;.raw</code></li>
</ul>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(hsrecombi)
<span class="kw">library</span>(AlphaSimR)
<span class="co">#&gt; Loading required package: R6</span>
<span class="kw">library</span>(doParallel)
<span class="co">#&gt; Loading required package: foreach</span>
<span class="co">#&gt; Loading required package: iterators</span>
<span class="co">#&gt; Loading required package: parallel</span>
<span class="kw">library</span>(ggplot2)
<span class="kw">library</span>(rlist)
<span class="kw">Sys.time</span>()
<span class="co">#&gt; [1] &quot;2020-10-13 15:06:05 CEST&quot;</span></code></pre></div>
<div id="global-variables" class="section level3">
<h3>Global variables</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Number of SNPs (e.g., p = 1500 resembles an average bovine chromosome)</span>
p &lt;-<span class="st"> </span><span class="dv">150</span>
<span class="co"># Number of progeny in each half-sib family</span>
n &lt;-<span class="st"> </span><span class="dv">1000</span>
<span class="co"># Directory for (simulated) data</span>
path.dat &lt;-<span class="st"> &quot;data&quot;</span>
<span class="kw">dir.create</span>(path.dat, <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>)
<span class="co"># Directory for output</span>
path.res &lt;-<span class="st"> &quot;results&quot;</span>
<span class="kw">dir.create</span>(path.res, <span class="dt">showWarnings =</span> <span class="ot">FALSE</span>)
<span class="co"># Number of computing clusters allocated</span>
nclust &lt;-<span class="st"> </span><span class="dv">2</span></code></pre></div>
<p>For instance, executing the following workflow with <span class="math inline">\(p=1500\)</span> and <span class="math inline">\(n\geq 1000\)</span> requires about 120 Mb storage space and 10 min computing time (2.6 GHz processor). With <span class="math inline">\(p=150\)</span>, it takes about 7 Mb and 20 sec.</p>
</div>
</div>
<div id="part-i-data-simulation-and-preparation" class="section level2">
<h2>Part I: Data simulation and preparation</h2>
<div id="simulation-of-genetic-data-with-r-package-alphasimr" class="section level3">
<h3>1: Simulation of genetic data with R package <em>AlphaSimR</em></h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">founderPop &lt;-<span class="st"> </span><span class="kw">runMacs2</span>(<span class="dt">nInd =</span> <span class="dv">1000</span>, <span class="dt">nChr =</span> <span class="dv">2</span>, <span class="dt">segSites =</span> p)
SP &lt;-<span class="st"> </span>SimParam$<span class="kw">new</span>(founderPop)
SP$<span class="kw">setSexes</span>(<span class="st">&quot;yes_sys&quot;</span>)
<span class="co"># Enable tracing location of recombination events</span>
SP$<span class="kw">setTrackRec</span>(<span class="ot">TRUE</span>)

pop &lt;-<span class="st"> </span><span class="kw">newPop</span>(founderPop)
N &lt;-<span class="st"> </span><span class="dv">10</span>
ntotal &lt;-<span class="st"> </span>N *<span class="st"> </span>n
my_pop &lt;-<span class="st"> </span><span class="kw">selectCross</span>(<span class="dt">pop =</span> pop, <span class="dt">nFemale =</span> <span class="dv">500</span>, <span class="dt">nMale =</span> N, <span class="dt">use =</span> <span class="st">&quot;rand&quot;</span>, <span class="dt">nCrosses =</span> ntotal)

<span class="kw">save</span>(<span class="dt">list =</span> <span class="kw">c</span>(<span class="st">&quot;SP&quot;</span>, <span class="st">&quot;founderPop&quot;</span>, <span class="st">&quot;pop&quot;</span>, <span class="st">&quot;my_pop&quot;</span>, <span class="st">&quot;ntotal&quot;</span>), <span class="dt">file =</span> <span class="kw">file.path</span>(path.dat, <span class="st">&quot;pop.RData&quot;</span>))</code></pre></div>
<p>Two chromosomes, each with <span class="math inline">\(p\)</span> SNPs and 1 Morgan length, are simulated. The founder population consists of 1,000 animals with equal gender distribution. The follow-up generation consists of <span class="math inline">\(N\)</span> paternal-half sib families with equal number of progeny <span class="math inline">\(n\)</span>. The study design with the equal number of progeny per family was preferred here for simplicity but this is not required in the subsequent steps.</p>
</div>
<div id="selection-of-sire-haplotypes-and-progeny-genotypes" class="section level3">
<h3>2: Selection of sire haplotypes and progeny genotypes</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">PAT &lt;-<span class="st"> </span>my_pop@father
rown &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">rep</span>(<span class="kw">unique</span>(PAT), <span class="dt">each =</span> <span class="dv">2</span>), <span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">sep =</span> <span class="st">&quot;_&quot;</span>)
H.pat &lt;-<span class="st"> </span><span class="kw">pullSegSiteHaplo</span>(pop)[rown, ]
X &lt;-<span class="st"> </span><span class="kw">pullSegSiteGeno</span>(my_pop)
<span class="co"># Physical position of markers in Mbp</span>
map.snp &lt;-<span class="st"> </span><span class="kw">lapply</span>(founderPop@genMap, function(z) z *<span class="st"> </span><span class="dv">100</span>)</code></pre></div>
<p>Note that <code>founderPop@genMap</code> includes genetic positions in Morgan units but physical positions are required in the next steps.</p>
</div>
<div id="reshaping-data-into-plink-format" class="section level3">
<h3>3: Reshaping data into PLINK format</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">map &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Chr =</span> <span class="kw">rep</span>(<span class="dv">1</span>:<span class="kw">length</span>(map.snp), <span class="kw">unlist</span>(<span class="kw">lapply</span>(map.snp, length))), <span class="dt">Name =</span> <span class="kw">paste0</span>(<span class="st">&quot;SNP&quot;</span>, 
    <span class="dv">1</span>:<span class="kw">length</span>(<span class="kw">unlist</span>(map.snp))), <span class="dt">locus_Mb =</span> <span class="kw">unlist</span>(map.snp), <span class="dt">locus_bp =</span> <span class="kw">unlist</span>(map.snp) *<span class="st"> </span><span class="fl">1e+06</span>)

<span class="kw">colnames</span>(X) &lt;-<span class="st"> </span>map$Name
FID &lt;-<span class="st"> &quot;FAM001&quot;</span>
IID &lt;-<span class="st"> </span>my_pop@id
MAT &lt;-<span class="st"> </span>my_pop@mother
SEX &lt;-<span class="st"> </span><span class="dv">2</span>
PHENOTYPE &lt;-<span class="st"> </span>-<span class="dv">9</span>

for (chr in <span class="dv">1</span>:<span class="dv">2</span>) {
    <span class="kw">write.table</span>(map[map$Chr ==<span class="st"> </span>chr, ], <span class="kw">file.path</span>(path.dat, <span class="kw">paste0</span>(<span class="st">&quot;map&quot;</span>, chr, <span class="st">&quot;.map&quot;</span>)), <span class="dt">col.names =</span> F, 
        <span class="dt">row.names =</span> F, <span class="dt">quote =</span> F)
    <span class="kw">write.table</span>(<span class="kw">cbind</span>(FID, IID, PAT, MAT, SEX, PHENOTYPE, X[, map$Chr ==<span class="st"> </span>chr]), <span class="kw">file.path</span>(path.dat, <span class="kw">paste0</span>(<span class="st">&quot;hsphase_input&quot;</span>, 
        chr, <span class="st">&quot;.raw&quot;</span>)), <span class="dt">col.names =</span> T, <span class="dt">row.names =</span> F, <span class="dt">quote =</span> F)
}</code></pre></div>
</div>
</div>
<div id="part-ii-main-analysis" class="section level2">
<h2>Part II: Main analysis</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cl &lt;-<span class="st"> </span><span class="kw">makeCluster</span>(nclust)
<span class="kw">registerDoParallel</span>(cl)</code></pre></div>
<div id="steps-1-5-calculation-of-pairwise-recombination-rates" class="section level3">
<h3>Steps 1-5: Calculation of pairwise recombination rates</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">out &lt;-<span class="st"> </span><span class="kw">foreach</span>(<span class="dt">chr =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">.packages =</span> <span class="st">&quot;hsrecombi&quot;</span>) %dopar%<span class="st"> </span>{
    
    <span class="co"># 1: Physical map</span>
    map &lt;-<span class="st"> </span><span class="kw">read.table</span>(<span class="kw">file.path</span>(path.dat, <span class="kw">paste0</span>(<span class="st">&quot;map&quot;</span>, chr, <span class="st">&quot;.map&quot;</span>)), <span class="dt">col.names =</span> <span class="kw">c</span>(<span class="st">&quot;Chr&quot;</span>, <span class="st">&quot;Name&quot;</span>, <span class="st">&quot;locus_Mb&quot;</span>, 
        <span class="st">&quot;locus_bp&quot;</span>))
    map$SNP &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="kw">nrow</span>(map)
    locus_Mb &lt;-<span class="st"> </span>map$locus_Mb
    
    <span class="co"># 2: Genotype matrix</span>
    genomatrix &lt;-<span class="st"> </span>data.table::<span class="kw">fread</span>(<span class="kw">file.path</span>(path.dat, <span class="kw">paste0</span>(<span class="st">&quot;hsphase_input&quot;</span>, chr, <span class="st">&quot;.raw&quot;</span>)))
    X &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(genomatrix[, -<span class="kw">c</span>(<span class="dv">1</span>:<span class="dv">6</span>)])
    
    <span class="co"># 3: Assign daughters to sire IDs</span>
    daughterSire &lt;-<span class="st"> </span>genomatrix$PAT
    
    <span class="co"># 4: Estimate sire haplotypes and format data</span>
    hap &lt;-<span class="st"> </span><span class="kw">makehappm</span>(<span class="kw">unique</span>(daughterSire), daughterSire, X)
    <span class="kw">save</span>(<span class="st">&quot;hap&quot;</span>, <span class="dt">file =</span> <span class="kw">file.path</span>(path.res, <span class="kw">paste0</span>(<span class="st">&quot;hsphase_output_chr&quot;</span>, chr, <span class="st">&quot;.Rdata&quot;</span>)))
    
    <span class="co"># Check order and dimension</span>
    io &lt;-<span class="st"> </span><span class="kw">sapply</span>(<span class="dv">1</span>:<span class="kw">nrow</span>(map), function(z) {
        <span class="kw">grepl</span>(<span class="dt">x =</span> <span class="kw">colnames</span>(X)[z], <span class="dt">pattern =</span> map$Name[z])
    })
    if (<span class="kw">sum</span>(io) !=<span class="st"> </span><span class="kw">nrow</span>(map)) 
        <span class="kw">stop</span>(<span class="st">&quot;ERROR in dimension&quot;</span>)
    
    <span class="co"># 5: Estimate recombination rates</span>
    res &lt;-<span class="st"> </span><span class="kw">hsrecombi</span>(hap, X, map$SNP)
    final &lt;-<span class="st"> </span><span class="kw">editraw</span>(res, map)
    <span class="kw">save</span>(<span class="dt">list =</span> <span class="kw">c</span>(<span class="st">&quot;final&quot;</span>, <span class="st">&quot;locus_Mb&quot;</span>), <span class="dt">file =</span> <span class="kw">file.path</span>(path.res, <span class="kw">paste0</span>(<span class="st">&quot;Results_chr&quot;</span>, chr, <span class="st">&quot;.RData&quot;</span>)))
    
    <span class="kw">ifelse</span>(<span class="kw">nrow</span>(final) &gt;<span class="st"> </span><span class="dv">0</span>, <span class="st">&quot;OK&quot;</span>, <span class="st">&quot;no result&quot;</span>)
}
<span class="kw">print</span>(<span class="kw">which</span>(<span class="kw">unlist</span>(out) ==<span class="st"> &quot;OK&quot;</span>))
<span class="co">#&gt; [1] 1 2</span></code></pre></div>
<p>In step 4, function <code>makehap</code> would be sufficient but <code>makehappm</code> allows comparison with a deterministic approach shown later. Note that sire haplotypes can also be obtained by some other (external) software. Then sire haplotypes and sire-to-daughter information need to be reshaped with <code>makehaplist</code> in step 4.</p>
</div>
<div id="check-for-candidates-of-misplacement" class="section level3">
<h3>6: Check for candidates of misplacement</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 6a: Filter SNPs with unusually large recombination rate to neighbouring (30) SNPs</span>
excl &lt;-<span class="st"> </span><span class="kw">foreach</span>(<span class="dt">chr =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">.packages =</span> <span class="st">&quot;hsrecombi&quot;</span>) %dopar%<span class="st"> </span>{
    <span class="kw">load</span>(<span class="kw">file.path</span>(path.res, <span class="kw">paste0</span>(<span class="st">&quot;Results_chr&quot;</span>, chr, <span class="st">&quot;.RData&quot;</span>)))
    <span class="kw">checkCandidates</span>(final)
}

<span class="co"># 6b: Heatmap plot of recombination rates for visual verification, e.g.:</span>
chr &lt;-<span class="st"> </span><span class="dv">2</span>
<span class="kw">load</span>(<span class="kw">file.path</span>(path.res, <span class="kw">paste0</span>(<span class="st">&quot;Results_chr&quot;</span>, chr, <span class="st">&quot;.RData&quot;</span>)))
cand &lt;-<span class="st"> </span>excl[[chr]][<span class="dv">1</span>]
win &lt;-<span class="st"> </span>cand +<span class="st"> </span>(-<span class="dv">100</span>:<span class="dv">100</span>)
win &lt;-<span class="st"> </span>win[(win &gt;=<span class="st"> </span><span class="dv">1</span>) &amp;<span class="st"> </span>(win &lt;=<span class="st"> </span><span class="kw">max</span>(final$SNP2))]

target &lt;-<span class="st"> </span>final[(final$SNP1 %in%<span class="st"> </span>win) &amp;<span class="st"> </span>(final$SNP2 %in%<span class="st"> </span>win), ]

<span class="kw">ggplot</span>(<span class="dt">data =</span> target, <span class="kw">aes</span>(SNP2, SNP1, <span class="dt">fill =</span> theta)) +<span class="st"> </span><span class="kw">geom_tile</span>() +<span class="st"> </span><span class="kw">xlab</span>(<span class="st">&quot;Locus 2&quot;</span>) +<span class="st"> </span><span class="kw">ylab</span>(<span class="st">&quot;Locus 1&quot;</span>) +<span class="st"> </span>
<span class="st">    </span><span class="kw">coord_equal</span>() +<span class="st"> </span><span class="kw">scale_y_continuous</span>(<span class="dt">trans =</span> <span class="st">&quot;reverse&quot;</span>) +<span class="st"> </span><span class="kw">theme</span>(<span class="dt">panel.background =</span> <span class="kw">element_blank</span>(), 
    <span class="dt">panel.grid.major =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>, <span class="dt">size =</span> <span class="fl">0.1</span>), <span class="dt">panel.grid.minor =</span> <span class="kw">element_line</span>(<span class="dt">colour =</span> <span class="st">&quot;grey&quot;</span>)) +<span class="st"> </span>
<span class="st">    </span><span class="kw">theme</span>(<span class="dt">text =</span> <span class="kw">element_text</span>(<span class="dt">size =</span> <span class="dv">18</span>)) +<span class="st"> </span><span class="kw">scale_fill_gradientn</span>(<span class="dt">colours =</span> <span class="kw">c</span>(<span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;red&quot;</span>), <span class="dt">limits =</span> <span class="kw">c</span>(<span class="dv">0</span>, 
    <span class="dv">1</span> +<span class="st"> </span><span class="fl">1e-10</span>), <span class="dt">na.value =</span> <span class="st">&quot;white&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># -&gt; nothing conspicious</span>

excl[[<span class="dv">1</span>]] &lt;-<span class="st"> </span>excl[[<span class="dv">2</span>]] &lt;-<span class="st"> </span><span class="ot">NA</span></code></pre></div>
<p>Orange colour in the SNP neighbourhood implies an increased recombination rate. In case of a misplaced marker or a cluster of misplaced markers, the heatmap is characterised by an orange band.</p>
</div>
<div id="approximation-of-genetic-positions" class="section level3">
<h3>7: Approximation of genetic positions</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pos &lt;-<span class="st"> </span><span class="kw">foreach</span>(<span class="dt">chr =</span> <span class="dv">1</span>:<span class="dv">2</span>, <span class="dt">.packages =</span> <span class="st">&quot;hsrecombi&quot;</span>) %dopar%<span class="st"> </span>{
    <span class="kw">load</span>(<span class="kw">file.path</span>(path.res, <span class="kw">paste0</span>(<span class="st">&quot;Results_chr&quot;</span>, chr, <span class="st">&quot;.RData&quot;</span>)))
    out &lt;-<span class="st"> </span><span class="kw">geneticPosition</span>(final, <span class="dt">exclude =</span> excl[[chr]])
    <span class="kw">list</span>(<span class="dt">pos.cM =</span> <span class="kw">c</span>(out, <span class="kw">rep</span>(<span class="ot">NA</span>, <span class="kw">length</span>(locus_Mb) -<span class="st"> </span><span class="kw">length</span>(out))), <span class="dt">pos.Mb =</span> locus_Mb)
}</code></pre></div>
<p>Genetic position is reported as NA if the corresponding SNP has not been considered in the analysis (e.g., when no sire was heterozygous at the corresponding SNP).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">stopCluster</span>(cl)</code></pre></div>
</div>
<div id="plot-of-physical-versus-genetic-map-positions" class="section level3">
<h3>8: Plot of physical versus genetic-map positions</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">data &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">Chr =</span> <span class="kw">rep</span>(<span class="dv">1</span>:<span class="kw">length</span>(pos), <span class="dt">times =</span> <span class="kw">unlist</span>(<span class="kw">list.select</span>(pos, <span class="kw">length</span>(pos.Mb)))), <span class="dt">Mbp =</span> <span class="kw">unlist</span>(<span class="kw">list.select</span>(pos, 
    pos.Mb)), <span class="dt">cM =</span> <span class="kw">unlist</span>(<span class="kw">list.select</span>(pos, pos.cM)))
<span class="kw">ggplot</span>(data, <span class="kw">aes</span>(<span class="dt">x =</span> Mbp, <span class="dt">y =</span> cM)) +<span class="st"> </span><span class="kw">geom_point</span>(<span class="dt">na.rm =</span> T) +<span class="st"> </span><span class="kw">facet_grid</span>(Chr ~<span class="st"> </span>.)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="part-iii-visual-comparison-with-simulated-data-and-deterministic-approach" class="section level2">
<h2>Part III: Visual comparison with simulated data and deterministic approach</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">chr &lt;-<span class="st"> </span><span class="dv">2</span></code></pre></div>
<div id="check-with-simulated-data" class="section level3">
<h3>1: Check with simulated data</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="kw">file.path</span>(path.dat, <span class="st">&quot;pop.RData&quot;</span>))
co.pat &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, <span class="dt">ncol =</span> p, <span class="dt">nrow =</span> ntotal)
for (i in <span class="dv">1</span>:ntotal) {
    if (<span class="kw">nrow</span>(SP$recHist[[<span class="dv">1000</span> +<span class="st"> </span>i]][[chr]][[<span class="dv">2</span>]]) &gt;<span class="st"> </span><span class="dv">1</span>) {
        <span class="co"># 1. line contains 1 1 by default</span>
        loci &lt;-<span class="st"> </span>SP$recHist[[<span class="dv">1000</span> +<span class="st"> </span>i]][[chr]][[<span class="dv">2</span>]][-<span class="dv">1</span>, <span class="dv">2</span>]
        co.pat[i, loci] &lt;-<span class="st"> </span><span class="dv">1</span>
    }
}
probRec &lt;-<span class="st"> </span><span class="kw">colMeans</span>(co.pat)
sim.cM &lt;-<span class="st"> </span><span class="kw">cumsum</span>(probRec) *<span class="st"> </span><span class="dv">100</span></code></pre></div>
<p>The position of a recombination event is traced in <code>SP$recHist</code> which has a nested list structure (individual, chromosome, female/male haplotype). The recombination rate between adjacent SNPs is determined as the proportion of recombinant progeny and the positions are derived as cumulative sum over recombination rates.</p>
</div>
<div id="check-with-deterministic-approach" class="section level3">
<h3>2: Check with deterministic approach</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">load</span>(<span class="kw">file.path</span>(path.res, <span class="kw">paste0</span>(<span class="st">&quot;hsphase_output_chr&quot;</span>, chr, <span class="st">&quot;.Rdata&quot;</span>)))
hsphase.cM &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="kw">cumsum</span>(hap$probRec)) *<span class="st"> </span><span class="dv">100</span></code></pre></div>
<p>The results are compared to the deterministic approach of <a href="https://doi.org/10.1186/1297-9686-46-11">Ferdosi et al. (2014)</a> provided in the R package <a href="https://CRAN.R-project.org/package=hsphase"><em>hsphase</em></a>. Functions of that package are called in <code>makehap</code> and <code>makehappm</code>.</p>
</div>
<div id="comparative-plot-of-physical-versus-genetic-map-positions" class="section level3">
<h3>3: Comparative plot of physical versus genetic-map positions</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">par</span>(<span class="dt">mar =</span> <span class="kw">c</span>(<span class="fl">5.1</span>, <span class="fl">4.1</span>, <span class="fl">4.1</span>, <span class="fl">9.1</span>), <span class="dt">xpd =</span> <span class="ot">TRUE</span>)
<span class="kw">plot</span>(pos[[chr]]$pos.Mb, pos[[chr]]$pos.cM, <span class="dt">xlab =</span> <span class="st">&quot;physical position (Mbp)&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;genetic position (cM)&quot;</span>, 
    <span class="dt">ylim =</span> <span class="kw">range</span>(<span class="kw">c</span>(sim.cM, hsphase.cM, pos[[chr]]$pos.cM), <span class="dt">na.rm =</span> T), <span class="dt">pch =</span> <span class="dv">20</span>)
<span class="kw">points</span>(pos[[chr]]$pos.Mb, sim.cM, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">4</span>)
<span class="kw">points</span>(pos[[chr]]$pos.Mb, hsphase.cM, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">col =</span> <span class="dv">8</span>)
<span class="kw">legend</span>(<span class="st">&quot;topleft&quot;</span>, <span class="dt">inset =</span> <span class="kw">c</span>(<span class="fl">1.01</span>, <span class="dv">0</span>), <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;simulated&quot;</span>, <span class="st">&quot;deterministic&quot;</span>, <span class="st">&quot;likelihood-based&quot;</span>), <span class="dt">pch =</span> <span class="dv">20</span>, 
    <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">4</span>, <span class="dv">8</span>, <span class="dv">1</span>), <span class="dt">bty =</span> <span class="st">&quot;n&quot;</span>)</code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> The likelihood-based approach requires a sufficiently large sample size if SNP density is high. A verification of the bias of genetic-map positions can be found in the Supplemental Material of Qanbari &amp; Wittenburg (2020, submitted).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">unlink</span>(path.dat, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)
<span class="kw">unlink</span>(path.res, <span class="dt">recursive =</span> <span class="ot">TRUE</span>)
<span class="kw">Sys.time</span>()
<span class="co">#&gt; [1] &quot;2020-10-13 15:06:20 CEST&quot;</span></code></pre></div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
